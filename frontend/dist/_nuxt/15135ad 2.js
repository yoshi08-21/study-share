(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{578:function(e,t,n){"use strict";var r=n(100),o=n(4);t.a=o.a.extend({name:"rippleable",directives:{ripple:r.a},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.ripple?(data.staticClass="v-input--selection-controls__ripple",data.directives=data.directives||[],data.directives.push({name:"ripple",value:{center:!0}}),this.$createElement("div",data)):null}}})},579:function(e,t,n){n(9)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},580:function(e,t,n){var content=n(581);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(18).default)("7f6d4ad6",content,!0,{sourceMap:!1})},581:function(e,t,n){var r=n(17)(!1);r.push([e.i,".theme--light.v-pagination .v-pagination__item{background:#fff;color:rgba(0,0,0,.87)}.theme--light.v-pagination .v-pagination__item--active{color:#fff}.theme--light.v-pagination .v-pagination__navigation{background:#fff}.theme--dark.v-pagination .v-pagination__item{background:#1e1e1e;color:#fff}.theme--dark.v-pagination .v-pagination__item--active{color:#fff}.theme--dark.v-pagination .v-pagination__navigation{background:#1e1e1e}.v-pagination{align-items:center;display:inline-flex;list-style-type:none;justify-content:center;margin:0;max-width:100%;width:100%}.v-pagination.v-pagination{padding-left:0}.v-pagination>li{align-items:center;display:flex}.v-pagination--circle .v-pagination__item,.v-pagination--circle .v-pagination__more,.v-pagination--circle .v-pagination__navigation{border-radius:50%}.v-pagination--disabled{pointer-events:none;opacity:.6}.v-pagination__item{background:transparent;border-radius:4px;font-size:1rem;height:34px;margin:.3rem;min-width:34px;padding:0 5px;text-decoration:none;transition:.3s cubic-bezier(0,0,.2,1);width:auto;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.v-pagination__item--active{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.v-pagination__navigation{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);border-radius:4px;display:inline-flex;justify-content:center;align-items:center;text-decoration:none;height:32px;width:32px;margin:.3rem 10px}.v-pagination__navigation .v-icon{transition:.2s cubic-bezier(.4,0,.6,1);vertical-align:middle}.v-pagination__navigation--disabled{opacity:.6;pointer-events:none}.v-pagination__more{margin:.3rem;display:inline-flex;align-items:flex-end;justify-content:center;height:32px;width:32px}",""]),e.exports=r},583:function(e,t,n){var content=n(584);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(18).default)("5939d713",content,!0,{sourceMap:!1})},584:function(e,t,n){var r=n(17)(!1);r.push([e.i,".v-rating{max-width:100%;white-space:nowrap}.v-rating .v-icon{padding:.5rem;border-radius:50%;-webkit-user-select:none;-moz-user-select:none;user-select:none;outline:none}.v-rating .v-icon:after{display:none}.v-application--is-ltr .v-rating .v-icon{transform:scaleX(1)}.v-application--is-rtl .v-rating .v-icon{transform:scaleX(-1)}.v-rating--readonly .v-icon{pointer-events:none}.v-rating--dense .v-icon{padding:.1rem}",""]),e.exports=r},596:function(e,t,n){"use strict";n(11),n(13),n(14),n(15),n(12),n(16);var r=n(60),o=n(2),l=(n(22),n(579),n(32),n(48),n(6),n(47),n(76),n(580),n(89)),c=n(121),h=n(24),v=n(267),d=n(20),f=n(7);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}t.a=Object(f.a)(h.a,Object(v.a)({onVisible:["init"]}),d.a).extend({name:"v-pagination",directives:{Resize:c.a},props:{circle:Boolean,disabled:Boolean,length:{type:Number,default:0,validator:function(e){return e%1==0}},nextIcon:{type:String,default:"$next"},prevIcon:{type:String,default:"$prev"},totalVisible:[Number,String],value:{type:Number,default:0},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},wrapperAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.wrapper"}},data:function(){return{maxButtons:0,selected:null}},computed:{classes:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({"v-pagination":!0,"v-pagination--circle":this.circle,"v-pagination--disabled":this.disabled},this.themeClasses)},items:function(){var e=parseInt(this.totalVisible,10);if(0===e||isNaN(this.length)||this.length>Number.MAX_SAFE_INTEGER)return[];var t=Math.min(Math.max(0,e)||this.length,Math.max(0,this.maxButtons)||this.length,this.length);if(this.length<=t)return this.range(1,this.length);var n=t%2==0?1:0,o=Math.floor(t/2),l=this.length-o+1+n;if(this.value>o&&this.value<l){var c=this.length,h=this.value-o+2,v=this.value+o-2-n,d=v+1===c-1?v+1:"...";return[1,h-1==2?2:"..."].concat(Object(r.a)(this.range(h,v)),[d,this.length])}if(this.value===o){var f=this.value+o-1-n;return[].concat(Object(r.a)(this.range(1,f)),["...",this.length])}if(this.value===l){var m=this.value-o+1;return[1,"..."].concat(Object(r.a)(this.range(m,this.length)))}return[].concat(Object(r.a)(this.range(1,o)),["..."],Object(r.a)(this.range(l,this.length)))}},watch:{value:function(){this.init()}},beforeMount:function(){this.init()},methods:{init:function(){var e=this;this.selected=null,this.onResize(),this.$nextTick(this.onResize),setTimeout((function(){return e.selected=e.value}),100)},onResize:function(){var e=this.$el&&this.$el.parentElement?this.$el.parentElement.clientWidth:window.innerWidth;this.maxButtons=Math.floor((e-96)/42)},next:function(e){e.preventDefault(),this.$emit("input",this.value+1),this.$emit("next")},previous:function(e){e.preventDefault(),this.$emit("input",this.value-1),this.$emit("previous")},range:function(e,t){for(var n=[],i=e=e>0?e:1;i<=t;i++)n.push(i);return n},genIcon:function(e,t,n,r,label){return e("li",[e("button",{staticClass:"v-pagination__navigation",class:{"v-pagination__navigation--disabled":n},attrs:{disabled:n,type:"button","aria-label":label},on:n?{}:{click:r}},[e(l.a,[t])])])},genItem:function(e,i){var t=this,n=i===this.value&&(this.color||"primary"),r=i===this.value,o=r?this.currentPageAriaLabel:this.pageAriaLabel;return e("button",this.setBackgroundColor(n,{staticClass:"v-pagination__item",class:{"v-pagination__item--active":i===this.value},attrs:{type:"button","aria-current":r,"aria-label":this.$vuetify.lang.t(o,i)},on:{click:function(){return t.$emit("input",i)}}}),[i.toString()])},genItems:function(e){var t=this;return this.items.map((function(i,n){return e("li",{key:n},[isNaN(Number(i))?e("span",{class:"v-pagination__more"},[i.toString()]):t.genItem(e,i)])}))},genList:function(e,t){return e("ul",{directives:[{modifiers:{quiet:!0},name:"resize",value:this.onResize}],class:this.classes},t)}},render:function(e){var t=[this.genIcon(e,this.$vuetify.rtl?this.nextIcon:this.prevIcon,this.value<=1,this.previous,this.$vuetify.lang.t(this.previousAriaLabel)),this.genItems(e),this.genIcon(e,this.$vuetify.rtl?this.prevIcon:this.nextIcon,this.value>=this.length,this.next,this.$vuetify.lang.t(this.nextAriaLabel))];return e("nav",{attrs:{role:"navigation","aria-label":this.$vuetify.lang.t(this.wrapperAriaLabel)}},[this.genList(e,t)])}})},598:function(e,t,n){"use strict";n(22),n(266),n(76),n(583);var r=n(89),o=n(24),l=n(122),c=n(171),h=n(578),v=n(20),d=n(1),f=n(7);t.a=Object(f.a)(o.a,l.a,h.a,c.a,v.a).extend({name:"v-rating",props:{backgroundColor:{type:String,default:"accent"},color:{type:String,default:"primary"},clearable:Boolean,dense:Boolean,emptyIcon:{type:String,default:"$ratingEmpty"},fullIcon:{type:String,default:"$ratingFull"},halfIcon:{type:String,default:"$ratingHalf"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,size:[Number,String],value:{type:Number,default:0},iconLabel:{type:String,default:"$vuetify.rating.ariaLabel.icon"}},data:function(){return{hoverIndex:-1,internalValue:this.value}},computed:{directives:function(){return this.readonly||!this.ripple?[]:[{name:"ripple",value:{circle:!0}}]},iconProps:function(){var e=this.$props,t=e.dark,n=e.large,r=e.light,o=e.medium,small=e.small;return{dark:t,large:n,light:r,medium:o,size:e.size,small:small,xLarge:e.xLarge,xSmall:e.xSmall}},isHovering:function(){return this.hover&&this.hoverIndex>=0}},watch:{internalValue:function(e){e!==this.value&&this.$emit("input",e)},value:function(e){this.internalValue=e}},methods:{createClickFn:function(i){var e=this;return function(t){if(!e.readonly){var n=e.genHoverIndex(t,i);e.clearable&&e.internalValue===n?e.internalValue=0:e.internalValue=n}}},createProps:function(i){var e={index:i,value:this.internalValue,click:this.createClickFn(i),isFilled:Math.floor(this.internalValue)>i,isHovered:Math.floor(this.hoverIndex)>i};return this.halfIncrements&&(e.isHalfHovered=!e.isHovered&&(this.hoverIndex-i)%1>0,e.isHalfFilled=!e.isFilled&&(this.internalValue-i)%1>0),e},genHoverIndex:function(e,i){var t=this.isHalfEvent(e);return this.halfIncrements&&this.$vuetify.rtl&&(t=!t),i+(t?.5:1)},getIconName:function(e){var t=this.isHovering?e.isHovered:e.isFilled,n=this.isHovering?e.isHalfHovered:e.isHalfFilled;return t?this.fullIcon:n?this.halfIcon:this.emptyIcon},getColor:function(e){if(this.isHovering){if(e.isHovered||e.isHalfHovered)return this.color}else if(e.isFilled||e.isHalfFilled)return this.color;return this.backgroundColor},isHalfEvent:function(e){if(this.halfIncrements){var rect=e.target&&e.target.getBoundingClientRect();if(rect&&e.pageX-rect.left<rect.width/2)return!0}return!1},onMouseEnter:function(e,i){var t=this;this.runDelay("open",(function(){t.hoverIndex=t.genHoverIndex(e,i)}))},onMouseLeave:function(){var e=this;this.runDelay("close",(function(){return e.hoverIndex=-1}))},genItem:function(i){var e=this,t=this.createProps(i);if(this.$scopedSlots.item)return this.$scopedSlots.item(t);var n={click:t.click};return this.hover&&(n.mouseenter=function(t){return e.onMouseEnter(t,i)},n.mouseleave=this.onMouseLeave,this.halfIncrements&&(n.mousemove=function(t){return e.onMouseEnter(t,i)})),this.$createElement(r.a,this.setTextColor(this.getColor(t),{attrs:{"aria-label":this.$vuetify.lang.t(this.iconLabel,i+1,Number(this.length))},directives:this.directives,props:this.iconProps,on:n}),[this.getIconName(t)])}},render:function(e){var t=this,n=Object(d.h)(Number(this.length)).map((function(i){return t.genItem(i)}));return e("div",{staticClass:"v-rating",class:{"v-rating--readonly":this.readonly,"v-rating--dense":this.dense}},n)}})},602:function(e,t,n){"use strict";var r=n(265),o=n(255),l=n(111),c=n(565),h=n(164),v=n(209),d=n(598),f=n(564),m=n(566),_=(n(35),n(26)),y=(n(82),n(119)),x=n(44),k={props:{books:[]},mixins:[y.a],data:function(){return{snackbar:!1,snackbarColor:"primary",flashMessage:"テストメッセージ"}},methods:{addToFavorites:function(e,t){var n=this;return Object(_.a)(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.preventDefault(),!n.currentUser){r.next=22;break}return r.prev=2,r.next=5,x.a.post("/books/".concat(e.id,"/favorite_books"),{current_user_id:n.currentUser.id});case 5:o=r.sent,console.log(o.data),e.check_favorite=1,e.favorite_books_count+=1,n.snackbarColor="primary",n.snackbar=!0,n.flashMessage="お気に入りに追加しました",r.next=20;break;case 14:r.prev=14,r.t0=r.catch(2),console.log(r.t0),n.snackbarColor="red accent-2",n.snackbar=!0,n.flashMessage="すでにお気に入りに登録されています";case 20:r.next=23;break;case 22:n.$router.push({path:"/auth/login",query:{message:"ログインが必要です"}});case 23:case"end":return r.stop()}}),r,null,[[2,14]])})))()},removeFromFavorite:function(e,t){var n=this;return Object(_.a)(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.preventDefault(),r.prev=1,r.next=4,x.a.delete("/favorite_books/destroy_from_item_list",{params:{current_user_id:n.currentUser.id,book_id:e.id}});case 4:o=r.sent,console.log(o),e.favorite_books_count-=1,e.check_favorite=0,n.snackbar=!0,n.snackbarColor="primary",n.flashMessage="お気に入りから削除しました",r.next=19;break;case 13:r.prev=13,r.t0=r.catch(1),console.log(r.t0),n.snackbarColor="red accent-2",n.snackbar=!0,n.flashMessage="お気に入りに登録されていません";case 19:case"end":return r.stop()}}),r,null,[[1,13]])})))()}}},w=n(69),component=Object(w.a)(k,(function(){var e=this,t=e._self._c;return t("div",[e._l(e.books,(function(n,m){return t(f.a,{key:m,staticClass:"justify-center",attrs:{"mb-5":"","data-cy":"each-books"}},[t(c.a,{attrs:{cols:"10"}},[t(o.a,{attrs:{elevation:"8",height:"240"}},[t(f.a,[t(c.a,{staticClass:"d-flex justify-center",attrs:{cols:"3"}},[n.image?t("div",{staticClass:"d-flex justify-center",staticStyle:{height:"210px"}},[t(v.a,{attrs:{src:n.image,alt:"画像",contain:"","max-height":"200","max-width":"180"}})],1):e._e()]),e._v(" "),t(c.a,{staticClass:"mt-n4",attrs:{cols:"7"}},[t("div",{staticStyle:{height:"107px"}},[t(l.d,[t("nuxt-link",{attrs:{to:"/books/".concat(n.id)}},[e._v(e._s(e.$truncate(n.name,50)))])],1),e._v(" "),t(l.b,{staticStyle:{"margin-top":"-20px"}},[t(f.a,{staticClass:"d-flex align-center"},[t(c.a,{attrs:{cols:"4"}},[t(d.a,{attrs:{readonly:!0,"background-color":"orange lighten-3",color:"orange",dense:""},model:{value:n.average_rating,callback:function(t){e.$set(n,"average_rating",t)},expression:"book.average_rating"}})],1),e._v(" "),t(c.a,{attrs:{cols:"3"}},[t("h2",[e._v("\n                      ("+e._s(n.average_rating)+")\n                    ")])])],1)],1)],1),e._v(" "),t(l.c,[t("h3",{staticStyle:{"margin-bottom":"5px"}},[e._v("科目: "+e._s(n.subject))]),e._v(" "),t("h4",[e._v("著者: "+e._s(n.author))]),e._v(" "),t("h4",[e._v("出版社: "+e._s(n.publisher))])]),e._v(" "),t(l.a,[t(f.a,{staticClass:"d-flex align-center justify-center"},[t(c.a,{attrs:{cols:"4"}},[t(h.a,[e._v("mdi-comment-text-outline")]),e._v("\n                  レビュー: "+e._s(n.reviews_count)+"件\n                ")],1),e._v(" "),t(c.a,{attrs:{cols:"4"}},[t(h.a,[e._v("mdi-comment-text-outline")]),e._v("\n                  質問: "+e._s(n.questions_count)+"件\n                ")],1),e._v(" "),t(c.a,{attrs:{cols:"4","data-cy":"each-book-favorite-section"}},[t(h.a,[e._v("mdi-heart-multiple")]),e._v("\n                  お気に入り ("+e._s(n.favorite_books_count)+")\n                ")],1)],1)],1)],1),e._v(" "),t(c.a,{staticClass:"d-flex justify-center ml-n5",attrs:{cols:"2"}},[e.currentUser?[0==n.check_favorite?t(r.a,{staticClass:"mt-8",on:{click:function(t){return e.addToFavorites(n,t)}}},[e._v("お気に入り追加")]):t(r.a,{staticClass:"mt-8",on:{click:function(t){return e.removeFromFavorite(n,t)}}},[e._v("お気に入り削除")])]:e._e()],2)],1)],1)],1)],1)})),e._v(" "),t(m.a,{attrs:{timeout:3e3,color:e.snackbarColor},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(e._s(e.flashMessage))])],2)}),[],!1,null,null,null);t.a=component.exports},821:function(e,t,n){"use strict";n.r(t);var r=n(265),o=n(255),l=n(111),c=n(565),h=n(596),v=n(564),d=n(162),f=n(26),m=(n(55),n(82),n(602)),_=n(44),y={components:{EachBooks:m.a},asyncData:function(e){return Object(f.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.route,r=e.store,t.prev=1,t.next=4,_.a.get("/books/search_books",{params:{searchBooksKeyword:n.query.searchBooksKeyword,current_user_id:r.getters["auth/getCurrentUserId"]}});case 4:return o=t.sent,console.log(o.data),t.abrupt("return",{searchBooksResult:o.data.books,totalCount:o.data.books_count,searchBooksKeyword:n.query.searchBooksKeyword});case 9:throw t.prev=9,t.t0=t.catch(1),console.log(t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},watch:{"$route.query.searchBooksKeyword":function(e,t){var n=this;e!==t&&this.updateSearchResult(e).then((function(e){n.searchBooksResult=e.books,n.totalCount=e.books_count})).catch((function(e){console.log(e)}))}},data:function(){return{newKeyword:"",perPage:10,page:1,isInputBeingConverted:!1}},computed:{booksChunk:function(){var e=(this.page-1)*this.perPage,t=e+this.perPage;return this.searchBooksResult.slice(e,t)},totalPages:function(){return Math.ceil(this.searchBooksResult.length/this.perPage)}},methods:{updateSearchResult:function(e){var t=this;return Object(f.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_.a.get("/books/search_books",{params:{searchBooksKeyword:e,current_user_id:t.$store.getters["auth/getCurrentUserId"]}});case 3:return r=n.sent,console.log(r.data),t.searchBooksKeyword=e,t.page=1,n.abrupt("return",r.data);case 10:throw n.prev=10,n.t0=n.catch(0),console.log(n.t0),n.t0;case 14:case"end":return n.stop()}}),n,null,[[0,10]])})))()},updateQueryParams:function(){!1===this.isInputBeingConverted&&(this.$router.push({query:{searchBooksKeyword:this.newKeyword}}),this.newKeyword="")}}},x=n(69),component=Object(x.a)(y,(function(){var e=this,t=e._self._c;return t("div",[t("br"),t("br"),e._v(" "),t(v.a,[t(c.a,{staticClass:"d-flex justify-center",attrs:{cols:"12"}},[t(o.a,{attrs:{height:"130px",width:"85%"}},[t(l.d,{staticStyle:{height:"100%","align-items":"center"}},[t(v.a,[t(c.a,{attrs:{cols:"11"}},[t(d.a,{attrs:{filled:"",outlined:"",dense:"",label:"参考書を再検索"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.updateQueryParams.apply(null,arguments)},compositionstart:function(t){e.isInputBeingConverted=!0},compositionend:function(t){e.isInputBeingConverted=!1}},model:{value:e.newKeyword,callback:function(t){e.newKeyword=t},expression:"newKeyword"}})],1),e._v(" "),t(c.a,{attrs:{cols:"1"}},[t(r.a,{on:{click:e.updateQueryParams}},[e._v("検索")])],1)],1)],1)],1)],1)],1),e._v(" "),t("br"),e._v(" "),t(v.a,[t(c.a,{staticClass:"d-flex justify-center"},[t("h2",[e._v("「"+e._s(this.searchBooksKeyword)+"」の検索結果"+e._s(this.totalCount)+"件 ")])])],1),e._v(" "),t("br"),t("br"),e._v(" "),e.searchBooksResult&&e.searchBooksResult.length>0?t("div",[t(h.a,{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}),e._v(" "),t("br"),e._v(" "),t("each-books",{attrs:{books:e.booksChunk}}),e._v(" "),t("br"),e._v(" "),t(h.a,{attrs:{length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1):t("div",[t("p",[e._v("検索結果はありません")])])],1)}),[],!1,null,null,null);t.default=component.exports}}]);