  [1m[35m (155.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS `spa_portfolio_test`[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE DATABASE `spa_portfolio_test` DEFAULT CHARACTER SET `utf8mb4`[0m
  [1m[35m (13.0ms)[0m  [1m[35mDROP TABLE IF EXISTS `active_storage_attachments` CASCADE[0m
  [1m[35m (65.0ms)[0m  [1m[35mCREATE TABLE `active_storage_attachments` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(255) NOT NULL, `record_type` varchar(255) NOT NULL, `record_id` bigint NOT NULL, `blob_id` bigint NOT NULL, `created_at` datetime NOT NULL, INDEX `index_active_storage_attachments_on_blob_id` (`blob_id`), UNIQUE INDEX `index_active_storage_attachments_uniqueness` (`record_type`, `record_id`, `name`, `blob_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (3.9ms)[0m  [1m[35mDROP TABLE IF EXISTS `active_storage_blobs` CASCADE[0m
  [1m[35m (15.5ms)[0m  [1m[35mCREATE TABLE `active_storage_blobs` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `key` varchar(255) NOT NULL, `filename` varchar(255) NOT NULL, `content_type` varchar(255), `metadata` text, `service_name` varchar(255) NOT NULL, `byte_size` bigint NOT NULL, `checksum` varchar(255) NOT NULL, `created_at` datetime NOT NULL, UNIQUE INDEX `index_active_storage_blobs_on_key` (`key`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (1.2ms)[0m  [1m[35mDROP TABLE IF EXISTS `active_storage_variant_records` CASCADE[0m
  [1m[35m (21.4ms)[0m  [1m[35mCREATE TABLE `active_storage_variant_records` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `blob_id` bigint NOT NULL, `variation_digest` varchar(255) NOT NULL, UNIQUE INDEX `index_active_storage_variant_records_uniqueness` (`blob_id`, `variation_digest`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS `books` CASCADE[0m
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE `books` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(255), `author` varchar(255), `publisher` varchar(255), `subject` varchar(255), `user_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL, `description` text) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS `browsing_histories` CASCADE[0m
  [1m[35m (9.1ms)[0m  [1m[35mCREATE TABLE `browsing_histories` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `book_id` int, `review_id` int, `question_id` int, `reply_id` int, `subject_question_id` int, `subject_question_reply_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL, `survey_id` int) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_books` CASCADE[0m
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE `favorite_books` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `book_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL, UNIQUE INDEX `index_favorite_books_on_user_id_and_book_id` (`user_id`, `book_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_questions` CASCADE[0m
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE `favorite_questions` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `question_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_replies` CASCADE[0m
  [1m[35m (6.7ms)[0m  [1m[35mCREATE TABLE `favorite_replies` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `reply_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (1.6ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_reviews` CASCADE[0m
  [1m[35m (10.5ms)[0m  [1m[35mCREATE TABLE `favorite_reviews` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `review_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_subject_question_replies` CASCADE[0m
  [1m[35m (7.3ms)[0m  [1m[35mCREATE TABLE `favorite_subject_question_replies` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `subject_question_reply_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_subject_questions` CASCADE[0m
  [1m[35m (6.9ms)[0m  [1m[35mCREATE TABLE `favorite_subject_questions` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `subject_question_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS `favorite_surveys` CASCADE[0m
  [1m[35m (6.6ms)[0m  [1m[35mCREATE TABLE `favorite_surveys` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `survey_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `notifications` CASCADE[0m
  [1m[35m (11.0ms)[0m  [1m[35mCREATE TABLE `notifications` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `action_user_id` int, `target_user_id` int, `review_id` int, `question_id` int, `reply_id` int, `subject_question_id` int, `subject_question_reply_id` int, `action_type` varchar(255), `action_to` varchar(255), `is_checked` tinyint(1) DEFAULT FALSE, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL, `survey_id` int) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `questions` CASCADE[0m
  [1m[35m (9.0ms)[0m  [1m[35mCREATE TABLE `questions` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `title` varchar(255), `content` text, `subject` varchar(255), `user_id` int, `book_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS `replies` CASCADE[0m
  [1m[35m (7.1ms)[0m  [1m[35mCREATE TABLE `replies` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `content` text, `user_id` int, `question_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `reviews` CASCADE[0m
  [1m[35m (15.2ms)[0m  [1m[35mCREATE TABLE `reviews` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `rating` int, `title` varchar(255), `content` text, `user_id` int, `book_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS `subject_question_replies` CASCADE[0m
  [1m[35m (10.9ms)[0m  [1m[35mCREATE TABLE `subject_question_replies` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `content` text, `user_id` int, `subject_question_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `subject_questions` CASCADE[0m
  [1m[35m (10.0ms)[0m  [1m[35mCREATE TABLE `subject_questions` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `title` varchar(255), `content` text, `subject` varchar(255), `user_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS `survey_answers` CASCADE[0m
  [1m[35m (6.5ms)[0m  [1m[35mCREATE TABLE `survey_answers` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` int, `survey_id` int, `selected_option` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS `surveys` CASCADE[0m
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE `surveys` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `title` varchar(255), `content` text, `option1` varchar(255), `option2` varchar(255), `option3` varchar(255), `option4` varchar(255), `status` tinyint(1), `user_id` int, `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL, `genre` varchar(255)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (1.4ms)[0m  [1m[35mDROP TABLE IF EXISTS `users` CASCADE[0m
  [1m[35m (9.4ms)[0m  [1m[35mCREATE TABLE `users` (`id` bigint NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(255), `email` varchar(255), `uid` varchar(255), `first_choice_school` varchar(255), `second_choice_school` varchar(255), `third_choice_school` varchar(255), `introduction` varchar(255), `admin` tinyint(1), `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL, `memo` text, UNIQUE INDEX `index_users_on_email` (`email`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci[0m
  [1m[35m (66.1ms)[0m  [1m[35mALTER TABLE `active_storage_attachments` ADD CONSTRAINT `fk_rails_c3b3935057`
FOREIGN KEY (`blob_id`)
  REFERENCES `active_storage_blobs` (`id`)
[0m
  [1m[35m (20.9ms)[0m  [1m[35mALTER TABLE `active_storage_variant_records` ADD CONSTRAINT `fk_rails_993965df05`
FOREIGN KEY (`blob_id`)
  REFERENCES `active_storage_blobs` (`id`)
[0m
  [1m[35m (8.0ms)[0m  [1m[35mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[35m (1.5ms)[0m  [1m[32mINSERT INTO `schema_migrations` (version) VALUES (20230815165023)[0m
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO `schema_migrations` (version) VALUES
(20230113030911),
(20230118212718),
(20230405012833),
(20230405024007),
(20230407004112),
(20230407025807),
(20230411013457),
(20230412165146),
(20230412174119),
(20230412175704),
(20230420033900),
(20230524090718),
(20230525080150),
(20230525155618),
(20230527130844),
(20230528081346),
(20230531014357),
(20230531051935),
(20230531132242),
(20230619233623),
(20230708114522),
(20230801075540),
(20230802030914),
(20230806145931),
(20230807050059),
(20230807063619),
(20230807143304),
(20230810044013),
(20230810083439);

[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE TABLE `ar_internal_metadata` (`key` varchar(255) NOT NULL PRIMARY KEY, `value` varchar(255), `created_at` datetime(6) NOT NULL, `updated_at` datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.* FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'environment' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (10.0ms)[0m  [1m[32mINSERT INTO `ar_internal_metadata` (`key`, `value`, `created_at`, `updated_at`) VALUES ('environment', 'test', '2023-08-21 17:51:38.637415', '2023-08-21 17:51:38.637415')[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.* FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT `ar_internal_metadata`.* FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (1.3ms)[0m  [1m[32mINSERT INTO `ar_internal_metadata` (`key`, `value`, `created_at`, `updated_at`) VALUES ('schema_sha1', '47e15f12688d7160bb4fcb765eb73ba284992bd9', '2023-08-21 17:51:38.673689', '2023-08-21 17:51:38.673689')[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/users" for 127.0.0.1 at 2023-08-22 02:51:38 +0900
Processing by UsersController#index as HTML
  [1m[36mUser Load (6.9ms)[0m  [1m[34mSELECT `users`.* FROM `users`[0m
Completed 200 OK in 48ms (Views: 0.9ms | ActiveRecord: 6.9ms | Allocations: 23034)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:23:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:23:28.619774', '2023-08-21 19:23:28.619774')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (2.9ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 1 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wjtt0lq97sj9ieazvw91bpm9ii3k', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:23:29')[0m
  [1m[36mActiveStorage::Attachment Create (1.8ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 1, 1, '2023-08-21 19:23:29')[0m
  [1m[36mUser Update (2.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:23:29.187131' WHERE `users`.`id` = 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: wjtt0lq97sj9ieazvw91bpm9ii3k (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: af89d91e-d43e-4605-a3fe-9197cc7a9f19) to Test(default) with arguments: #<GlobalID:0x00007fc537e3cbd8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/1>>
Completed 200 OK in 701ms (Views: 0.5ms | ActiveRecord: 32.2ms | Allocations: 231001)
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:23:40 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (2.9ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:23:40.852816', '2023-08-21 19:23:40.852816')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 2 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 2 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jwltm42a9ma796g6yonx8whhbr3i', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:23:41')[0m
  [1m[36mActiveStorage::Attachment Create (1.0ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 2, 2, '2023-08-21 19:23:41')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:23:41.286242' WHERE `users`.`id` = 2[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: jwltm42a9ma796g6yonx8whhbr3i (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b4bf6bc6-33b7-47b7-99e6-bf258a5cfb7c) to Test(default) with arguments: #<GlobalID:0x00007fbca290dce0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/2>>
Completed 200 OK in 550ms (Views: 0.4ms | ActiveRecord: 18.9ms | Allocations: 231020)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:47:20 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:47:20.522125', '2023-08-21 19:47:20.522125')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 3 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 3 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('c2hgj6kyz8ryjyl7uwd9288cmln4', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:47:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 3, 3, '2023-08-21 19:47:21')[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:47:21.012669' WHERE `users`.`id` = 3[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: c2hgj6kyz8ryjyl7uwd9288cmln4 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b2286a36-dfcc-413c-8c07-eaa0e2373ee8) to Test(default) with arguments: #<GlobalID:0x00007f81557a7b40 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/3>>
Completed 200 OK in 534ms (Views: 0.4ms | ActiveRecord: 8.6ms | Allocations: 210521)
  [1m[35m (4.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:47:21 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 24ms (Views: 7.5ms | ActiveRecord: 1.1ms | Allocations: 3005)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:47:59 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:48:00.018866', '2023-08-21 19:48:00.018866')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 4 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 4 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9sevfnsjih7cn0n1q2cayjia7jlw', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:48:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 4, 4, '2023-08-21 19:48:00')[0m
  [1m[36mUser Update (2.9ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:48:00.466854' WHERE `users`.`id` = 4[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: 9sevfnsjih7cn0n1q2cayjia7jlw (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d980750c-0a7f-4760-b2eb-da22da9cad09) to Test(default) with arguments: #<GlobalID:0x00007fe9e0b7c470 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/4>>
Completed 200 OK in 484ms (Views: 0.9ms | ActiveRecord: 13.9ms | Allocations: 210496)
  [1m[35m (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:48:00 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 5.3ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:48:14 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:48:14.293635', '2023-08-21 19:48:14.293635')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 5 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 5 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('yd65mvkjnsxkyft8tegdm9rudwm2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:48:14')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 5, 5, '2023-08-21 19:48:14')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:48:14.714956' WHERE `users`.`id` = 5[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: yd65mvkjnsxkyft8tegdm9rudwm2 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a223649f-c915-45ab-8fee-af93869381e4) to Test(default) with arguments: #<GlobalID:0x00007f95daffb078 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/5>>
Completed 200 OK in 447ms (Views: 0.4ms | ActiveRecord: 10.8ms | Allocations: 210521)
  [1m[35m (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:48:14 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 22ms (Views: 4.1ms | ActiveRecord: 0.8ms | Allocations: 3002)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:51:05 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:51:05.666275', '2023-08-21 19:51:05.666275')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 6 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 6 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ctsmai8pconk2b1hhms8ub2trec9', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:51:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 6, 6, '2023-08-21 19:51:06')[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:51:06.131247' WHERE `users`.`id` = 6[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: ctsmai8pconk2b1hhms8ub2trec9 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9e311d03-003e-4b8d-9493-d50a47b37853) to Test(default) with arguments: #<GlobalID:0x00007ff7dab99fb8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/6>>
Completed 200 OK in 503ms (Views: 0.4ms | ActiveRecord: 12.2ms | Allocations: 210480)
  [1m[35m (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:51:06 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 5.0ms | ActiveRecord: 0.5ms | Allocations: 3004)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:51:25 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 19:51:25.881925', '2023-08-21 19:51:25.881925')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 7 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 7 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('fd58itojm7yan38ijta4hrpv5q4w', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 19:51:26')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 7, 7, '2023-08-21 19:51:26')[0m
  [1m[36mUser Update (1.0ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 19:51:26.265824' WHERE `users`.`id` = 7[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: fd58itojm7yan38ijta4hrpv5q4w (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 75542833-ac89-4f49-8698-601af2d01dd3) to Test(default) with arguments: #<GlobalID:0x00007f9a85a44260 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/7>>
Completed 200 OK in 421ms (Views: 0.4ms | ActiveRecord: 9.0ms | Allocations: 210525)
  [1m[35m (3.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 04:51:26 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.9ms | ActiveRecord: 0.8ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:52:02 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:52:02.908061', '2023-08-21 20:52:02.908061')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 8 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 8 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('k1m269wja998w5a2611e99o0xn1r', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:52:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 8, 8, '2023-08-21 20:52:03')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:52:03.372672' WHERE `users`.`id` = 8[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: k1m269wja998w5a2611e99o0xn1r (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8e6f2c52-8071-4398-95a3-cd91a8cca636) to Test(default) with arguments: #<GlobalID:0x00007feca267f778 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/8>>
Completed 200 OK in 502ms (Views: 0.5ms | ActiveRecord: 10.2ms | Allocations: 210497)
  [1m[35m (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:52:03 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 6.1ms | ActiveRecord: 0.6ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:52:29 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:52:29.321182', '2023-08-21 20:52:29.321182')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 9 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 9 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2pudafl8au8trv17o6ydk7v1o1mn', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:52:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 9, 9, '2023-08-21 20:52:29')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:52:29.744474' WHERE `users`.`id` = 9[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 2pudafl8au8trv17o6ydk7v1o1mn (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1e526f88-8987-44de-b2eb-c4fbf41dac12) to Test(default) with arguments: #<GlobalID:0x00007fa4ef8cc760 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/9>>
Completed 200 OK in 452ms (Views: 0.6ms | ActiveRecord: 9.6ms | Allocations: 210470)
  [1m[35m (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:52:29 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 3.8ms | ActiveRecord: 1.2ms | Allocations: 3005)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 20:52:29.799175', '2023-08-21 20:52:29.799175')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/10" for 127.0.0.1 at 2023-08-22 05:52:29 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"10"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 10 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 10 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 10 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 20:52:29.817832' WHERE `users`.`id` = 10[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:52:47 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:52:47.734889', '2023-08-21 20:52:47.734889')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 11 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 11 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('bqlzb9ko24c01asfpaduek2al0oc', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:52:48')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 11, 10, '2023-08-21 20:52:48')[0m
  [1m[36mUser Update (0.9ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:52:48.099303' WHERE `users`.`id` = 11[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: bqlzb9ko24c01asfpaduek2al0oc (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 285e5fec-07cb-43e4-a736-89a2db9fa0b0) to Test(default) with arguments: #<GlobalID:0x00007fe22caa30f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/10>>
Completed 200 OK in 389ms (Views: 0.4ms | ActiveRecord: 8.6ms | Allocations: 210507)
  [1m[35m (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:52:48 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 21ms (Views: 4.0ms | ActiveRecord: 1.0ms | Allocations: 3005)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 20:52:48.150745', '2023-08-21 20:52:48.150745')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/12" for 127.0.0.1 at 2023-08-22 05:52:48 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"12"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 12 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 12 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 12 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 20:52:48.166997' WHERE `users`.`id` = 12[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.9ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:53:37 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:53:37.691244', '2023-08-21 20:53:37.691244')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 13 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 13 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('a5j05gsrruksbrp04qhpmo0x1vh4', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:53:38')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 13, 11, '2023-08-21 20:53:38')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:53:38.039795' WHERE `users`.`id` = 13[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.6ms) [0m[32mUploaded file to key: a5j05gsrruksbrp04qhpmo0x1vh4 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e72e38e0-1ef3-4e1f-832b-244ff1ab0417) to Test(default) with arguments: #<GlobalID:0x00007fa46307db90 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/11>>
Completed 200 OK in 376ms (Views: 0.4ms | ActiveRecord: 8.4ms | Allocations: 210491)
  [1m[35m (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:53:38 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.5ms | ActiveRecord: 0.6ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 20:53:38.091373', '2023-08-21 20:53:38.091373')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/14" for 127.0.0.1 at 2023-08-22 05:53:38 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"14"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 14 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 14 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 14 LIMIT 1[0m
  [1m[36mUser Update (1.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 20:53:38.105389' WHERE `users`.`id` = 14[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:53:49 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:53:49.061537', '2023-08-21 20:53:49.061537')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 15 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 15 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ic5vg6mrvfe20m8rdnalgr3yo9dd', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:53:49')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 15, 12, '2023-08-21 20:53:49')[0m
  [1m[36mUser Update (1.0ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:53:49.402471' WHERE `users`.`id` = 15[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: ic5vg6mrvfe20m8rdnalgr3yo9dd (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c24aff31-e283-46ba-a194-f0c449da9b2c) to Test(default) with arguments: #<GlobalID:0x00007fbd831d1530 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/12>>
Completed 200 OK in 370ms (Views: 0.4ms | ActiveRecord: 9.3ms | Allocations: 210508)
  [1m[35m (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:53:49 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.8ms | ActiveRecord: 0.7ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 20:53:49.455633', '2023-08-21 20:53:49.455633')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/16" for 127.0.0.1 at 2023-08-22 05:53:49 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"16"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 16 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 16 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 16 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 20:53:49.473283' WHERE `users`.`id` = 16[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.4ms | ActiveRecord: 3.2ms | Allocations: 2440)
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:55:08 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:55:08.317830', '2023-08-21 20:55:08.317830')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 17 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 17 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('yp0wklpfriflln13kmvud7dwcf9o', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:55:08')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 17, 13, '2023-08-21 20:55:08')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:55:08.687398' WHERE `users`.`id` = 17[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: yp0wklpfriflln13kmvud7dwcf9o (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e9d49792-f3f3-4892-99dd-dc93e68032cc) to Test(default) with arguments: #<GlobalID:0x00007fb549e780f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/13>>
Completed 200 OK in 399ms (Views: 0.4ms | ActiveRecord: 9.3ms | Allocations: 210500)
  [1m[35m (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:55:08 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 5.2ms | ActiveRecord: 0.9ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 20:55:08.744200', '2023-08-21 20:55:08.744200')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/18" for 127.0.0.1 at 2023-08-22 05:55:08 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"18"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 18 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 18 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 18 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 20:55:08.760478' WHERE `users`.`id` = 18[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.9ms | ActiveRecord: 2.4ms | Allocations: 2440)
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 20:55:08.771641', '2023-08-21 20:55:08.771641')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/19" for 127.0.0.1 at 2023-08-22 05:55:08 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"19"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 19 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 19 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 19 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:55:19 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 20:55:19.978272', '2023-08-21 20:55:19.978272')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 20 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 20 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('law1kmryv8cvserbbit0086k0bq1', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 20:55:20')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 20, 14, '2023-08-21 20:55:20')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 20:55:20.326821' WHERE `users`.`id` = 20[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: law1kmryv8cvserbbit0086k0bq1 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: afbe35e2-1305-4c07-bfda-18a6021f70a8) to Test(default) with arguments: #<GlobalID:0x00007fb3fac1b758 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/14>>
Completed 200 OK in 376ms (Views: 0.5ms | ActiveRecord: 8.8ms | Allocations: 210515)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 05:55:20 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.8ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 20:55:20.362046', '2023-08-21 20:55:20.362046')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/21" for 127.0.0.1 at 2023-08-22 05:55:20 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"21"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 21 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 21 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 21 LIMIT 1[0m
  [1m[36mUser Update (2.0ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 20:55:20.378861' WHERE `users`.`id` = 21[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 0.3ms | ActiveRecord: 3.7ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 20:55:20.388585', '2023-08-21 20:55:20.388585')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/22" for 127.0.0.1 at 2023-08-22 05:55:20 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"22"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 22 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 22 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 22 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.5ms | ActiveRecord: 1.4ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:28:21 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:28:21.439607', '2023-08-21 21:28:21.439607')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 23 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 23 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cr4s0u6cic07bkbv3fm69q2fq1xy', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:28:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 23, 15, '2023-08-21 21:28:21')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:28:21.958957' WHERE `users`.`id` = 23[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: cr4s0u6cic07bkbv3fm69q2fq1xy (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 857ff31e-be8a-4ed7-af94-2797de83d3b2) to Test(default) with arguments: #<GlobalID:0x00007fdf868235a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/15>>
Completed 200 OK in 554ms (Views: 0.4ms | ActiveRecord: 9.4ms | Allocations: 210479)
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:28:21 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 6.7ms | ActiveRecord: 0.8ms | Allocations: 3005)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:28:22.016193', '2023-08-21 21:28:22.016193')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/24" for 127.0.0.1 at 2023-08-22 06:28:22 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"24"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 24 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 24 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 24 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:28:22.034099' WHERE `users`.`id` = 24[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:28:22.044937', '2023-08-21 21:28:22.044937')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/25" for 127.0.0.1 at 2023-08-22 06:28:22 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"25"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 25 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 25 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 25 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.5ms | ActiveRecord: 2.0ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:28:22.067392', '2023-08-21 21:28:22.067392')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/users/26" for 127.0.0.1 at 2023-08-22 06:28:22 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"26"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 26 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (1.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 26[0m
  [1m[36mQuestion Load (2.0ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 26[0m
  [1m[36mSubjectQuestion Load (1.9ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 26[0m
  [1m[36mReply Load (1.0ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 26[0m
  [1m[36mSubjectQuestionReply Load (0.9ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 26[0m
  [1m[36mFavoriteBook Load (1.1ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 26[0m
  [1m[36mFavoriteReview Load (0.9ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 26[0m
  [1m[36mFavoriteQuestion Load (0.8ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 26[0m
  [1m[36mFavoriteReply Load (1.7ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 26[0m
  [1m[36mFavoriteSubjectQuestion Load (2.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 26[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.8ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 26[0m
  [1m[36mBrowsingHistory Load (1.0ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 26[0m
  [1m[36mNotification Load (1.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 26[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 26[0m
  [1m[36mFavoriteSurvey Load (1.7ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 26[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 26 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 26[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 122ms (ActiveRecord: 44.7ms | Allocations: 41696)
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:28:43 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:28:43.089100', '2023-08-21 21:28:43.089100')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 27 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 27 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('3tidmcg9a49fzp9gdb4accdfg7q2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:28:43')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 27, 16, '2023-08-21 21:28:43')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:28:43.503541' WHERE `users`.`id` = 27[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: 3tidmcg9a49fzp9gdb4accdfg7q2 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 564c4c8e-6872-43f7-b5b1-95389cf09df3) to Test(default) with arguments: #<GlobalID:0x00007fd17418b968 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/16>>
Completed 200 OK in 444ms (Views: 0.4ms | ActiveRecord: 8.9ms | Allocations: 210518)
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:28:43 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 4.3ms | ActiveRecord: 0.6ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:28:43.559666', '2023-08-21 21:28:43.559666')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/28" for 127.0.0.1 at 2023-08-22 06:28:43 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"28"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 28 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 28 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 28 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:28:43.578207' WHERE `users`.`id` = 28[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:28:43.586479', '2023-08-21 21:28:43.586479')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/29" for 127.0.0.1 at 2023-08-22 06:28:43 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"29"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 29 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 29 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 29 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.5ms | ActiveRecord: 1.2ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:28:43.606574', '2023-08-21 21:28:43.606574')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/users/30" for 127.0.0.1 at 2023-08-22 06:28:43 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"30"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 30 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 30[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 30[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 30[0m
  [1m[36mReply Load (0.6ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 30[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 30[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 30[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 30[0m
  [1m[36mFavoriteQuestion Load (0.6ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 30[0m
  [1m[36mFavoriteReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 30[0m
  [1m[36mFavoriteSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 30[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.9ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 30[0m
  [1m[36mBrowsingHistory Load (0.6ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 30[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 30[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 30[0m
  [1m[36mFavoriteSurvey Load (0.5ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 30[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 30 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 30[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 109ms (ActiveRecord: 28.8ms | Allocations: 41696)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:28:57 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:28:57.304098', '2023-08-21 21:28:57.304098')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 31 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 31 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ta62xk1037bbpnvtctpihl4wakk2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:28:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 31, 17, '2023-08-21 21:28:57')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:28:57.680260' WHERE `users`.`id` = 31[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: ta62xk1037bbpnvtctpihl4wakk2 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bbfe270b-7b0d-406f-a707-1e8dd17c338a) to Test(default) with arguments: #<GlobalID:0x00007f89b16e1238 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/17>>
Completed 200 OK in 403ms (Views: 0.5ms | ActiveRecord: 9.8ms | Allocations: 210487)
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:28:57 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.6ms | ActiveRecord: 0.5ms | Allocations: 3003)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:28:57.717930', '2023-08-21 21:28:57.717930')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/32" for 127.0.0.1 at 2023-08-22 06:28:57 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"32"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 32 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 32 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 32 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:28:57.733242' WHERE `users`.`id` = 32[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.1ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:28:57.743185', '2023-08-21 21:28:57.743185')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/33" for 127.0.0.1 at 2023-08-22 06:28:57 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"33"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 33 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 33 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 33 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 1.0ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:28:57.762953', '2023-08-21 21:28:57.762953')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/34" for 127.0.0.1 at 2023-08-22 06:28:57 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"34"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 34 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 34[0m
  [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 34[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 34[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 34[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 34[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 34[0m
  [1m[36mFavoriteReview Load (1.1ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 34[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 34[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 34[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 34[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 34[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 34[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 34[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 34[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 34[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 34 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 34[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 104ms (ActiveRecord: 25.5ms | Allocations: 41694)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:29:08 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:29:08.851100', '2023-08-21 21:29:08.851100')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 35 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 35 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('uuiwq00wb44jq4n9b13bneh1g43j', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:29:09')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 35, 18, '2023-08-21 21:29:09')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:29:09.237360' WHERE `users`.`id` = 35[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: uuiwq00wb44jq4n9b13bneh1g43j (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a2e6a836-d4f7-457d-beae-8b9ccf7c6c11) to Test(default) with arguments: #<GlobalID:0x00007fb4d0f791f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/18>>
Completed 200 OK in 411ms (Views: 0.4ms | ActiveRecord: 8.9ms | Allocations: 210472)
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:29:09 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.4ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:29:09.273179', '2023-08-21 21:29:09.273179')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/36" for 127.0.0.1 at 2023-08-22 06:29:09 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"36"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 36 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 36 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 36 LIMIT 1[0m
  [1m[36mUser Update (1.0ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:29:09.288775' WHERE `users`.`id` = 36[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.4ms | Allocations: 2440)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:29:09.297919', '2023-08-21 21:29:09.297919')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/37" for 127.0.0.1 at 2023-08-22 06:29:09 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"37"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 37 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 37 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 37 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:29:09.319835', '2023-08-21 21:29:09.319835')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/38" for 127.0.0.1 at 2023-08-22 06:29:09 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"38"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 38 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 38[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 38[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 38[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 38[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 38[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 38[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 38[0m
  [1m[36mFavoriteQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 38[0m
  [1m[36mFavoriteReply Load (0.7ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 38[0m
  [1m[36mFavoriteSubjectQuestion Load (0.7ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 38[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 38[0m
  [1m[36mBrowsingHistory Load (0.6ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 38[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 38[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 38[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 38[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 38 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (1.1ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 38[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 100ms (ActiveRecord: 28.4ms | Allocations: 41694)
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:38:50 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:38:50.121512', '2023-08-21 21:38:50.121512')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 39 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 39 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gy2gxvpgb2uezysihlh6717ri0k7', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:38:50')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 39, 19, '2023-08-21 21:38:50')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:38:50.668355' WHERE `users`.`id` = 39[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.0ms) [0m[32mUploaded file to key: gy2gxvpgb2uezysihlh6717ri0k7 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9fa80c5a-2b15-42fc-ba7a-06a29be0df28) to Test(default) with arguments: #<GlobalID:0x00007f905a63d1d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/19>>
Completed 200 OK in 623ms (Views: 0.4ms | ActiveRecord: 10.1ms | Allocations: 210488)
  [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:38:50 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 6.4ms | ActiveRecord: 0.6ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:38:50.710922', '2023-08-21 21:38:50.710922')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/40" for 127.0.0.1 at 2023-08-22 06:38:50 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"40"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 40 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 40 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 40 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:38:50.724193' WHERE `users`.`id` = 40[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 1.6ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:38:50.732733', '2023-08-21 21:38:50.732733')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/41" for 127.0.0.1 at 2023-08-22 06:38:50 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"41"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 41 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 41 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 41 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.5ms | ActiveRecord: 1.3ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:38:50.752078', '2023-08-21 21:38:50.752078')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/42" for 127.0.0.1 at 2023-08-22 06:38:50 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"42"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 42 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 42[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 42[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 42[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 42[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 42[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 42[0m
  [1m[36mFavoriteReview Load (0.5ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 42[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 42[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 42[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 42[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 42[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 42[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 42[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 42[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 42[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 42 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 42[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 100ms (ActiveRecord: 22.3ms | Allocations: 41696)
  [1m[35m (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 21:38:50.871159', '2023-08-21 21:38:50.871159')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/43" for 127.0.0.1 at 2023-08-22 06:38:50 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"43"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 43 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 43[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 43[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 43[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 43[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 43[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 43[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 43[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 43[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 43[0m
  [1m[36mFavoriteSubjectQuestion Load (0.1ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 43[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 43[0m
  [1m[36mBrowsingHistory Load (0.1ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 43[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 43[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 43[0m
  [1m[36mFavoriteSurvey Load (0.1ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 43[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 43 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (1.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 43[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 15ms (ActiveRecord: 6.0ms | Allocations: 3921)
  [1m[35m (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:39:31 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:39:31.985741', '2023-08-21 21:39:31.985741')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 44 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 44 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('t45w2rv2a35klqz9y04evnytm03i', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:39:32')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 44, 20, '2023-08-21 21:39:32')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:39:32.421586' WHERE `users`.`id` = 44[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: t45w2rv2a35klqz9y04evnytm03i (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 58bb90e7-fbb9-43ac-beb9-3a5a8f5bd2a2) to Test(default) with arguments: #<GlobalID:0x00007fc5311aa880 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/20>>
Completed 200 OK in 462ms (Views: 0.5ms | ActiveRecord: 8.8ms | Allocations: 210477)
  [1m[35m (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:39:32 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 2.9ms | ActiveRecord: 1.0ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:39:32.458434', '2023-08-21 21:39:32.458434')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/45" for 127.0.0.1 at 2023-08-22 06:39:32 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"45"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 45 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 45 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 45 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:39:32.472251' WHERE `users`.`id` = 45[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:39:32.480534', '2023-08-21 21:39:32.480534')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/46" for 127.0.0.1 at 2023-08-22 06:39:32 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"46"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 46 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 46 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 46 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.8ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:39:32.499961', '2023-08-21 21:39:32.499961')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/47" for 127.0.0.1 at 2023-08-22 06:39:32 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"47"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 47 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 47[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 47[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 47[0m
  [1m[36mReply Load (0.6ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 47[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 47[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 47[0m
  [1m[36mFavoriteReview Load (0.6ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 47[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 47[0m
  [1m[36mFavoriteReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 47[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 47[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 47[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 47[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 47[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 47[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 47[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 47 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 47[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 87ms (ActiveRecord: 23.3ms | Allocations: 41695)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 21:39:32.604736', '2023-08-21 21:39:32.604736')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/48" for 127.0.0.1 at 2023-08-22 06:39:32 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"48"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 48 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 48[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 48[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 48[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 48[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 48[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 48[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 48[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 48[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 48[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 48[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 48[0m
  [1m[36mBrowsingHistory Load (0.2ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 48[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 48[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 48[0m
  [1m[36mFavoriteSurvey Load (0.1ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 48[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 48 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 48[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 13ms (ActiveRecord: 4.5ms | Allocations: 3921)
  [1m[35m (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:40:44 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 21:40:44.905874', '2023-08-21 21:40:44.905874')[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 49 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 49 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xmz536615ozy4bljxwwz2a4j060z', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 21:40:45')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 49, 21, '2023-08-21 21:40:45')[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 21:40:45.454036' WHERE `users`.`id` = 49[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.5ms) [0m[32mUploaded file to key: xmz536615ozy4bljxwwz2a4j060z (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 52fd2d73-7121-495c-8609-c70f110a2751) to Test(default) with arguments: #<GlobalID:0x00007fe88ac448c8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/21>>
Completed 200 OK in 617ms (Views: 0.4ms | ActiveRecord: 10.3ms | Allocations: 210486)
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 06:40:45 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 5.4ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 21:40:45.498770', '2023-08-21 21:40:45.498770')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/50" for 127.0.0.1 at 2023-08-22 06:40:45 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"50"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 50 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 50 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 50 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 21:40:45.515142' WHERE `users`.`id` = 50[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.2ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 21:40:45.524652', '2023-08-21 21:40:45.524652')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/51" for 127.0.0.1 at 2023-08-22 06:40:45 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"51"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 51 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 51 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 51 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 21:40:45.545559', '2023-08-21 21:40:45.545559')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/52" for 127.0.0.1 at 2023-08-22 06:40:45 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"52"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 52 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 52[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 52[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 52[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 52[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 52[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 52[0m
  [1m[36mFavoriteReview Load (0.5ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 52[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 52[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 52[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 52[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 52[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 52[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 52[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 52[0m
  [1m[36mFavoriteSurvey Load (0.5ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 52[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 52 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 52[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 102ms (ActiveRecord: 23.7ms | Allocations: 41694)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 21:40:45.665894', '2023-08-21 21:40:45.665894')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 53 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 21:40:45.668935' WHERE `users`.`id` = 53[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/53" for 127.0.0.1 at 2023-08-22 06:40:45 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"53"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 53 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 270)
  [1m[35m (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:10:27 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 22:10:27.593227', '2023-08-21 22:10:27.593227')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 54 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 54 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2c0avpiy1sziuoxqjh3flhox37m6', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 22:10:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 54, 22, '2023-08-21 22:10:28')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 22:10:28.158725' WHERE `users`.`id` = 54[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: 2c0avpiy1sziuoxqjh3flhox37m6 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c04e4b54-3fd5-4024-989f-c6e3a4a09750) to Test(default) with arguments: #<GlobalID:0x00007fef5dc370b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/22>>
Completed 200 OK in 609ms (Views: 0.4ms | ActiveRecord: 9.4ms | Allocations: 210458)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:10:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 6.8ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 22:10:28.201106', '2023-08-21 22:10:28.201106')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/55" for 127.0.0.1 at 2023-08-22 07:10:28 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"55"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 55 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 55 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 55 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 22:10:28.218638' WHERE `users`.`id` = 55[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 22:10:28.228094', '2023-08-21 22:10:28.228094')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/56" for 127.0.0.1 at 2023-08-22 07:10:28 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"56"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 56 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 56 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 56 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.5ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 22:10:28.249367', '2023-08-21 22:10:28.249367')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/57" for 127.0.0.1 at 2023-08-22 07:10:28 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"57"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 57 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 57[0m
  [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 57[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 57[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 57[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 57[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 57[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 57[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 57[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 57[0m
  [1m[36mFavoriteSubjectQuestion Load (1.0ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 57[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.7ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 57[0m
  [1m[36mBrowsingHistory Load (0.6ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 57[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 57[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 57[0m
  [1m[36mFavoriteSurvey Load (0.6ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 57[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 57 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (1.1ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 57[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 123ms (ActiveRecord: 31.8ms | Allocations: 41694)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 22:10:28.390338', '2023-08-21 22:10:28.390338')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 58 LIMIT 1[0m
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 22:10:28.393768' WHERE `users`.`id` = 58[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/58" for 127.0.0.1 at 2023-08-22 07:10:28 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"58"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 58 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 270)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-21 22:10:28.414207', '2023-08-21 22:10:28.414207')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/59" for 127.0.0.1 at 2023-08-22 07:10:28 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"59"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 59 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 59[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 59[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 59[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 59[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 59[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 59[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 59[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 59[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 59[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 59[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 59[0m
  [1m[36mSurvey Load (1.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 59[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 59[0m
Completed 200 OK in 45ms (Views: 0.3ms | ActiveRecord: 18.2ms | Allocations: 12300)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 22:16:08.096826', '2023-08-21 22:16:08.096826')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 60 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 60 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('q2k98to8x6qr3s85qycef202vpyu', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 22:16:08')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 60, 23, '2023-08-21 22:16:08')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 22:16:08.558886' WHERE `users`.`id` = 60[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: q2k98to8x6qr3s85qycef202vpyu (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 920adb2f-c9eb-4f06-ab45-9e0e9eea56a7) to Test(default) with arguments: #<GlobalID:0x00007fa0a8d93000 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/23>>
Completed 200 OK in 502ms (Views: 0.6ms | ActiveRecord: 12.1ms | Allocations: 210462)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 6.5ms | ActiveRecord: 0.5ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 22:16:08.601384', '2023-08-21 22:16:08.601384')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/61" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"61"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 61 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 61 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 61 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 22:16:08.616311' WHERE `users`.`id` = 61[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.8ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 22:16:08.625496', '2023-08-21 22:16:08.625496')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/62" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"62"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 62 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 62 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 62 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.5ms | ActiveRecord: 1.4ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 22:16:08.644636', '2023-08-21 22:16:08.644636')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/63" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"63"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 63 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 63[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 63[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 63[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 63[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 63[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 63[0m
  [1m[36mFavoriteReview Load (0.2ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 63[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 63[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 63[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 63[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 63[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 63[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 63[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 63[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 63[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 63 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (1.1ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 63[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 103ms (ActiveRecord: 24.2ms | Allocations: 41695)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 22:16:08.764392', '2023-08-21 22:16:08.764392')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 64 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 22:16:08.768512' WHERE `users`.`id` = 64[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 64 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/64" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"64"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 64 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 266)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-21 22:16:08.786787', '2023-08-21 22:16:08.786787')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 65 LIMIT 1[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-21 22:16:08.789400' WHERE `users`.`id` = 65[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 65 LIMIT 1[0m
Started GET "/users/65" for 127.0.0.1 at 2023-08-22 07:16:08 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"65"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 65 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.9ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 65[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 65[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 65[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 65[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 65[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 65[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 65[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 65[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 65[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 65[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 65[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 65[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 65[0m
Completed 200 OK in 36ms (Views: 0.2ms | ActiveRecord: 10.6ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:17:14 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 22:17:14.734716', '2023-08-21 22:17:14.734716')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 66 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 66 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gx2vvtmfhj5xgk9hy3foi29agc4g', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 22:17:15')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 66, 24, '2023-08-21 22:17:15')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 22:17:15.139354' WHERE `users`.`id` = 66[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: gx2vvtmfhj5xgk9hy3foi29agc4g (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d906965a-5abf-4eb6-885e-d95e799495d0) to Test(default) with arguments: #<GlobalID:0x00007fcedaecb6d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/24>>
Completed 200 OK in 431ms (Views: 0.4ms | ActiveRecord: 7.6ms | Allocations: 210509)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:17:15 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 5.6ms | ActiveRecord: 1.1ms | Allocations: 3003)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 22:17:15.181199', '2023-08-21 22:17:15.181199')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/67" for 127.0.0.1 at 2023-08-22 07:17:15 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"67"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 67 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 67 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 67 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 22:17:15.210483' WHERE `users`.`id` = 67[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 1.8ms | Allocations: 2442)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 22:17:15.218506', '2023-08-21 22:17:15.218506')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/68" for 127.0.0.1 at 2023-08-22 07:17:15 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"68"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 68 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 68 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 68 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.7ms | ActiveRecord: 1.4ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 22:17:15.239420', '2023-08-21 22:17:15.239420')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/69" for 127.0.0.1 at 2023-08-22 07:17:15 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"69"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 69 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 69[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 69[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 69[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 69[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 69[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 69[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 69[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 69[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 69[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 69[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 69[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 69[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 69[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 69[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 69[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 69 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 69[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 97ms (ActiveRecord: 24.7ms | Allocations: 41696)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 22:17:15.353648', '2023-08-21 22:17:15.353648')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 70 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 22:17:15.357228' WHERE `users`.`id` = 70[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 70 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/70" for 127.0.0.1 at 2023-08-22 07:17:15 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"70"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 70 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 266)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-21 22:17:15.374725', '2023-08-21 22:17:15.374725')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 71 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-21 22:17:15.377075' WHERE `users`.`id` = 71[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 71 LIMIT 1[0m
Started GET "/users/71" for 127.0.0.1 at 2023-08-22 07:17:15 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"71"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 71 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 71[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 71[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 71[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 71[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 71[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 71[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 71[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 71[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 71[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 71[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 71[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 71[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 71[0m
Completed 200 OK in 36ms (Views: 0.3ms | ActiveRecord: 12.5ms | Allocations: 12300)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:22:01 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 22:22:01.751196', '2023-08-21 22:22:01.751196')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 72 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 72 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gwvaoh8ooz7s0z51omt3idbnmoft', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 22:22:02')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 72, 25, '2023-08-21 22:22:02')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 22:22:02.262567' WHERE `users`.`id` = 72[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: gwvaoh8ooz7s0z51omt3idbnmoft (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d7873cb6-5914-408e-8e64-d479ad48d743) to Test(default) with arguments: #<GlobalID:0x00007f8970f48430 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/25>>
Completed 200 OK in 554ms (Views: 0.4ms | ActiveRecord: 11.7ms | Allocations: 210451)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:22:02 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 6.3ms | ActiveRecord: 0.5ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 22:22:02.304535', '2023-08-21 22:22:02.304535')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/73" for 127.0.0.1 at 2023-08-22 07:22:02 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"73"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 73 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 73 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 73 LIMIT 1[0m
  [1m[36mUser Update (1.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 22:22:02.318339' WHERE `users`.`id` = 73[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 22:22:02.328866', '2023-08-21 22:22:02.328866')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/74" for 127.0.0.1 at 2023-08-22 07:22:02 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"74"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 74 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 74 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 74 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.5ms | ActiveRecord: 1.2ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 22:22:02.349606', '2023-08-21 22:22:02.349606')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/75" for 127.0.0.1 at 2023-08-22 07:22:02 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"75"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 75 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 75[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 75[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 75[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 75[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 75[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 75[0m
  [1m[36mFavoriteReview Load (0.2ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 75[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 75[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 75[0m
  [1m[36mFavoriteSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 75[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 75[0m
  [1m[36mBrowsingHistory Load (0.2ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 75[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 75[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 75[0m
  [1m[36mFavoriteSurvey Load (0.6ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 75[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 75 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 75[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 98ms (ActiveRecord: 21.5ms | Allocations: 41694)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 22:22:02.464287', '2023-08-21 22:22:02.464287')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 76 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 22:22:02.466675' WHERE `users`.`id` = 76[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 76 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/76" for 127.0.0.1 at 2023-08-22 07:22:02 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"76"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 76 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 266)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-21 22:22:02.486006', '2023-08-21 22:22:02.486006')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 77 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-21 22:22:02.489507' WHERE `users`.`id` = 77[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 77 LIMIT 1[0m
Started GET "/users/77" for 127.0.0.1 at 2023-08-22 07:22:02 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"77"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 77 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 77[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 77[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 77[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 77[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 77[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 77[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 77[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 77[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 77[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 77[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 77[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 77[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 77[0m
Completed 200 OK in 47ms (Views: 0.3ms | ActiveRecord: 11.2ms | Allocations: 12302)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-21 22:22:02.554364', '2023-08-21 22:22:02.554364')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:22:17 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 22:22:17.831758', '2023-08-21 22:22:17.831758')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 79 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 79 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('52qfklwxbkjzx4weory3jrbw5e4n', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 22:22:18')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 79, 26, '2023-08-21 22:22:18')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 22:22:18.273666' WHERE `users`.`id` = 79[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: 52qfklwxbkjzx4weory3jrbw5e4n (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1442e2cb-b216-43e3-94ed-e328b71f70c3) to Test(default) with arguments: #<GlobalID:0x00007f8314819fe0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/26>>
Completed 200 OK in 471ms (Views: 0.5ms | ActiveRecord: 10.6ms | Allocations: 210469)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:22:18 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.6ms | ActiveRecord: 0.7ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 22:22:18.315603', '2023-08-21 22:22:18.315603')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/80" for 127.0.0.1 at 2023-08-22 07:22:18 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"80"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 80 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.9ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 80 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 80 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 22:22:18.333358' WHERE `users`.`id` = 80[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 22:22:18.341548', '2023-08-21 22:22:18.341548')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/81" for 127.0.0.1 at 2023-08-22 07:22:18 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"81"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 81 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 81 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 81 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.7ms | ActiveRecord: 2.1ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 22:22:18.364884', '2023-08-21 22:22:18.364884')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/82" for 127.0.0.1 at 2023-08-22 07:22:18 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"82"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 82 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 82[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 82[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 82[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 82[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 82[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 82[0m
  [1m[36mFavoriteReview Load (0.5ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 82[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 82[0m
  [1m[36mFavoriteReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 82[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 82[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 82[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 82[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 82[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 82[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 82[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 82 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.6ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 82[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 94ms (ActiveRecord: 25.4ms | Allocations: 41694)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 22:22:18.480311', '2023-08-21 22:22:18.480311')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 83 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 22:22:18.484377' WHERE `users`.`id` = 83[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 83 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/83" for 127.0.0.1 at 2023-08-22 07:22:18 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"83"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 83 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-21 22:22:18.505491', '2023-08-21 22:22:18.505491')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 84 LIMIT 1[0m
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-21 22:22:18.509073' WHERE `users`.`id` = 84[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 84 LIMIT 1[0m
Started GET "/users/84" for 127.0.0.1 at 2023-08-22 07:22:18 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"84"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 84 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 84[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 84[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 84[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 84[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 84[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 84[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 84[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 84[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 84[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 84[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 84[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 84[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 84[0m
Completed 200 OK in 37ms (Views: 0.3ms | ActiveRecord: 13.3ms | Allocations: 12297)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-21 22:22:18.563446', '2023-08-21 22:22:18.563446')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:22:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-21 22:22:28.534382', '2023-08-21 22:22:28.534382')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 86 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 86 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0ae130twowmut36dyqg233g3acia', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-21 22:22:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 86, 27, '2023-08-21 22:22:28')[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-21 22:22:28.899722' WHERE `users`.`id` = 86[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: 0ae130twowmut36dyqg233g3acia (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b526ff8c-6ff2-4e3b-a7bd-316cd02ce360) to Test(default) with arguments: #<GlobalID:0x00007ffa5a8453a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/27>>
Completed 200 OK in 397ms (Views: 0.6ms | ActiveRecord: 9.6ms | Allocations: 210497)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 07:22:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 4.1ms | ActiveRecord: 0.6ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-21 22:22:28.939551', '2023-08-21 22:22:28.939551')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/87" for 127.0.0.1 at 2023-08-22 07:22:28 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"87"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 87 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 87 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 87 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-21 22:22:28.955222' WHERE `users`.`id` = 87[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 1.8ms | Allocations: 2440)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-21 22:22:28.964261', '2023-08-21 22:22:28.964261')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/88" for 127.0.0.1 at 2023-08-22 07:22:28 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"88"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 88 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 88 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 88 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-21 22:22:28.988017', '2023-08-21 22:22:28.988017')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/89" for 127.0.0.1 at 2023-08-22 07:22:28 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"89"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 89 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 89[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 89[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 89[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 89[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 89[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 89[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 89[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 89[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 89[0m
  [1m[36mFavoriteSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 89[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 89[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 89[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 89[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 89[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 89[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 89 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 89[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 96ms (ActiveRecord: 25.6ms | Allocations: 41696)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-21 22:22:29.100758', '2023-08-21 22:22:29.100758')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 90 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-21 22:22:29.104189' WHERE `users`.`id` = 90[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 90 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/90" for 127.0.0.1 at 2023-08-22 07:22:29 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"90"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 90 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-21 22:22:29.124244', '2023-08-21 22:22:29.124244')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 91 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-21 22:22:29.127636' WHERE `users`.`id` = 91[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 91 LIMIT 1[0m
Started GET "/users/91" for 127.0.0.1 at 2023-08-22 07:22:29 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"91"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 91 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 91[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 91[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 91[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 91[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 91[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 91[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 91[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 91[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 91[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 91[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 91[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 91[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 91[0m
Completed 200 OK in 39ms (Views: 0.3ms | ActiveRecord: 13.3ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-21 22:22:29.184137', '2023-08-21 22:22:29.184137')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/92" for 127.0.0.1 at 2023-08-22 07:22:29 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"92"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 92 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 92[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 92[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 92[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 92[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 92[0m
  [1m[36mReply Load (0.6ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 92[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 92[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 92[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 92[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 92[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 92[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 92[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 92[0m
Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 5.9ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 16:56:02 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (9.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 07:56:02.342457', '2023-08-22 07:56:02.342457')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (1.9ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 93 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 93 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kv9hug6n7evjvsrf7xl2nsn9gv91', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 07:56:02')[0m
  [1m[36mActiveStorage::Attachment Create (0.9ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 93, 28, '2023-08-22 07:56:02')[0m
  [1m[36mUser Update (2.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 07:56:02.840438' WHERE `users`.`id` = 93[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: kv9hug6n7evjvsrf7xl2nsn9gv91 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 43b0f5c0-4f21-4d2d-b5a4-5291570bb95f) to Test(default) with arguments: #<GlobalID:0x00007fe12cbe4618 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/28>>
Completed 200 OK in 546ms (Views: 0.4ms | ActiveRecord: 28.5ms | Allocations: 210481)
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (3.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 16:56:02 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 6.5ms | ActiveRecord: 0.9ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 07:56:02.891448', '2023-08-22 07:56:02.891448')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/94" for 127.0.0.1 at 2023-08-22 16:56:02 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"94"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 94 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 94 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 94 LIMIT 1[0m
  [1m[36mUser Update (1.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 07:56:02.908559' WHERE `users`.`id` = 94[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.3ms | ActiveRecord: 3.5ms | Allocations: 2440)
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 07:56:02.920147', '2023-08-22 07:56:02.920147')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/95" for 127.0.0.1 at 2023-08-22 16:56:02 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"95"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 95 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 95 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 95 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 07:56:02.941433', '2023-08-22 07:56:02.941433')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/96" for 127.0.0.1 at 2023-08-22 16:56:02 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"96"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 96 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 96[0m
  [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 96[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 96[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 96[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 96[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 96[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 96[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 96[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 96[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 96[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 96[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 96[0m
  [1m[36mNotification Load (0.6ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 96[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 96[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 96[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 96 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.7ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 96[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 106ms (ActiveRecord: 27.2ms | Allocations: 41694)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 07:56:03.065460', '2023-08-22 07:56:03.065460')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 97 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 07:56:03.070587' WHERE `users`.`id` = 97[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 97 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/97" for 127.0.0.1 at 2023-08-22 16:56:03 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"97"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 97 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 07:56:03.091340', '2023-08-22 07:56:03.091340')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 98 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 07:56:03.095027' WHERE `users`.`id` = 98[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 98 LIMIT 1[0m
Started GET "/users/98" for 127.0.0.1 at 2023-08-22 16:56:03 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"98"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 98 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 98[0m
  [1m[36mReview Load (1.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 98[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 98[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 98[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 98[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 98[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 98[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 98[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 98[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 98[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 98[0m
  [1m[36mSurvey Load (1.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 98[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 98[0m
Completed 200 OK in 42ms (Views: 0.2ms | ActiveRecord: 14.9ms | Allocations: 12297)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 07:56:03.155264', '2023-08-22 07:56:03.155264')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/99" for 127.0.0.1 at 2023-08-22 16:56:03 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"99"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 99 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 99[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 99[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 99[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 99[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 99[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 99[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 99[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 99[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 99[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 99[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 99[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 99[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 99[0m
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 6.2ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:02:03 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:02:03.889040', '2023-08-22 08:02:03.889040')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 100 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 100 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pbpzy7papkf2sf3v58qz7rkxdony', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:02:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 100, 29, '2023-08-22 08:02:04')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:02:04.337253' WHERE `users`.`id` = 100[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: pbpzy7papkf2sf3v58qz7rkxdony (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: df776bc3-0715-4949-881a-6f2ecc0ef44f) to Test(default) with arguments: #<GlobalID:0x00007fb912793ce0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/29>>
Completed 200 OK in 482ms (Views: 0.4ms | ActiveRecord: 9.5ms | Allocations: 210507)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 6.2ms | ActiveRecord: 0.9ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (15.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:02:04.393847', '2023-08-22 08:02:04.393847')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/101" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"101"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 101 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 101 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 101 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:02:04.413648' WHERE `users`.`id` = 101[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:02:04.422713', '2023-08-22 08:02:04.422713')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/102" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"102"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 102 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 102 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 102 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.8ms | ActiveRecord: 1.8ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:02:04.445323', '2023-08-22 08:02:04.445323')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/103" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"103"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 103 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 103[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 103[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 103[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 103[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 103[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 103[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 103[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 103[0m
  [1m[36mFavoriteReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 103[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 103[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 103[0m
  [1m[36mBrowsingHistory Load (0.5ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 103[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 103[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 103[0m
  [1m[36mFavoriteSurvey Load (0.2ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 103[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 103 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (1.0ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 103[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 109ms (ActiveRecord: 26.4ms | Allocations: 41696)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:02:04.573873', '2023-08-22 08:02:04.573873')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 104 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:02:04.578338' WHERE `users`.`id` = 104[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 104 LIMIT 1[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/104" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"104"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 104 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 266)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:02:04.599202', '2023-08-22 08:02:04.599202')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 105 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:02:04.603371' WHERE `users`.`id` = 105[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 105 LIMIT 1[0m
Started GET "/users/105" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"105"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 105 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 105[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 105[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 105[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 105[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 105[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 105[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 105[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 105[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 105[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 105[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 105[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 105[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 105[0m
Completed 200 OK in 39ms (Views: 0.3ms | ActiveRecord: 12.9ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:02:04.659868', '2023-08-22 08:02:04.659868')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/106" for 127.0.0.1 at 2023-08-22 17:02:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"106"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 106 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 106[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 106[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 106[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 106[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 106[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 106[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 106[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 106[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 106[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 106[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 106[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 106[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 106[0m
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 5.5ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:02:22 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:02:22.406770', '2023-08-22 08:02:22.406770')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (1.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 107 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 107 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('817ea6wmp52le8vhevdp5fe2kt3h', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:02:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 107, 30, '2023-08-22 08:02:22')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:02:22.823286' WHERE `users`.`id` = 107[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: 817ea6wmp52le8vhevdp5fe2kt3h (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5eddade7-b1fe-42db-9e51-ba91ee197637) to Test(default) with arguments: #<GlobalID:0x00007fd7b7a2b340 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/30>>
Completed 200 OK in 466ms (Views: 0.4ms | ActiveRecord: 11.6ms | Allocations: 210493)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:02:22 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 6.0ms | ActiveRecord: 0.8ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:02:22.877620', '2023-08-22 08:02:22.877620')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/108" for 127.0.0.1 at 2023-08-22 17:02:22 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"108"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 108 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 108 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 108 LIMIT 1[0m
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:02:22.895627' WHERE `users`.`id` = 108[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 2.4ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:02:22.905874', '2023-08-22 08:02:22.905874')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/109" for 127.0.0.1 at 2023-08-22 17:02:22 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"109"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 109 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 109 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 109 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.9ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:02:22.929570', '2023-08-22 08:02:22.929570')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/110" for 127.0.0.1 at 2023-08-22 17:02:22 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"110"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 110 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 110[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 110[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 110[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 110[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 110[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 110[0m
  [1m[36mFavoriteReview Load (0.2ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 110[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 110[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 110[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 110[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 110[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 110[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 110[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 110[0m
  [1m[36mFavoriteSurvey Load (0.6ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 110[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 110 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 110[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 99ms (ActiveRecord: 24.1ms | Allocations: 41696)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:02:23.046352', '2023-08-22 08:02:23.046352')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 111 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:02:23.049472' WHERE `users`.`id` = 111[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 111 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/111" for 127.0.0.1 at 2023-08-22 17:02:23 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"111"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 111 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 266)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:02:23.069298', '2023-08-22 08:02:23.069298')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 112 LIMIT 1[0m
  [1m[36mUser Update (1.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:02:23.073368' WHERE `users`.`id` = 112[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 112 LIMIT 1[0m
Started GET "/users/112" for 127.0.0.1 at 2023-08-22 17:02:23 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"112"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 112 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 112[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 112[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 112[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 112[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 112[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 112[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 112[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 112[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 112[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 112[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 112[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 112[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 112[0m
Completed 200 OK in 39ms (Views: 0.3ms | ActiveRecord: 12.6ms | Allocations: 12299)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:02:23.131015', '2023-08-22 08:02:23.131015')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/113" for 127.0.0.1 at 2023-08-22 17:02:23 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"113"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 113 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 113[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 113[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 113[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 113[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 113[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 113[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 113[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 113[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 113[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 113[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 113[0m
  [1m[36mSurvey Load (0.2ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 113[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 113[0m
Completed 200 OK in 17ms (Views: 0.3ms | ActiveRecord: 5.5ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/-1" for 127.0.0.1 at 2023-08-22 17:02:23 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 3ms (ActiveRecord: 1.3ms | Allocations: 1065)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:22:50 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:22:50.325117', '2023-08-22 08:22:50.325117')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 114 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 114 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('aq0jxg4oebklo88rkjkzmdjmfwnm', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:22:50')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 114, 31, '2023-08-22 08:22:50')[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:22:50.889749' WHERE `users`.`id` = 114[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (4.0ms) [0m[32mUploaded file to key: aq0jxg4oebklo88rkjkzmdjmfwnm (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5453c1f3-c09f-4a04-a54d-4901d2d6872b) to Test(default) with arguments: #<GlobalID:0x00007fed171ee6a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/31>>
Completed 200 OK in 624ms (Views: 0.6ms | ActiveRecord: 12.8ms | Allocations: 210482)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:22:50 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 6.1ms | ActiveRecord: 0.7ms | Allocations: 3005)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:22:50.953950', '2023-08-22 08:22:50.953950')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/115" for 127.0.0.1 at 2023-08-22 17:22:50 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"115"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 115 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 115 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 115 LIMIT 1[0m
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:22:50.970010' WHERE `users`.`id` = 115[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:22:50.978656', '2023-08-22 08:22:50.978656')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/116" for 127.0.0.1 at 2023-08-22 17:22:50 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"116"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 116 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 116 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 116 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.6ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:22:51.000806', '2023-08-22 08:22:51.000806')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/117" for 127.0.0.1 at 2023-08-22 17:22:51 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"117"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 117 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 117[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 117[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 117[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 117[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 117[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 117[0m
  [1m[36mFavoriteReview Load (0.5ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 117[0m
  [1m[36mFavoriteQuestion Load (1.0ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 117[0m
  [1m[36mFavoriteReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 117[0m
  [1m[36mFavoriteSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 117[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 117[0m
  [1m[36mBrowsingHistory Load (0.5ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 117[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 117[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 117[0m
  [1m[36mFavoriteSurvey Load (0.5ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 117[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 117 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 117[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 104ms (ActiveRecord: 26.9ms | Allocations: 41696)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:22:51.120976', '2023-08-22 08:22:51.120976')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 118 LIMIT 1[0m
  [1m[36mUser Update (1.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:22:51.125703' WHERE `users`.`id` = 118[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 118 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/118" for 127.0.0.1 at 2023-08-22 17:22:51 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"118"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 118 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 266)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:22:51.146454', '2023-08-22 08:22:51.146454')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 119 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:22:51.151391' WHERE `users`.`id` = 119[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 119 LIMIT 1[0m
Started GET "/users/119" for 127.0.0.1 at 2023-08-22 17:22:51 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"119"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 119 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 119[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 119[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 119[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 119[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 119[0m
  [1m[36mReply Load (0.6ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 119[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 119[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 119[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 119[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 119[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 119[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 119[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 119[0m
Completed 200 OK in 40ms (Views: 0.2ms | ActiveRecord: 12.5ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:22:51.208614', '2023-08-22 08:22:51.208614')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/120" for 127.0.0.1 at 2023-08-22 17:22:51 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"120"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 120 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 120[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 120[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 120[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 120[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 120[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 120[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 120[0m
  [1m[36mSubjectQuestion Load (0.8ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 120[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 120[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 120[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 120[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 120[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 120[0m
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 5.5ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/-1" for 127.0.0.1 at 2023-08-22 17:22:51 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.5ms | Allocations: 1065)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:23:03 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:23:03.537344', '2023-08-22 08:23:03.537344')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 121 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 121 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('18td0noc50gzvl7t5qute5itpt0g', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:23:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 121, 32, '2023-08-22 08:23:03')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:23:03.886645' WHERE `users`.`id` = 121[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 18td0noc50gzvl7t5qute5itpt0g (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f96e7acf-f850-4e6d-acce-4fe5ef582f6d) to Test(default) with arguments: #<GlobalID:0x00007f999f9ad018 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/32>>
Completed 200 OK in 378ms (Views: 0.3ms | ActiveRecord: 11.2ms | Allocations: 210500)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:23:03 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 22ms (Views: 3.9ms | ActiveRecord: 0.9ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:23:03.940753', '2023-08-22 08:23:03.940753')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/122" for 127.0.0.1 at 2023-08-22 17:23:03 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"122"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 122 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 122 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 122 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:23:03.957909' WHERE `users`.`id` = 122[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:23:03.964913', '2023-08-22 08:23:03.964913')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/123" for 127.0.0.1 at 2023-08-22 17:23:03 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"123"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 123 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 123 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 123 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.5ms | ActiveRecord: 2.1ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:23:03.986819', '2023-08-22 08:23:03.986819')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/124" for 127.0.0.1 at 2023-08-22 17:23:03 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"124"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 124 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 124[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 124[0m
  [1m[36mSubjectQuestion Load (0.8ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 124[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 124[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 124[0m
  [1m[36mFavoriteBook Load (0.7ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 124[0m
  [1m[36mFavoriteReview Load (0.7ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 124[0m
  [1m[36mFavoriteQuestion Load (0.6ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 124[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 124[0m
  [1m[36mFavoriteSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 124[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 124[0m
  [1m[36mBrowsingHistory Load (0.6ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 124[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 124[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 124[0m
  [1m[36mFavoriteSurvey Load (0.6ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 124[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 124 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 124[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 115ms (ActiveRecord: 29.3ms | Allocations: 41696)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:23:04.121287', '2023-08-22 08:23:04.121287')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 125 LIMIT 1[0m
  [1m[36mUser Update (1.0ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:23:04.125116' WHERE `users`.`id` = 125[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 125 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/125" for 127.0.0.1 at 2023-08-22 17:23:04 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"125"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 125 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:23:04.148546', '2023-08-22 08:23:04.148546')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 126 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:23:04.153754' WHERE `users`.`id` = 126[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 126 LIMIT 1[0m
Started GET "/users/126" for 127.0.0.1 at 2023-08-22 17:23:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"126"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 126 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 126[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 126[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 126[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 126[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 126[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 126[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 126[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 126[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 126[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 126[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 126[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 126[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 126[0m
Completed 200 OK in 38ms (Views: 0.2ms | ActiveRecord: 14.5ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:23:04.211707', '2023-08-22 08:23:04.211707')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/127" for 127.0.0.1 at 2023-08-22 17:23:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"127"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 127 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 127[0m
  [1m[36mReview Load (0.7ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 127[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 127[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 127[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 127[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 127[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 127[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 127[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 127[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 127[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 127[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 127[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 127[0m
Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/-1" for 127.0.0.1 at 2023-08-22 17:23:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.4ms | Allocations: 1067)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:35:03 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:35:03.603179', '2023-08-22 08:35:03.603179')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 128 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 128 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7xgs0gjnp6kes4sttumh30ovvu06', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:35:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 128, 33, '2023-08-22 08:35:04')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:35:04.039197' WHERE `users`.`id` = 128[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: 7xgs0gjnp6kes4sttumh30ovvu06 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a8332e5c-f869-4ba1-9d89-47c00297075c) to Test(default) with arguments: #<GlobalID:0x00007fe054e3d4b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/33>>
Completed 200 OK in 465ms (Views: 0.4ms | ActiveRecord: 10.8ms | Allocations: 210454)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.5ms | ActiveRecord: 0.8ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:35:04.088131', '2023-08-22 08:35:04.088131')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/129" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"129"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 129 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 129 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 129 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:35:04.104046' WHERE `users`.`id` = 129[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.6ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:35:04.111597', '2023-08-22 08:35:04.111597')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/130" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"130"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 130 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 130 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 130 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:35:04.132345', '2023-08-22 08:35:04.132345')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/131" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"131"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 131 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 131[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 131[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 131[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 131[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 131[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 131[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 131[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 131[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 131[0m
  [1m[36mFavoriteSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 131[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 131[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 131[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 131[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 131[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 131[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 131 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 131[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 91ms (ActiveRecord: 24.2ms | Allocations: 41696)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:35:04.239975', '2023-08-22 08:35:04.239975')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 132 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:35:04.242615' WHERE `users`.`id` = 132[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 132 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/132" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"132"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 132 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:35:04.260732', '2023-08-22 08:35:04.260732')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 133 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:35:04.264313' WHERE `users`.`id` = 133[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 133 LIMIT 1[0m
Started GET "/users/133" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"133"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 133 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 133[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 133[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 133[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 133[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 133[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 133[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 133[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 133[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 133[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 133[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 133[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 133[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 133[0m
Completed 200 OK in 33ms (Views: 0.2ms | ActiveRecord: 10.9ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:35:04.311822', '2023-08-22 08:35:04.311822')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/134" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"134"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 134 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 134[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 134[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 134[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 134[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 134[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 134[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 134[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 134[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 134[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 134[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 134[0m
  [1m[36mSurvey Load (0.2ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 134[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 134[0m
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:35:04.341206', '2023-08-22 08:35:04.341206')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo.135" for 127.0.0.1 at 2023-08-22 17:35:04 +0900
Processing by UsersController#save_user_memo as */*
  Parameters: {"memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.6ms | Allocations: 892)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:35:51 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:35:51.690277', '2023-08-22 08:35:51.690277')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 136 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 136 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('80ao9yvqeqalt0rvv9ud85xeri23', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:35:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 136, 34, '2023-08-22 08:35:52')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:35:52.098429' WHERE `users`.`id` = 136[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: 80ao9yvqeqalt0rvv9ud85xeri23 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1d4ae45d-62a8-422f-89d2-ef22694d97df) to Test(default) with arguments: #<GlobalID:0x00007ffa8685f060 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/34>>
Completed 200 OK in 435ms (Views: 0.6ms | ActiveRecord: 9.6ms | Allocations: 210450)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.2ms | ActiveRecord: 0.9ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:35:52.135663', '2023-08-22 08:35:52.135663')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/137" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"137"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 137 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 137 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 137 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:35:52.152407' WHERE `users`.`id` = 137[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 1.8ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:35:52.160878', '2023-08-22 08:35:52.160878')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/138" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"138"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 138 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 138 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 138 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.5ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:35:52.181101', '2023-08-22 08:35:52.181101')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/139" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"139"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 139 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 139[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 139[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 139[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 139[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 139[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 139[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 139[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 139[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 139[0m
  [1m[36mFavoriteSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 139[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 139[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 139[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 139[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 139[0m
  [1m[36mFavoriteSurvey Load (0.2ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 139[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 139 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 139[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 81ms (ActiveRecord: 21.0ms | Allocations: 41696)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:35:52.278700', '2023-08-22 08:35:52.278700')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 140 LIMIT 1[0m
  [1m[36mUser Update (1.9ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:35:52.281167' WHERE `users`.`id` = 140[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 140 LIMIT 1[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/140" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"140"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 140 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 266)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:35:52.303323', '2023-08-22 08:35:52.303323')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 141 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:35:52.307280' WHERE `users`.`id` = 141[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 141 LIMIT 1[0m
Started GET "/users/141" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"141"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 141 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 141[0m
  [1m[36mReview Load (0.8ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 141[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 141[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 141[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 141[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 141[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 141[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 141[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 141[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 141[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 141[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 141[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 141[0m
Completed 200 OK in 30ms (Views: 0.3ms | ActiveRecord: 10.3ms | Allocations: 12300)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:35:52.354814', '2023-08-22 08:35:52.354814')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/142" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"142"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 142 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 142[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 142[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 142[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 142[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 142[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 142[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 142[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 142[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 142[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 142[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 142[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 142[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 142[0m
Completed 200 OK in 16ms (Views: 0.2ms | ActiveRecord: 5.3ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:35:52.383248', '2023-08-22 08:35:52.383248')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo.143" for 127.0.0.1 at 2023-08-22 17:35:52 +0900
Processing by UsersController#save_user_memo as */*
  Parameters: {"memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms | Allocations: 892)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:40:33 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:40:33.723163', '2023-08-22 08:40:33.723163')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 144 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 144 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('nl4hxnm7am20ea1i4bmxlea0f1ja', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:40:34')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 144, 35, '2023-08-22 08:40:34')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:40:34.174987' WHERE `users`.`id` = 144[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: nl4hxnm7am20ea1i4bmxlea0f1ja (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1713c731-2253-4405-88d1-cbe9adea8a33) to Test(default) with arguments: #<GlobalID:0x00007ffb4a24c2d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/35>>
Completed 200 OK in 481ms (Views: 0.4ms | ActiveRecord: 11.1ms | Allocations: 210467)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.2ms | ActiveRecord: 0.6ms | Allocations: 3004)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:40:34.214054', '2023-08-22 08:40:34.214054')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/145" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"145"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 145 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 145 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 145 LIMIT 1[0m
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:40:34.230361' WHERE `users`.`id` = 145[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:40:34.240023', '2023-08-22 08:40:34.240023')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/146" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"146"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 146 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 146 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 146 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.5ms | ActiveRecord: 1.4ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:40:34.259381', '2023-08-22 08:40:34.259381')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/147" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"147"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 147 LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 147[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 147[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 147[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 147[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 147[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 147[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 147[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 147[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 147[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 147[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 147[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 147[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 147[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 147[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 147[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 147 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 147[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 91ms (ActiveRecord: 25.5ms | Allocations: 41696)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:40:34.367004', '2023-08-22 08:40:34.367004')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 148 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:40:34.370262' WHERE `users`.`id` = 148[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 148 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/148" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"148"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 148 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:40:34.389786', '2023-08-22 08:40:34.389786')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 149 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:40:34.393230' WHERE `users`.`id` = 149[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 149 LIMIT 1[0m
Started GET "/users/149" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"149"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 149 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 149[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 149[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 149[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 149[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 149[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 149[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 149[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 149[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 149[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 149[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 149[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 149[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 149[0m
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 12.1ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:40:34.443389', '2023-08-22 08:40:34.443389')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/150" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"150"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 150 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 150[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 150[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 150[0m
  [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 150[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 150[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 150[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 150[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 150[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 150[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 150[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 150[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 150[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 150[0m
Completed 200 OK in 17ms (Views: 0.3ms | ActiveRecord: 5.8ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:40:34.475592', '2023-08-22 08:40:34.475592')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:40:34 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"check_current_user_id"=>"#<User:0x00007ffb537bbb40>", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.5ms | Allocations: 890)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:40:45 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:40:45.433453', '2023-08-22 08:40:45.433453')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 152 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 152 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9a8luaz9l2qc0jy80wspcvodo4di', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:40:45')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 152, 36, '2023-08-22 08:40:45')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:40:45.805654' WHERE `users`.`id` = 152[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: 9a8luaz9l2qc0jy80wspcvodo4di (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c63c19b0-8332-45df-a2b4-66da0dd61d6b) to Test(default) with arguments: #<GlobalID:0x00007fcf35183ce0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/36>>
Completed 200 OK in 396ms (Views: 0.4ms | ActiveRecord: 8.1ms | Allocations: 210482)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:40:45 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 20ms (Views: 17.4ms | ActiveRecord: 0.7ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:40:45.854517', '2023-08-22 08:40:45.854517')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/153" for 127.0.0.1 at 2023-08-22 17:40:45 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"153"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 153 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 153 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 153 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:40:45.870991' WHERE `users`.`id` = 153[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:40:45.879542', '2023-08-22 08:40:45.879542')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/154" for 127.0.0.1 at 2023-08-22 17:40:45 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"154"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 154 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 154 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 154 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.6ms | ActiveRecord: 2.0ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:40:45.900020', '2023-08-22 08:40:45.900020')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/155" for 127.0.0.1 at 2023-08-22 17:40:45 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"155"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 155 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.9ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 155[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 155[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 155[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 155[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 155[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 155[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 155[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 155[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 155[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 155[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 155[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 155[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 155[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 155[0m
  [1m[36mFavoriteSurvey Load (0.5ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 155[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 155 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 155[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 96ms (ActiveRecord: 24.9ms | Allocations: 41696)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:40:46.013840', '2023-08-22 08:40:46.013840')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 156 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:40:46.016526' WHERE `users`.`id` = 156[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 156 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/156" for 127.0.0.1 at 2023-08-22 17:40:46 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"156"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 156 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:40:46.035387', '2023-08-22 08:40:46.035387')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 157 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:40:46.038489' WHERE `users`.`id` = 157[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 157 LIMIT 1[0m
Started GET "/users/157" for 127.0.0.1 at 2023-08-22 17:40:46 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"157"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 157 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 157[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 157[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 157[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 157[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 157[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 157[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 157[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 157[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 157[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 157[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 157[0m
  [1m[36mSurvey Load (0.8ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 157[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 157[0m
Completed 200 OK in 39ms (Views: 0.4ms | ActiveRecord: 13.6ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:40:46.093461', '2023-08-22 08:40:46.093461')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/158" for 127.0.0.1 at 2023-08-22 17:40:46 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"158"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 158 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 158[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 158[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 158[0m
  [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 158[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 158[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 158[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 158[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 158[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 158[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 158[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 158[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 158[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 158[0m
Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 6.0ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:40:46.125011', '2023-08-22 08:40:46.125011')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:40:46 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"#<User:0x00007fcf35976588>", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = NULL LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.5ms | Allocations: 816)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:40:58 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:40:58.240188', '2023-08-22 08:40:58.240188')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 160 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 160 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('myt5hcn48i8ct5jp2t50v7fwdvfm', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:40:58')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 160, 37, '2023-08-22 08:40:58')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:40:58.778934' WHERE `users`.`id` = 160[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: myt5hcn48i8ct5jp2t50v7fwdvfm (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1538e0df-0a7e-472e-9439-ac77664f05d3) to Test(default) with arguments: #<GlobalID:0x00007fb79c440678 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/37>>
Completed 200 OK in 564ms (Views: 0.4ms | ActiveRecord: 9.2ms | Allocations: 210503)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:40:58 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.6ms | ActiveRecord: 0.9ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:40:58.817079', '2023-08-22 08:40:58.817079')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/161" for 127.0.0.1 at 2023-08-22 17:40:58 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"161"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 161 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 161 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 161 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:40:58.836527' WHERE `users`.`id` = 161[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:40:58.844823', '2023-08-22 08:40:58.844823')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/162" for 127.0.0.1 at 2023-08-22 17:40:58 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"162"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 162 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 162 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 162 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 1.1ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:40:58.866273', '2023-08-22 08:40:58.866273')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/163" for 127.0.0.1 at 2023-08-22 17:40:58 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"163"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 163 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 163[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 163[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 163[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 163[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 163[0m
  [1m[36mFavoriteBook Load (0.6ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 163[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 163[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 163[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 163[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 163[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 163[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 163[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 163[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 163[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 163[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 163 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 163[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 102ms (ActiveRecord: 28.0ms | Allocations: 41695)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:40:58.984348', '2023-08-22 08:40:58.984348')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 164 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:40:58.987474' WHERE `users`.`id` = 164[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 164 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/164" for 127.0.0.1 at 2023-08-22 17:40:58 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"164"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 164 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:40:59.009105', '2023-08-22 08:40:59.009105')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 165 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:40:59.013135' WHERE `users`.`id` = 165[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 165 LIMIT 1[0m
Started GET "/users/165" for 127.0.0.1 at 2023-08-22 17:40:59 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"165"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 165 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 165[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 165[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 165[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 165[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 165[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 165[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 165[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 165[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 165[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 165[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 165[0m
  [1m[36mSurvey Load (0.8ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 165[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 165[0m
Completed 200 OK in 40ms (Views: 0.3ms | ActiveRecord: 13.7ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:40:59.071211', '2023-08-22 08:40:59.071211')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/166" for 127.0.0.1 at 2023-08-22 17:40:59 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"166"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 166 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 166[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 166[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 166[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 166[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 166[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 166[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 166[0m
  [1m[36mSubjectQuestion Load (0.7ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 166[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 166[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 166[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 166[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 166[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 166[0m
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 6.9ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:40:59.108894', '2023-08-22 08:40:59.108894')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:40:59 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"167", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 167 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 167 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 167 LIMIT 1[0m
  [1m[36mUser Update (1.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:40:59.123788', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 167[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.9ms | Allocations: 1997)
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:41:40.335169', '2023-08-22 08:41:40.335169')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 168 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 168 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('p5bkpxw9etms3v557749tpg35kpn', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:41:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 168, 38, '2023-08-22 08:41:40')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:41:40.734209' WHERE `users`.`id` = 168[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.0ms) [0m[32mUploaded file to key: p5bkpxw9etms3v557749tpg35kpn (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0870d2e7-7550-44ba-a080-7200efe8b336) to Test(default) with arguments: #<GlobalID:0x00007fb6567d5398 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/38>>
Completed 200 OK in 428ms (Views: 0.4ms | ActiveRecord: 9.2ms | Allocations: 210489)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.9ms | ActiveRecord: 0.6ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:41:40.772042', '2023-08-22 08:41:40.772042')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/169" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"169"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 169 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 169 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 169 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:41:40.787354' WHERE `users`.`id` = 169[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:41:40.796614', '2023-08-22 08:41:40.796614')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/170" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"170"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 170 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 170 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 170 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:41:40.817568', '2023-08-22 08:41:40.817568')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/171" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"171"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 171 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 171[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 171[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 171[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 171[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 171[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 171[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 171[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 171[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 171[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 171[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 171[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 171[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 171[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 171[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 171[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 171 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.8ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 171[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 101ms (ActiveRecord: 27.7ms | Allocations: 41694)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:41:40.934638', '2023-08-22 08:41:40.934638')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 172 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:41:40.937991' WHERE `users`.`id` = 172[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 172 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/172" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"172"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 172 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 266)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:41:40.959303', '2023-08-22 08:41:40.959303')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 173 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:41:40.962402' WHERE `users`.`id` = 173[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 173 LIMIT 1[0m
Started GET "/users/173" for 127.0.0.1 at 2023-08-22 17:41:40 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"173"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 173 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 173[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 173[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 173[0m
  [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 173[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 173[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 173[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 173[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 173[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 173[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 173[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 173[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 173[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 173[0m
Completed 200 OK in 38ms (Views: 0.3ms | ActiveRecord: 13.0ms | Allocations: 12297)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:41:41.016864', '2023-08-22 08:41:41.016864')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/174" for 127.0.0.1 at 2023-08-22 17:41:41 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"174"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 174 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 174[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 174[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 174[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 174[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 174[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 174[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 174[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 174[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 174[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 174[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 174[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 174[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 174[0m
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 5.0ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:41:41.048257', '2023-08-22 08:41:41.048257')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:41:51.236098', '2023-08-22 08:41:51.236098')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 176 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 176 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('fv15fg84jebbxtkx63s9samws98l', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:41:51')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 176, 39, '2023-08-22 08:41:51')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:41:51.555730' WHERE `users`.`id` = 176[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.2ms) [0m[32mUploaded file to key: fv15fg84jebbxtkx63s9samws98l (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b035cc8e-f38c-4279-967c-e0aa3a1ae69e) to Test(default) with arguments: #<GlobalID:0x00007fa12189c320 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/39>>
Completed 200 OK in 349ms (Views: 0.7ms | ActiveRecord: 9.6ms | Allocations: 210477)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.2ms | ActiveRecord: 0.7ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:41:51.608036', '2023-08-22 08:41:51.608036')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/177" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"177"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 177 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 177 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 177 LIMIT 1[0m
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:41:51.623728' WHERE `users`.`id` = 177[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:41:51.632538', '2023-08-22 08:41:51.632538')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/178" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"178"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 178 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 178 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 178 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.8ms | ActiveRecord: 2.1ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:41:51.654858', '2023-08-22 08:41:51.654858')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/179" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"179"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 179 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 179[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 179[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 179[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 179[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 179[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 179[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 179[0m
  [1m[36mFavoriteQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 179[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 179[0m
  [1m[36mFavoriteSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 179[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 179[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 179[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 179[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 179[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 179[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 179 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 179[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 94ms (ActiveRecord: 26.5ms | Allocations: 41696)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:41:51.768652', '2023-08-22 08:41:51.768652')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 180 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:41:51.772844' WHERE `users`.`id` = 180[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 180 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/180" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"180"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 180 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 266)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:41:51.792493', '2023-08-22 08:41:51.792493')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 181 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:41:51.797024' WHERE `users`.`id` = 181[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 181 LIMIT 1[0m
Started GET "/users/181" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"181"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 181 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 181[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 181[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 181[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 181[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 181[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 181[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 181[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 181[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 181[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 181[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 181[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 181[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 181[0m
Completed 200 OK in 37ms (Views: 0.2ms | ActiveRecord: 13.1ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:41:51.850030', '2023-08-22 08:41:51.850030')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/182" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"182"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 182 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 182[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 182[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 182[0m
  [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 182[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 182[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 182[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 182[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 182[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 182[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 182[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 182[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 182[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 182[0m
Completed 200 OK in 23ms (Views: 0.3ms | ActiveRecord: 6.6ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:41:51.888927', '2023-08-22 08:41:51.888927')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:41:51 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"183", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 183 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 183 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 183 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:41:51.906536', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 183[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 2.2ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:48:24 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:48:24.830887', '2023-08-22 08:48:24.830887')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 184 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 184 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('y5amwuyepc8df85ly20gjoew9rue', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:48:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 184, 40, '2023-08-22 08:48:25')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:48:25.220112' WHERE `users`.`id` = 184[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: y5amwuyepc8df85ly20gjoew9rue (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7d46ac71-3917-48a3-8905-e1bb7bf06259) to Test(default) with arguments: #<GlobalID:0x00007fc24a01b3f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/40>>
Completed 200 OK in 415ms (Views: 0.5ms | ActiveRecord: 9.3ms | Allocations: 210498)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.6ms | ActiveRecord: 1.1ms | Allocations: 3003)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:48:25.274665', '2023-08-22 08:48:25.274665')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/185" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"185"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 185 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 185 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 185 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:48:25.291982' WHERE `users`.`id` = 185[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 2.2ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:48:25.300989', '2023-08-22 08:48:25.300989')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/186" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"186"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 186 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 186 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 186 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.7ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:48:25.323271', '2023-08-22 08:48:25.323271')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/187" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"187"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 187 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 187[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 187[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 187[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 187[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 187[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 187[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 187[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 187[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 187[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 187[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 187[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 187[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 187[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 187[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 187[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 187 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 187[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 94ms (ActiveRecord: 24.2ms | Allocations: 41696)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:48:25.434453', '2023-08-22 08:48:25.434453')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 188 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:48:25.436925' WHERE `users`.`id` = 188[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 188 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/188" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"188"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 188 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:48:25.459112', '2023-08-22 08:48:25.459112')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 189 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:48:25.462459' WHERE `users`.`id` = 189[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 189 LIMIT 1[0m
Started GET "/users/189" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"189"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 189 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 189[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 189[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 189[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 189[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 189[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 189[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 189[0m
  [1m[36mSubjectQuestion Load (0.6ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 189[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 189[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 189[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 189[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 189[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 189[0m
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 10.9ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:48:25.510399', '2023-08-22 08:48:25.510399')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/190" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"190"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 190 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 190[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 190[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 190[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 190[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 190[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 190[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 190[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 190[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 190[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 190[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 190[0m
  [1m[36mSurvey Load (0.2ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 190[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 190[0m
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 4.5ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:48:25.538138', '2023-08-22 08:48:25.538138')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"191", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 191 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 191 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 191 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:48:25.552606', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 191[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:48:25 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.3ms | Allocations: 957)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:53:56.086990', '2023-08-22 08:53:56.086990')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 192 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 192 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ezd4ajksy1bw9emkx28tzr6kzbwv', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:53:56')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 192, 41, '2023-08-22 08:53:56')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:53:56.564885' WHERE `users`.`id` = 192[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.5ms) [0m[32mUploaded file to key: ezd4ajksy1bw9emkx28tzr6kzbwv (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4def568e-640a-4aba-87aa-4a1272e26b37) to Test(default) with arguments: #<GlobalID:0x00007fedce420e28 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/41>>
Completed 200 OK in 508ms (Views: 0.8ms | ActiveRecord: 8.5ms | Allocations: 210499)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.7ms | ActiveRecord: 0.9ms | Allocations: 3004)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:53:56.602436', '2023-08-22 08:53:56.602436')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/193" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"193"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 193 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 193 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 193 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:53:56.618795' WHERE `users`.`id` = 193[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.5ms | ActiveRecord: 1.8ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:53:56.626888', '2023-08-22 08:53:56.626888')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/194" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"194"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 194 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 194 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 194 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:53:56.646482', '2023-08-22 08:53:56.646482')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/195" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"195"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 195 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 195[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 195[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 195[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 195[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 195[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 195[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 195[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 195[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 195[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 195[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 195[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 195[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 195[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 195[0m
  [1m[36mFavoriteSurvey Load (0.6ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 195[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 195 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 195[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 99ms (ActiveRecord: 25.6ms | Allocations: 41696)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:53:56.763977', '2023-08-22 08:53:56.763977')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 196 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:53:56.768108' WHERE `users`.`id` = 196[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 196 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/196" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"196"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 196 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:53:56.788845', '2023-08-22 08:53:56.788845')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 197 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:53:56.792479' WHERE `users`.`id` = 197[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 197 LIMIT 1[0m
Started GET "/users/197" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"197"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 197 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 197[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 197[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 197[0m
  [1m[36mQuestion Load (0.7ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 197[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 197[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 197[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 197[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 197[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 197[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 197[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 197[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 197[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 197[0m
Completed 200 OK in 36ms (Views: 0.4ms | ActiveRecord: 12.5ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:53:56.845419', '2023-08-22 08:53:56.845419')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/198" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"198"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 198 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 198[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 198[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 198[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 198[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 198[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 198[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 198[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 198[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 198[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 198[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 198[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 198[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 198[0m
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 5.0ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:53:56.875941', '2023-08-22 08:53:56.875941')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"199", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 199 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 199 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 199 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:53:56.890527', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 199[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:53:56 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:54:48 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:54:48.975014', '2023-08-22 08:54:48.975014')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 200 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 200 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cainfwgubc5yr9pvizi889hqxxzb', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:54:49')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 200, 42, '2023-08-22 08:54:49')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:54:49.345708' WHERE `users`.`id` = 200[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: cainfwgubc5yr9pvizi889hqxxzb (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b814c11f-ff9e-47a8-9320-ce76d416e6dc) to Test(default) with arguments: #<GlobalID:0x00007f917ae2c828 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/42>>
Completed 200 OK in 396ms (Views: 0.4ms | ActiveRecord: 8.8ms | Allocations: 210446)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.8ms | ActiveRecord: 0.7ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:54:49.393611', '2023-08-22 08:54:49.393611')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/201" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"201"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 201 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 201 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 201 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:54:49.408155' WHERE `users`.`id` = 201[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.3ms | Allocations: 2440)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:54:49.416150', '2023-08-22 08:54:49.416150')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/202" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"202"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 202 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 202 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 202 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 5ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:54:49.434496', '2023-08-22 08:54:49.434496')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/203" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"203"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 203 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 203[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 203[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 203[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 203[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 203[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 203[0m
  [1m[36mFavoriteReview Load (0.2ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 203[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 203[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 203[0m
  [1m[36mFavoriteSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 203[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 203[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 203[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 203[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 203[0m
  [1m[36mFavoriteSurvey Load (0.2ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 203[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 203 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 203[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 84ms (ActiveRecord: 21.3ms | Allocations: 41696)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:54:49.533840', '2023-08-22 08:54:49.533840')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 204 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:54:49.536307' WHERE `users`.`id` = 204[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 204 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/204" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"204"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 204 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:54:49.553987', '2023-08-22 08:54:49.553987')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 205 LIMIT 1[0m
  [1m[36mUser Update (1.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:54:49.556778' WHERE `users`.`id` = 205[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 205 LIMIT 1[0m
Started GET "/users/205" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"205"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 205 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 205[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 205[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 205[0m
  [1m[36mQuestion Load (0.8ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 205[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 205[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 205[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 205[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 205[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 205[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 205[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 205[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 205[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 205[0m
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 11.3ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:54:49.607590', '2023-08-22 08:54:49.607590')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/206" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"206"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 206 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.9ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 206[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 206[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 206[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 206[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 206[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 206[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 206[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 206[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 206[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 206[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 206[0m
  [1m[36mSurvey Load (0.2ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 206[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 206[0m
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 4.2ms | Allocations: 4866)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:54:49.634217', '2023-08-22 08:54:49.634217')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"207", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 207 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 207 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 207 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:54:49.647432', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 207[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.9ms | Allocations: 1997)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:54:49 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:58:35 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:58:35.525855', '2023-08-22 08:58:35.525855')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 208 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 208 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('g9apahxcu9l4bhx45ul8exicetvc', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:58:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 208, 43, '2023-08-22 08:58:36')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:58:36.410876' WHERE `users`.`id` = 208[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: g9apahxcu9l4bhx45ul8exicetvc (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b8dedea8-2e51-4548-a2c9-0619afd832e4) to Test(default) with arguments: #<GlobalID:0x00007ff9cc6b6d18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/43>>
Completed 200 OK in 911ms (Views: 0.4ms | ActiveRecord: 8.6ms | Allocations: 210500)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 4.0ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:58:36.465369', '2023-08-22 08:58:36.465369')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/209" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"209"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 209 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 209 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 209 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:58:36.482335' WHERE `users`.`id` = 209[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:58:36.491022', '2023-08-22 08:58:36.491022')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/210" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"210"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 210 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 210 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 210 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.8ms | ActiveRecord: 1.3ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:58:36.511155', '2023-08-22 08:58:36.511155')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/211" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"211"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 211 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 211[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 211[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 211[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 211[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 211[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 211[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 211[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 211[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 211[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 211[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 211[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 211[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 211[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 211[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 211[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 211 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 211[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 93ms (ActiveRecord: 23.3ms | Allocations: 41696)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:58:36.620244', '2023-08-22 08:58:36.620244')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 212 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:58:36.623284' WHERE `users`.`id` = 212[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 212 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/212" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"212"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 212 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:58:36.642933', '2023-08-22 08:58:36.642933')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 213 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:58:36.646995' WHERE `users`.`id` = 213[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 213 LIMIT 1[0m
Started GET "/users/213" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"213"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 213 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 213[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 213[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 213[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 213[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 213[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 213[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 213[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 213[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 213[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 213[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 213[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 213[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 213[0m
Completed 200 OK in 36ms (Views: 0.3ms | ActiveRecord: 13.2ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:58:36.699794', '2023-08-22 08:58:36.699794')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:58:36.708044', '2023-08-22 08:58:36.708044')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"215", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 215 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 215 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 215 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:58:36.723202', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 215[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 2000)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:58:36 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 08:59:37.156628', '2023-08-22 08:59:37.156628')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 216 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 216 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('lugw7vlr2zkfjvrimfennnglrpy7', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 08:59:37')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 216, 44, '2023-08-22 08:59:37')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:59:37.574114' WHERE `users`.`id` = 216[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: lugw7vlr2zkfjvrimfennnglrpy7 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: cef9bbbf-4d08-48e9-94df-f032d2f6f6af) to Test(default) with arguments: #<GlobalID:0x00007fd4920c7d80 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/44>>
Completed 200 OK in 444ms (Views: 0.4ms | ActiveRecord: 8.5ms | Allocations: 210495)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 19ms (Views: 16.1ms | ActiveRecord: 0.7ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 08:59:37.622560', '2023-08-22 08:59:37.622560')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/217" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"217"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 217 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 217 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 217 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 08:59:37.637972' WHERE `users`.`id` = 217[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 08:59:37.646192', '2023-08-22 08:59:37.646192')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/218" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"218"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 218 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 218 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 218 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.9ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 08:59:37.667550', '2023-08-22 08:59:37.667550')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/219" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"219"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 219 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 219[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 219[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 219[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 219[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 219[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 219[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 219[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 219[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 219[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 219[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 219[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 219[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 219[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 219[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 219[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 219 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (1.6ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 219[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 97ms (ActiveRecord: 26.0ms | Allocations: 41696)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 08:59:37.782884', '2023-08-22 08:59:37.782884')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 220 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 08:59:37.785743' WHERE `users`.`id` = 220[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 220 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/220" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"220"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 220 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 08:59:37.806765', '2023-08-22 08:59:37.806765')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 221 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 08:59:37.811007' WHERE `users`.`id` = 221[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 221 LIMIT 1[0m
Started GET "/users/221" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"221"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 221 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 221[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 221[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 221[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 221[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 221[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 221[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 221[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 221[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 221[0m
  [1m[36mSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 221[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 221[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 221[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 221[0m
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 12.6ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 08:59:37.864836', '2023-08-22 08:59:37.864836')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/222" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"222"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 222 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 222 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 222[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 222[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 222[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 222[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 222[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 222[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 222[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 222[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 222[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 222[0m
  [1m[36mSurvey Load (0.2ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 222[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 222[0m
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 5.2ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.4ms | Allocations: 835)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 08:59:37.908492', '2023-08-22 08:59:37.908492')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"223", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 223 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 223 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 223 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 08:59:37.924250', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 223[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 17:59:37 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 396)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 18:04:20 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 09:04:20.353390', '2023-08-22 09:04:20.353390')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 224 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 224 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9rhj8r7y5i5lqzcfibufbbzsrt3j', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 09:04:20')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 224, 45, '2023-08-22 09:04:20')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 09:04:20.849704' WHERE `users`.`id` = 224[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.0ms) [0m[32mUploaded file to key: 9rhj8r7y5i5lqzcfibufbbzsrt3j (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e9208aa6-dd5c-4736-9dc1-2b1e7492fbca) to Test(default) with arguments: #<GlobalID:0x00007fbae53cbb60 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/45>>
Completed 200 OK in 526ms (Views: 0.4ms | ActiveRecord: 9.7ms | Allocations: 210454)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 18:04:20 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.5ms | ActiveRecord: 0.8ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 09:04:20.886816', '2023-08-22 09:04:20.886816')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/225" for 127.0.0.1 at 2023-08-22 18:04:20 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"225"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 225 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 225 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 225 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 09:04:20.900310' WHERE `users`.`id` = 225[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 09:04:20.908636', '2023-08-22 09:04:20.908636')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/226" for 127.0.0.1 at 2023-08-22 18:04:20 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"226"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 226 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 226 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 226 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.7ms | ActiveRecord: 1.9ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 09:04:20.928412', '2023-08-22 09:04:20.928412')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/227" for 127.0.0.1 at 2023-08-22 18:04:20 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"227"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 227 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 227[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 227[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 227[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 227[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 227[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 227[0m
  [1m[36mFavoriteReview Load (0.2ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 227[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 227[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 227[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 227[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 227[0m
  [1m[36mBrowsingHistory Load (0.2ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 227[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 227[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 227[0m
  [1m[36mFavoriteSurvey Load (0.2ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 227[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 227 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 227[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 80ms (ActiveRecord: 20.8ms | Allocations: 41694)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 09:04:21.024122', '2023-08-22 09:04:21.024122')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 228 LIMIT 1[0m
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 09:04:21.026473' WHERE `users`.`id` = 228[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 228 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/228" for 127.0.0.1 at 2023-08-22 18:04:21 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"228"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 228 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 09:04:21.045571', '2023-08-22 09:04:21.045571')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 229 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 09:04:21.049146' WHERE `users`.`id` = 229[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 229 LIMIT 1[0m
Started GET "/users/229" for 127.0.0.1 at 2023-08-22 18:04:21 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"229"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 229 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 229[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 229[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 229[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 229[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 229[0m
  [1m[36mReply Load (0.7ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 229[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 229[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 229[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 229[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 229[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 229[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 229[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 229[0m
Completed 200 OK in 31ms (Views: 0.2ms | ActiveRecord: 10.2ms | Allocations: 12297)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 09:04:21.095007', '2023-08-22 09:04:21.095007')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/230" for 127.0.0.1 at 2023-08-22 18:04:21 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"230"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 230 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 230 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 230[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 230[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 230[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 230[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 230[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 230[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 230[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 230[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 230[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 230[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 230[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 230[0m
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 5.2ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 18:04:21 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 178)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 09:04:21.132380', '2023-08-22 09:04:21.132380')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 18:04:21 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"231", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 231 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 231 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 231 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 09:04:21.147335', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 231[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.9ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 18:04:21 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 14ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 397)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:32:12 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:32:12.597611', '2023-08-22 10:32:12.597611')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 232 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 232 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ffk54pwa28q47npq9cdzx5orcjd2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:32:13')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 232, 46, '2023-08-22 10:32:13')[0m
  [1m[36mUser Update (1.2ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:32:13.081015' WHERE `users`.`id` = 232[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.0ms) [0m[32mUploaded file to key: ffk54pwa28q47npq9cdzx5orcjd2 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 41e2a127-920d-4dd6-9464-c9cef69170bc) to Test(default) with arguments: #<GlobalID:0x00007fda20863038 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/46>>
Completed 200 OK in 523ms (Views: 0.5ms | ActiveRecord: 10.7ms | Allocations: 210442)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 7.7ms | ActiveRecord: 0.6ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:32:13.136767', '2023-08-22 10:32:13.136767')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/233" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"233"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 233 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 233 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 233 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:32:13.152068' WHERE `users`.`id` = 233[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 1.5ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:32:13.160948', '2023-08-22 10:32:13.160948')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/234" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"234"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 234 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 234 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 234 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.8ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:32:13.184025', '2023-08-22 10:32:13.184025')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/235" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"235"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 235 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 235[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 235[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 235[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 235[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 235[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 235[0m
  [1m[36mFavoriteReview Load (0.2ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 235[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 235[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 235[0m
  [1m[36mFavoriteSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 235[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 235[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 235[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 235[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 235[0m
  [1m[36mFavoriteSurvey Load (0.2ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 235[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 235 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.6ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 235[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 98ms (ActiveRecord: 21.7ms | Allocations: 41696)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:32:13.300108', '2023-08-22 10:32:13.300108')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 236 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:32:13.302784' WHERE `users`.`id` = 236[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 236 LIMIT 1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/236" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"236"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 236 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:32:13.320354', '2023-08-22 10:32:13.320354')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 237 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:32:13.325656' WHERE `users`.`id` = 237[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 237 LIMIT 1[0m
Started GET "/users/237" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"237"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 237 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 237[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 237[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 237[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 237[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 237[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 237[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 237[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 237[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 237[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 237[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 237[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 237[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 237[0m
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 10.0ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:32:13.376000', '2023-08-22 10:32:13.376000')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/238" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"238"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 238 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 238 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 238[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 238[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 238[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 238[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 238[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 238[0m
  [1m[36mSubjectQuestion Load (0.7ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 238[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 238[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 238[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 238[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 238[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 238[0m
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 5.1ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms | Allocations: 178)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:32:13.415264', '2023-08-22 10:32:13.415264')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"239", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 239 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 239 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 239 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:32:13.428252', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 239[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:32:13 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 2ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 396)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:35:52 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:35:52.474549', '2023-08-22 10:35:52.474549')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 240 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 240 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2gayqo8zgscwzakg66gws42tgbpf', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:35:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 240, 47, '2023-08-22 10:35:52')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:35:52.961334' WHERE `users`.`id` = 240[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: 2gayqo8zgscwzakg66gws42tgbpf (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0f02205c-2599-4e8f-ac81-da1e9292b1a1) to Test(default) with arguments: #<GlobalID:0x00007fcc417984b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/47>>
Completed 200 OK in 514ms (Views: 0.4ms | ActiveRecord: 8.2ms | Allocations: 210501)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:35:52 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.3ms | ActiveRecord: 0.7ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:35:53.000002', '2023-08-22 10:35:53.000002')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/241" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"241"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 241 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 241 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 241 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:35:53.015981' WHERE `users`.`id` = 241[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 2.2ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:35:53.023514', '2023-08-22 10:35:53.023514')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/242" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"242"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 242 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 242 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 242 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.6ms | ActiveRecord: 1.9ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:35:53.043072', '2023-08-22 10:35:53.043072')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/243" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"243"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 243 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 243[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 243[0m
  [1m[36mSubjectQuestion Load (0.8ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 243[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 243[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 243[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 243[0m
  [1m[36mFavoriteReview Load (0.5ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 243[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 243[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 243[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 243[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 243[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 243[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 243[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 243[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 243[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 243 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 243[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 153ms (ActiveRecord: 24.5ms | Allocations: 41694)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:35:53.212480', '2023-08-22 10:35:53.212480')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 244 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:35:53.216755' WHERE `users`.`id` = 244[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 244 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/244" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"244"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 244 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 266)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:35:53.236328', '2023-08-22 10:35:53.236328')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 245 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:35:53.240660' WHERE `users`.`id` = 245[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 245 LIMIT 1[0m
Started GET "/users/245" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"245"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 245 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 245[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 245[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 245[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 245[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 245[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 245[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 245[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 245[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 245[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 245[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 245[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 245[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 245[0m
Completed 200 OK in 51ms (Views: 0.3ms | ActiveRecord: 12.8ms | Allocations: 12302)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:35:53.308100', '2023-08-22 10:35:53.308100')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/246" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"246"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 246 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 246 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 246[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 246[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 246[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 246[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 246[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 246[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 246[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 246[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 246[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 246[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 246[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 246[0m
Completed 200 OK in 18ms (Views: 0.4ms | ActiveRecord: 5.1ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 2ms (ActiveRecord: 0.6ms | Allocations: 178)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:35:53.353854', '2023-08-22 10:35:53.353854')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"247", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 247 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 247 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 247 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:35:53.368706', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 247[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 396)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:35:53.389319', '2023-08-22 10:35:53.389319')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=248" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"248"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 248 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.6ms | Allocations: 211)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:35:53 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 1.0ms | Allocations: 210)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:39:43 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:39:43.613826', '2023-08-22 10:39:43.613826')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 249 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 249 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('zdofk5gh3f7kchuytekh7lardeyy', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:39:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 249, 48, '2023-08-22 10:39:44')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:39:44.152286' WHERE `users`.`id` = 249[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.0ms) [0m[32mUploaded file to key: zdofk5gh3f7kchuytekh7lardeyy (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fed9bfbe-8cf2-407c-b0fd-39b392072a68) to Test(default) with arguments: #<GlobalID:0x00007f8d15c44f88 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/48>>
Completed 200 OK in 571ms (Views: 0.4ms | ActiveRecord: 10.2ms | Allocations: 210505)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.3ms | ActiveRecord: 0.5ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:39:44.203861', '2023-08-22 10:39:44.203861')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/250" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"250"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 250 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 250 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 250 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:39:44.219897' WHERE `users`.`id` = 250[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 2441)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:39:44.227615', '2023-08-22 10:39:44.227615')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/251" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"251"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 251 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 251 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 251 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.8ms | ActiveRecord: 2.2ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:39:44.249561', '2023-08-22 10:39:44.249561')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/252" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"252"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 252 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 252[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 252[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 252[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 252[0m
  [1m[36mSubjectQuestionReply Load (0.6ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 252[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 252[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 252[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 252[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 252[0m
  [1m[36mFavoriteSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 252[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 252[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 252[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 252[0m
  [1m[36mNotification Load (0.5ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 252[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 252[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 252 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.6ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 252[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 97ms (ActiveRecord: 24.4ms | Allocations: 41696)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:39:44.363169', '2023-08-22 10:39:44.363169')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 253 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:39:44.366447' WHERE `users`.`id` = 253[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 253 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/253" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"253"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 253 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:39:44.384805', '2023-08-22 10:39:44.384805')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 254 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:39:44.387151' WHERE `users`.`id` = 254[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 254 LIMIT 1[0m
Started GET "/users/254" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"254"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 254 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 254[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 254[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 254[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 254[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 254[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 254[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 254[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 254[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 254[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 254[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 254[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 254[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 254[0m
Completed 200 OK in 36ms (Views: 0.3ms | ActiveRecord: 11.7ms | Allocations: 12299)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:39:44.440841', '2023-08-22 10:39:44.440841')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/255" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"255"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 255 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 255 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 255[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 255[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 255[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 255[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 255[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 255[0m
  [1m[36mSubjectQuestion Load (0.7ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 255[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 255[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 255[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 255[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 255[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 255[0m
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 5.5ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms | Allocations: 178)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:39:44.485271', '2023-08-22 10:39:44.485271')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"256", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 256 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 256 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 256 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:39:44.500165', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 256[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 2.2ms | Allocations: 1997)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 396)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:39:44.520088', '2023-08-22 10:39:44.520088')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=257" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"257"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 257 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 211)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:39:44 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.6ms | Allocations: 210)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:44:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:44:28.479490', '2023-08-22 10:44:28.479490')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 258 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 258 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mj90irpkf9njcxpfuw5g78fshxtm', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 258, 49, '2023-08-22 10:44:28')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:44:28.908959' WHERE `users`.`id` = 258[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.8ms) [0m[32mUploaded file to key: mj90irpkf9njcxpfuw5g78fshxtm (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 61ccc45e-e826-4aee-8385-3a021184f124) to Test(default) with arguments: #<GlobalID:0x00007fa14ad9be60 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/49>>
Completed 200 OK in 456ms (Views: 0.4ms | ActiveRecord: 9.6ms | Allocations: 210482)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:44:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 3.6ms | ActiveRecord: 1.0ms | Allocations: 3003)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:44:28.949172', '2023-08-22 10:44:28.949172')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/259" for 127.0.0.1 at 2023-08-22 19:44:28 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"259"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 259 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 259 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 259 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:44:28.966490' WHERE `users`.`id` = 259[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:44:28.975558', '2023-08-22 10:44:28.975558')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/260" for 127.0.0.1 at 2023-08-22 19:44:28 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"260"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 260 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 260 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 260 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:44:28.997111', '2023-08-22 10:44:28.997111')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/261" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"261"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 261 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 261[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 261[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 261[0m
  [1m[36mReply Load (0.7ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 261[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 261[0m
  [1m[36mFavoriteBook Load (0.6ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 261[0m
  [1m[36mFavoriteReview Load (0.6ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 261[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 261[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 261[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 261[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 261[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 261[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 261[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 261[0m
  [1m[36mFavoriteSurvey Load (0.5ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 261[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 261 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 261[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 169ms (ActiveRecord: 29.6ms | Allocations: 41696)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:44:29.204371', '2023-08-22 10:44:29.204371')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 262 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:44:29.207562' WHERE `users`.`id` = 262[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 262 LIMIT 1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/262" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"262"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 262 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:44:29.331117', '2023-08-22 10:44:29.331117')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 263 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:44:29.335085' WHERE `users`.`id` = 263[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 263 LIMIT 1[0m
Started GET "/users/263" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"263"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 263 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 263[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 263[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 263[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 263[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 263[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 263[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 263[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 263[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 263[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 263[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 263[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 263[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 263[0m
Completed 200 OK in 38ms (Views: 0.2ms | ActiveRecord: 13.7ms | Allocations: 12300)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:44:29.390588', '2023-08-22 10:44:29.390588')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/264" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"264"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 264 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 264 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 264[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 264[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 264[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 264[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 264[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 264[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 264[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 264[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 264[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 264[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 264[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 264[0m
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 6.0ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms | Allocations: 178)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:44:29.435961', '2023-08-22 10:44:29.435961')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"265", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 265 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 265 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 265 LIMIT 1[0m
  [1m[36mUser Update (0.8ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:44:29.450760', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 265[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 396)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:44:29.474337', '2023-08-22 10:44:29.474337')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=266" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"266"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 266 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.3ms | Allocations: 211)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:44:29 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 210)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 10:44:29.501241', '2023-08-22 10:44:29.501241')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' AND `users`.`id` != 267 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:44:29.504918' WHERE `users`.`id` = 267[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:45:27.074853', '2023-08-22 10:45:27.074853')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 268 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 268 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cpth9wszxnq0nyejabxz42b5eqiq', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:45:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 268, 50, '2023-08-22 10:45:27')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:45:27.578302' WHERE `users`.`id` = 268[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: cpth9wszxnq0nyejabxz42b5eqiq (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 107e3ec8-9205-4a6a-a584-5da767db8d33) to Test(default) with arguments: #<GlobalID:0x00007fd85f33cef0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/50>>
Completed 200 OK in 530ms (Views: 0.4ms | ActiveRecord: 8.4ms | Allocations: 210468)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.2ms | ActiveRecord: 0.5ms | Allocations: 3003)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:45:27.618327', '2023-08-22 10:45:27.618327')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/269" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"269"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 269 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 269 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 269 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:45:27.634760' WHERE `users`.`id` = 269[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:45:27.643754', '2023-08-22 10:45:27.643754')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/270" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"270"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 270 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 270 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 270 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.6ms | ActiveRecord: 1.7ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:45:27.665835', '2023-08-22 10:45:27.665835')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/271" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"271"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 271 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 271[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 271[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 271[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 271[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 271[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 271[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 271[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 271[0m
  [1m[36mFavoriteReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 271[0m
  [1m[36mFavoriteSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 271[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 271[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 271[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 271[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 271[0m
  [1m[36mFavoriteSurvey Load (0.5ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 271[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 271 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 271[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 102ms (ActiveRecord: 25.7ms | Allocations: 41695)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:45:27.787176', '2023-08-22 10:45:27.787176')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 272 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:45:27.790581' WHERE `users`.`id` = 272[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 272 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/272" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"272"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 272 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.1ms | ActiveRecord: 0.7ms | Allocations: 266)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:45:27.809987', '2023-08-22 10:45:27.809987')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 273 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:45:27.813467' WHERE `users`.`id` = 273[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 273 LIMIT 1[0m
Started GET "/users/273" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"273"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 273 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 273[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 273[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 273[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 273[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 273[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 273[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 273[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 273[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 273[0m
  [1m[36mSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 273[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 273[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 273[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 273[0m
Completed 200 OK in 33ms (Views: 0.2ms | ActiveRecord: 10.7ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:45:27.861478', '2023-08-22 10:45:27.861478')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/274" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"274"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 274 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 274 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 274[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 274[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 274[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 274[0m
  [1m[36mReply Load (0.2ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 274[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 274[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 274[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 274[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 274[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 274[0m
  [1m[36mSurvey Load (0.7ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 274[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 274[0m
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 4.7ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.4ms | Allocations: 178)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:45:27.903038', '2023-08-22 10:45:27.903038')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"275", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 275 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 275 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 275 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:45:27.916864', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 275[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:45:27.937480', '2023-08-22 10:45:27.937480')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=276" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"276"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 276 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 211)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:45:27 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 210)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 10:45:27.963477', '2023-08-22 10:45:27.963477')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' AND `users`.`id` != 277 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:45:27.966653' WHERE `users`.`id` = 277[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:45:44.163107', '2023-08-22 10:45:44.163107')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 278 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 278 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9oo4wqteh3bddbfvdutbp10rmarc', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:45:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 278, 51, '2023-08-22 10:45:44')[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:45:44.552338' WHERE `users`.`id` = 278[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 9oo4wqteh3bddbfvdutbp10rmarc (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7fe353d9-a347-4c55-ae9a-cf5352ff1f00) to Test(default) with arguments: #<GlobalID:0x00007ff44b278e08 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/51>>
Completed 200 OK in 414ms (Views: 0.4ms | ActiveRecord: 8.8ms | Allocations: 210465)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 4.5ms | ActiveRecord: 1.3ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:45:44.601755', '2023-08-22 10:45:44.601755')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/279" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"279"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 279 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 279 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 279 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:45:44.618292' WHERE `users`.`id` = 279[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:45:44.626598', '2023-08-22 10:45:44.626598')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/280" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"280"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 280 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 280 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 280 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 1.1ms | ActiveRecord: 1.6ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:45:44.647353', '2023-08-22 10:45:44.647353')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/281" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"281"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 281 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 281[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 281[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 281[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 281[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 281[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 281[0m
  [1m[36mFavoriteReview Load (0.4ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 281[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 281[0m
  [1m[36mFavoriteReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 281[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 281[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 281[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 281[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 281[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 281[0m
  [1m[36mFavoriteSurvey Load (0.4ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 281[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 281 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 281[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 93ms (ActiveRecord: 24.2ms | Allocations: 41696)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:45:44.758994', '2023-08-22 10:45:44.758994')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 282 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:45:44.762930' WHERE `users`.`id` = 282[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 282 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/282" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"282"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 282 LIMIT 1[0m
Completed 400 Bad Request in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:45:44.785971', '2023-08-22 10:45:44.785971')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 283 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:45:44.790769' WHERE `users`.`id` = 283[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 283 LIMIT 1[0m
Started GET "/users/283" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"283"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 283 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 283[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 283[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 283[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 283[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 283[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 283[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 283[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 283[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 283[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 283[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 283[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 283[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 283[0m
Completed 200 OK in 37ms (Views: 0.3ms | ActiveRecord: 12.6ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:45:44.845508', '2023-08-22 10:45:44.845508')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/284" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"284"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 284 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 284 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 284[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 284[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 284[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 284[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 284[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 284[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 284[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 284[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 284[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 284[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 284[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 284[0m
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 6.2ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.6ms | Allocations: 178)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:45:44.895984', '2023-08-22 10:45:44.895984')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"285", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 285 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 285 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 285 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:45:44.911508', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 285[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.1ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:45:44.933742', '2023-08-22 10:45:44.933742')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=286" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"286"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 286 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 211)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 210)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 10:45:44.962386', '2023-08-22 10:45:44.962386')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' AND `users`.`id` != 287 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:45:44.966115' WHERE `users`.`id` = 287[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/111" for 127.0.0.1 at 2023-08-22 19:45:44 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"111"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '111' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 287 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 1.0ms | Allocations: 928)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:46:53 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:46:53.895933', '2023-08-22 10:46:53.895933')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 288 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 288 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('utcay0t76e268byh6mbzmmjrmty5', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:46:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 288, 52, '2023-08-22 10:46:54')[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:46:54.280545' WHERE `users`.`id` = 288[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: utcay0t76e268byh6mbzmmjrmty5 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 710e1c8c-c24f-431c-aaaf-fce1445ce059) to Test(default) with arguments: #<GlobalID:0x00007f81e29dfd30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/52>>
Completed 200 OK in 423ms (Views: 0.6ms | ActiveRecord: 9.6ms | Allocations: 210482)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 3.6ms | ActiveRecord: 0.7ms | Allocations: 3005)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:46:54.332502', '2023-08-22 10:46:54.332502')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/289" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"289"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 289 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 289 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 289 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:46:54.348023' WHERE `users`.`id` = 289[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 2.3ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:46:54.355924', '2023-08-22 10:46:54.355924')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/290" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"290"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 290 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 290 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 290 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 0.5ms | ActiveRecord: 1.5ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:46:54.376844', '2023-08-22 10:46:54.376844')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/291" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"291"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 291 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 291[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 291[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 291[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 291[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 291[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 291[0m
  [1m[36mFavoriteReview Load (0.5ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 291[0m
  [1m[36mFavoriteQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 291[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 291[0m
  [1m[36mFavoriteSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 291[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 291[0m
  [1m[36mBrowsingHistory Load (0.2ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 291[0m
  [1m[36mNotification Load (0.6ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 291[0m
  [1m[36mNotification Load (0.6ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 291[0m
  [1m[36mFavoriteSurvey Load (0.3ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 291[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 291 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 291[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 93ms (ActiveRecord: 24.2ms | Allocations: 41696)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:46:54.487212', '2023-08-22 10:46:54.487212')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 292 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:46:54.490590' WHERE `users`.`id` = 292[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 292 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/292" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"292"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 292 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 266)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:46:54.509363', '2023-08-22 10:46:54.509363')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 293 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:46:54.511982' WHERE `users`.`id` = 293[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 293 LIMIT 1[0m
Started GET "/users/293" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"293"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 293 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 293[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 293[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 293[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 293[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 293[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 293[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 293[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 293[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 293[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 293[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 293[0m
  [1m[36mSurvey Load (0.3ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 293[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 293[0m
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 10.9ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:46:54.559750', '2023-08-22 10:46:54.559750')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/294" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"294"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 294 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 294 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 294[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 294[0m
  [1m[36mQuestion Load (0.2ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 294[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 294[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 294[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 294[0m
  [1m[36mSubjectQuestion Load (0.2ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 294[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 294[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 294[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 294[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 294[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 294[0m
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 4.2ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms | Allocations: 178)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:46:54.599754', '2023-08-22 10:46:54.599754')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"295", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 295 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 295 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 295 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:46:54.613584', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 295[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 2.0ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:46:54.633194', '2023-08-22 10:46:54.633194')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=296" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"296"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 296 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 211)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms | Allocations: 210)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 10:46:54.658134', '2023-08-22 10:46:54.658134')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' AND `users`.`id` != 297 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:46:54.661322' WHERE `users`.`id` = 297[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/111" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"111"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '111' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 297 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
Completed 200 OK in 3ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 928)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa10@sample.com', 'kanakana123410', '2023-08-22 10:46:54.679323', '2023-08-22 10:46:54.679323')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' AND `users`.`id` != 298 LIMIT 1[0m
  [1m[36mUser Update (1.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:46:54.683790' WHERE `users`.`id` = 298[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/112" for 127.0.0.1 at 2023-08-22 19:46:54 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"112"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '112' LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.5ms | Allocations: 815)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:47:28 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:47:29.013114', '2023-08-22 10:47:29.013114')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 299 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 299 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('tvfwo3cndvh9oe1r04c88chmx89d', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:47:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 299, 53, '2023-08-22 10:47:29')[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:47:29.487916' WHERE `users`.`id` = 299[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.5ms) [0m[32mUploaded file to key: tvfwo3cndvh9oe1r04c88chmx89d (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ba4d4b13-fea2-40a2-82d6-0afea4a12529) to Test(default) with arguments: #<GlobalID:0x00007fa2a2cab7e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/53>>
Completed 200 OK in 505ms (Views: 0.4ms | ActiveRecord: 8.4ms | Allocations: 210536)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 3.8ms | ActiveRecord: 0.9ms | Allocations: 3005)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:47:29.539714', '2023-08-22 10:47:29.539714')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/300" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"300"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 300 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 300 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 300 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:47:29.554788' WHERE `users`.`id` = 300[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.8ms | Allocations: 2440)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:47:29.563485', '2023-08-22 10:47:29.563485')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/301" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"301"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 301 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 301 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 301 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.6ms | ActiveRecord: 2.0ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:47:29.585047', '2023-08-22 10:47:29.585047')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/302" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"302"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 302 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 302[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 302[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 302[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 302[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 302[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 302[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 302[0m
  [1m[36mFavoriteQuestion Load (0.4ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 302[0m
  [1m[36mFavoriteReply Load (0.4ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 302[0m
  [1m[36mFavoriteSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 302[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.2ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 302[0m
  [1m[36mBrowsingHistory Load (0.3ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 302[0m
  [1m[36mNotification Load (0.4ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 302[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 302[0m
  [1m[36mFavoriteSurvey Load (0.9ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 302[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 302 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 302[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 95ms (ActiveRecord: 25.4ms | Allocations: 41696)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:47:29.697546', '2023-08-22 10:47:29.697546')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 303 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:47:29.700461' WHERE `users`.`id` = 303[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 303 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/303" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"303"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 303 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 266)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:47:29.722165', '2023-08-22 10:47:29.722165')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 304 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:47:29.726959' WHERE `users`.`id` = 304[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 304 LIMIT 1[0m
Started GET "/users/304" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"304"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 304 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 304[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 304[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 304[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 304[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 304[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 304[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 304[0m
  [1m[36mSubjectQuestion Load (0.4ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 304[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 304[0m
  [1m[36mSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 304[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 304[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 304[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 304[0m
Completed 200 OK in 39ms (Views: 0.4ms | ActiveRecord: 13.5ms | Allocations: 12299)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:47:29.785179', '2023-08-22 10:47:29.785179')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/305" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"305"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 305 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 305 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 305[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 305[0m
  [1m[36mQuestion Load (0.6ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 305[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 305[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 305[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 305[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 305[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 305[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 305[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 305[0m
  [1m[36mSurvey Load (0.5ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 305[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 305[0m
Completed 200 OK in 23ms (Views: 0.3ms | ActiveRecord: 6.9ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms | Allocations: 178)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:47:29.840220', '2023-08-22 10:47:29.840220')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"306", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 306 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 306 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 306 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:47:29.855478', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 306[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.6ms | ActiveRecord: 2.3ms | Allocations: 1997)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 2ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 396)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:47:29.883364', '2023-08-22 10:47:29.883364')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=307" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"307"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 307 LIMIT 1[0m
Completed 200 OK in 20ms (ActiveRecord: 0.4ms | Allocations: 211)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 210)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 10:47:29.935946', '2023-08-22 10:47:29.935946')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' AND `users`.`id` != 308 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:47:29.940004' WHERE `users`.`id` = 308[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/111" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"111"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '111' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 308 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 1.1ms | Allocations: 928)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa10@sample.com', 'kanakana123410', '2023-08-22 10:47:29.958739', '2023-08-22 10:47:29.958739')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' AND `users`.`id` != 309 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:47:29.962748' WHERE `users`.`id` = 309[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/112" for 127.0.0.1 at 2023-08-22 19:47:29 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"112"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '112' LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms | Allocations: 162)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"神奈川太郎", "email"=>"kanagawa@sample.com", "uid"=>"123456"}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎', 'kanagawa@sample.com', '123456', '2023-08-22 10:47:54.093279', '2023-08-22 10:47:54.093279')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 310 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa@sample.com' AND `users`.`id` != 310 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wdf257cetc2kko9tfzoth4x0kgg1', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 134097, 'fV7+Yblf6bt6VNpJJs5WAQ==', '2023-08-22 10:47:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'User', 310, 54, '2023-08-22 10:47:54')[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:47:54.581482' WHERE `users`.`id` = 310[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: wdf257cetc2kko9tfzoth4x0kgg1 (checksum: fV7+Yblf6bt6VNpJJs5WAQ==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 77aec509-c40b-4eec-9cc4-798a96077039) to Test(default) with arguments: #<GlobalID:0x00007f96302cc158 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/54>>
Completed 200 OK in 531ms (Views: 0.5ms | ActiveRecord: 10.0ms | Allocations: 210469)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`name` = '神奈川太郎' LIMIT 1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started POST "/users" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#create as HTML
  Parameters: {"user"=>{"name"=>"", "email"=>"", "uid"=>""}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 3.4ms | ActiveRecord: 0.8ms | Allocations: 3005)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 10:47:54.631392', '2023-08-22 10:47:54.631392')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/311" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>"東京一郎", "introduction"=>"よろしくお願いします!", "first_choice_school"=>"A大学", "second_choice_school"=>"B大学", "third_choice_school"=>"C大学"}, "id"=>"311"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 311 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 311 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' AND `users`.`id` != 311 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`first_choice_school` = 'A大学', `users`.`second_choice_school` = 'B大学', `users`.`third_choice_school` = 'C大学', `users`.`introduction` = 'よろしくお願いします!', `users`.`updated_at` = '2023-08-22 10:47:54.646351' WHERE `users`.`id` = 311[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.7ms | Allocations: 2440)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 10:47:54.652922', '2023-08-22 10:47:54.652922')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/312" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#update as HTML
  Parameters: {"user"=>{"name"=>""}, "id"=>"312"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 312 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 312 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' AND `users`.`id` != 312 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 6ms (Views: 1.0ms | ActiveRecord: 1.3ms | Allocations: 1873)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 10:47:54.671242', '2023-08-22 10:47:54.671242')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/313" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"313"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 313 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`user_id` = 313[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`user_id` = 313[0m
  [1m[36mSubjectQuestion Load (0.3ms)[0m  [1m[34mSELECT `subject_questions`.* FROM `subject_questions` WHERE `subject_questions`.`user_id` = 313[0m
  [1m[36mReply Load (0.4ms)[0m  [1m[34mSELECT `replies`.* FROM `replies` WHERE `replies`.`user_id` = 313[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT `subject_question_replies`.* FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 313[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`user_id` = 313[0m
  [1m[36mFavoriteReview Load (0.3ms)[0m  [1m[34mSELECT `favorite_reviews`.* FROM `favorite_reviews` WHERE `favorite_reviews`.`user_id` = 313[0m
  [1m[36mFavoriteQuestion Load (0.3ms)[0m  [1m[34mSELECT `favorite_questions`.* FROM `favorite_questions` WHERE `favorite_questions`.`user_id` = 313[0m
  [1m[36mFavoriteReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_replies`.* FROM `favorite_replies` WHERE `favorite_replies`.`user_id` = 313[0m
  [1m[36mFavoriteSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT `favorite_subject_questions`.* FROM `favorite_subject_questions` WHERE `favorite_subject_questions`.`user_id` = 313[0m
  [1m[36mFavoriteSubjectQuestionReply Load (0.3ms)[0m  [1m[34mSELECT `favorite_subject_question_replies`.* FROM `favorite_subject_question_replies` WHERE `favorite_subject_question_replies`.`user_id` = 313[0m
  [1m[36mBrowsingHistory Load (0.4ms)[0m  [1m[34mSELECT `browsing_histories`.* FROM `browsing_histories` WHERE `browsing_histories`.`user_id` = 313[0m
  [1m[36mNotification Load (0.3ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`action_user_id` = 313[0m
  [1m[36mNotification Load (0.2ms)[0m  [1m[34mSELECT `notifications`.* FROM `notifications` WHERE `notifications`.`target_user_id` = 313[0m
  [1m[36mFavoriteSurvey Load (0.2ms)[0m  [1m[34mSELECT `favorite_surveys`.* FROM `favorite_surveys` WHERE `favorite_surveys`.`user_id` = 313[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 313 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM `users` WHERE `users`.`id` = 313[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 92ms (ActiveRecord: 23.7ms | Allocations: 41696)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 10:47:54.777707', '2023-08-22 10:47:54.777707')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' AND `users`.`id` != 314 LIMIT 1[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE `users` SET `users`.`admin` = TRUE, `users`.`updated_at` = '2023-08-22 10:47:54.780755' WHERE `users`.`id` = 314[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 314 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
Started DELETE "/users/314" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#destroy as HTML
  Parameters: {"id"=>"314"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 314 LIMIT 1[0m
Completed 400 Bad Request in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 266)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `users`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 10:47:54.799188', '2023-08-22 10:47:54.799188')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' AND `users`.`id` != 315 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '東京一郎', `users`.`updated_at` = '2023-08-22 10:47:54.802760' WHERE `users`.`id` = 315[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 315 LIMIT 1[0m
Started GET "/users/315" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#show as HTML
  Parameters: {"id"=>"315"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 315 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 315[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 315[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 315[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 315[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 315[0m
  [1m[36mReply Load (0.3ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 315[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 315[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 315[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 315[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 315[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 315[0m
  [1m[36mSurvey Load (0.6ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 315[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 315[0m
Completed 200 OK in 36ms (Views: 0.3ms | ActiveRecord: 12.8ms | Allocations: 12299)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('京都二郎', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 10:47:54.854113', '2023-08-22 10:47:54.854113')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/show_other_user/316" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"316"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 316 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 316 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT reviews.*, (SELECT COUNT(*) FROM favorite_reviews WHERE favorite_reviews.review_id = reviews.id) AS favorite_reviews_count FROM `reviews` WHERE `reviews`.`user_id` = 316[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_reviews` INNER JOIN `reviews` `review` ON `review`.`id` = `favorite_reviews`.`review_id` WHERE `review`.`user_id` = 316[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT questions.*, (SELECT COUNT(*) FROM replies WHERE replies.question_id = questions.id) AS replies_count, (SELECT COUNT(*) FROM favorite_questions WHERE favorite_questions.question_id = questions.id) AS favorite_questions_count FROM `questions` WHERE `questions`.`user_id` = 316[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_questions` INNER JOIN `questions` ON `questions`.`id` = `favorite_questions`.`question_id` WHERE `questions`.`user_id` = 316[0m
  [1m[36mReply Load (0.5ms)[0m  [1m[34mSELECT replies.*, (SELECT COUNT(*) FROM favorite_replies WHERE favorite_replies.reply_id = replies.id) AS favorite_replies_count FROM `replies` WHERE `replies`.`user_id` = 316[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_replies` INNER JOIN `replies` `reply` ON `reply`.`id` = `favorite_replies`.`reply_id` WHERE `reply`.`user_id` = 316[0m
  [1m[36mSubjectQuestion Load (0.5ms)[0m  [1m[34mSELECT subject_questions.*, (SELECT COUNT(*) FROM subject_question_replies WHERE subject_question_replies.subject_question_id = subject_questions.id) AS subject_question_replies_count, (SELECT COUNT(*) FROM favorite_subject_questions WHERE favorite_subject_questions.subject_question_id = subject_questions.id) AS favorite_subject_questions_count FROM `subject_questions` WHERE `subject_questions`.`user_id` = 316[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_questions` INNER JOIN `subject_questions` `subject_question` ON `subject_question`.`id` = `favorite_subject_questions`.`subject_question_id` WHERE `subject_question`.`user_id` = 316[0m
  [1m[36mSubjectQuestionReply Load (0.4ms)[0m  [1m[34mSELECT subject_question_replies.*, (SELECT COUNT(*) FROM favorite_subject_question_replies WHERE favorite_subject_question_replies.subject_question_reply_id = subject_question_replies.id) AS favorite_subject_question_replies_count FROM `subject_question_replies` WHERE `subject_question_replies`.`user_id` = 316[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_subject_question_replies` INNER JOIN `subject_question_replies` `subject_question_reply` ON `subject_question_reply`.`id` = `favorite_subject_question_replies`.`subject_question_reply_id` WHERE `subject_question_reply`.`user_id` = 316[0m
  [1m[36mSurvey Load (0.4ms)[0m  [1m[34mSELECT surveys.*, (SELECT COUNT(*) FROM survey_answers WHERE survey_answers.survey_id = surveys.id) AS survey_answers_count, (SELECT COUNT(*) FROM favorite_surveys WHERE favorite_surveys.survey_id = surveys.id) AS favorite_surveys_count FROM `surveys` WHERE `surveys`.`user_id` = 316[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `favorite_surveys` INNER JOIN `surveys` `survey` ON `survey`.`id` = `favorite_surveys`.`survey_id` WHERE `survey`.`user_id` = 316[0m
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 6.3ms | Allocations: 4736)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/show_other_user/-1" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#show_other_user as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.4ms | Allocations: 178)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 10:47:54.897617', '2023-08-22 10:47:54.897617')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>"317", "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 317 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 317 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' AND `users`.`id` != 317 LIMIT 1[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE `users` SET `users`.`updated_at` = '2023-08-22 10:47:54.911168', `users`.`memo` = 'ユーザーメモ' WHERE `users`.`id` = 317[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 2.0ms | Allocations: 1997)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started PATCH "/users/save_user_memo" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#save_user_memo as HTML
  Parameters: {"current_user_id"=>nil, "memo"=>"ユーザーメモ"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
Completed 404 Not Found in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 396)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 10:47:54.930453', '2023-08-22 10:47:54.930453')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/check_existence?id=318" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"318"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 318 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 211)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/users/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 210)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 10:47:54.957813', '2023-08-22 10:47:54.957813')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' AND `users`.`id` != 319 LIMIT 1[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:47:54.961402' WHERE `users`.`id` = 319[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/111" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"111"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '111' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 319 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 0.8ms | Allocations: 928)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa10@sample.com', 'kanakana123410', '2023-08-22 10:47:54.978861', '2023-08-22 10:47:54.978861')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' AND `users`.`id` != 320 LIMIT 1[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE `users` SET `users`.`name` = '神奈川太郎', `users`.`uid` = '111', `users`.`updated_at` = '2023-08-22 10:47:54.982225' WHERE `users`.`id` = 320[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/users/find_user_by_uid/112" for 127.0.0.1 at 2023-08-22 19:47:54 +0900
Processing by UsersController#find_user_by_uid as HTML
  Parameters: {"uid"=>"112"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`uid` = '112' LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 190)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (15.8ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:42:57.049111', '2023-08-22 11:42:57.049111')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (1.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:42:57.067248', '2023-08-22 11:42:57.067248')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:42:57.071960', '2023-08-22 11:42:57.071960')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:42:57.074666', '2023-08-22 11:42:57.074666')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books" for 127.0.0.1 at 2023-08-22 20:42:57 +0900
Processing by BooksController#index as HTML
  [1m[36mBook Load (3.1ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = ) AS check_favorite FROM `books`[0m
Completed 500 Internal Server Error in 14ms (ActiveRecord: 3.1ms | Allocations: 3516)
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:48:50.643035', '2023-08-22 11:48:50.643035')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:49:06.894861', '2023-08-22 11:49:06.894861')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:49:06.991289', '2023-08-22 11:49:06.991289')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 4 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u26at0dyp2ai3mufqmxa7j24blew', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:49:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 4, 55, '2023-08-22 11:49:07')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:49:07.008546' WHERE `books`.`id` = 4[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.5ms) [0m[32mUploaded file to key: u26at0dyp2ai3mufqmxa7j24blew (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 93f7158d-726a-4c65-bda6-0055e50b8eb0) to Test(default) with arguments: #<GlobalID:0x00007fc8109026c8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/55>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:49:07.022181', '2023-08-22 11:49:07.022181')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 5 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wbnicw26jmqfyuu13gjiz1rdo4v8', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:49:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 5, 56, '2023-08-22 11:49:07')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:49:07.027887' WHERE `books`.`id` = 5[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: wbnicw26jmqfyuu13gjiz1rdo4v8 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1fefe67a-64cb-4638-968e-322bc7746bd6) to Test(default) with arguments: #<GlobalID:0x00007fc810da6d50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/56>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:49:07.033996', '2023-08-22 11:49:07.033996')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 6 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7zz9j3bjtnwfsqzw5m0em87xtal4', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:49:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 6, 57, '2023-08-22 11:49:07')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:49:07.039099' WHERE `books`.`id` = 6[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 7zz9j3bjtnwfsqzw5m0em87xtal4 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f70491b3-b573-4c80-a275-3c2c7a59dbf3) to Test(default) with arguments: #<GlobalID:0x00007fc80bb1e1f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/57>>
Started GET "/books" for 127.0.0.1 at 2023-08-22 20:49:07 +0900
Processing by BooksController#index as HTML
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = ) AS check_favorite FROM `books`[0m
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.5ms | Allocations: 3512)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:50:12.173524', '2023-08-22 11:50:12.173524')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:12.251708', '2023-08-22 11:50:12.251708')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 7 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('j78jk0weo09x0lo8d46vyua0zx5e', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:50:12')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 7, 58, '2023-08-22 11:50:12')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:50:12.275143' WHERE `books`.`id` = 7[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: j78jk0weo09x0lo8d46vyua0zx5e (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3dd2565e-148c-4fcb-98b1-12e7c71cb7bb) to Test(default) with arguments: #<GlobalID:0x00007fd2b3f7ad90 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/58>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:12.286331', '2023-08-22 11:50:12.286331')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 8 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kcsr8si9f9ak2hsr1lxmtc2192hv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:50:12')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 8, 59, '2023-08-22 11:50:12')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:50:12.292722' WHERE `books`.`id` = 8[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: kcsr8si9f9ak2hsr1lxmtc2192hv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2fc9c80a-d1e4-4a53-a98e-d468d0a5b3af) to Test(default) with arguments: #<GlobalID:0x00007fd2b0325908 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/59>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:12.301339', '2023-08-22 11:50:12.301339')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 9 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0cqkigd6ntjk7bw9574oyw2at3c6', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:50:12')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 9, 60, '2023-08-22 11:50:12')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:50:12.308199' WHERE `books`.`id` = 9[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 0cqkigd6ntjk7bw9574oyw2at3c6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8f96b832-ac95-4c6d-a92a-3ec02038a2c8) to Test(default) with arguments: #<GlobalID:0x00007fd2b150ed40 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/60>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 20:50:12 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (7, 8, 9)[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (7, 8, 9)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (58, 59, 60)[0m
Completed 200 OK in 28ms (Views: 0.6ms | ActiveRecord: 3.4ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:50:41.942250', '2023-08-22 11:50:41.942250')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:42.029354', '2023-08-22 11:50:42.029354')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 10 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('1djr3s0s6qzabxnlvygka8dvnew1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:50:42')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 10, 61, '2023-08-22 11:50:42')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:50:42.045843' WHERE `books`.`id` = 10[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: 1djr3s0s6qzabxnlvygka8dvnew1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4ca0aca9-9836-43d2-9574-8e25090533d5) to Test(default) with arguments: #<GlobalID:0x00007fb8db441560 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/61>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:42.055884', '2023-08-22 11:50:42.055884')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 11 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kyxotvsxz4cq0vj9yib6nf6ezijb', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:50:42')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 11, 62, '2023-08-22 11:50:42')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:50:42.061328' WHERE `books`.`id` = 11[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: kyxotvsxz4cq0vj9yib6nf6ezijb (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 07ee93c7-17b1-4b27-862a-84617b53ecc0) to Test(default) with arguments: #<GlobalID:0x00007fb8dc37b328 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/62>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:42.069039', '2023-08-22 11:50:42.069039')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 12 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('zz00wu0l5bcyrkz6ql6a2zxg6gax', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:50:42')[0m
  [1m[36mActiveStorage::Attachment Create (1.0ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 12, 63, '2023-08-22 11:50:42')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:50:42.075731' WHERE `books`.`id` = 12[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: zz00wu0l5bcyrkz6ql6a2zxg6gax (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 072a433e-b1b0-40f7-926e-d2f206c58c79) to Test(default) with arguments: #<GlobalID:0x00007fb8db743330 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/63>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 20:50:42 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (10, 11, 12)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (10, 11, 12)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (61, 62, 63)[0m
Completed 200 OK in 19ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:50:59.898593', '2023-08-22 11:50:59.898593')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:50:59.986418', '2023-08-22 11:50:59.986418')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 13 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('98qvhn2orub42mdfcgdoh4py2kyo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 13, 64, '2023-08-22 11:51:00')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:00.009693' WHERE `books`.`id` = 13[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: 98qvhn2orub42mdfcgdoh4py2kyo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 27df4c4f-f93d-429e-87e6-335a1f0dd899) to Test(default) with arguments: #<GlobalID:0x00007ff524dbc178 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/64>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:00.020429', '2023-08-22 11:51:00.020429')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 14 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('74b6zl0dk8cps3jqc5su9bw7km6u', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 14, 65, '2023-08-22 11:51:00')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:00.027160' WHERE `books`.`id` = 14[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: 74b6zl0dk8cps3jqc5su9bw7km6u (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6bda6368-fa69-452f-b904-15231734759a) to Test(default) with arguments: #<GlobalID:0x00007ff525ff6d98 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/65>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:00.033407', '2023-08-22 11:51:00.033407')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 15 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7w9hkh98ixuk26hs33uuxd8cnztw', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 15, 66, '2023-08-22 11:51:00')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:00.041631' WHERE `books`.`id` = 15[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 7w9hkh98ixuk26hs33uuxd8cnztw (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1a4d44f0-6ab9-479d-a105-c9e067a43b0e) to Test(default) with arguments: #<GlobalID:0x00007ff52822f040 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/66>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 20:51:00 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (13, 14, 15)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (13, 14, 15)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (64, 65, 66)[0m
Completed 200 OK in 22ms (Views: 0.4ms | ActiveRecord: 3.1ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:51:33.488592', '2023-08-22 11:51:33.488592')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:33.574957', '2023-08-22 11:51:33.574957')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 16 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xz0gmop0j2eiv41g5v4y7b8w0yhp', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 16, 67, '2023-08-22 11:51:33')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:33.596794' WHERE `books`.`id` = 16[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: xz0gmop0j2eiv41g5v4y7b8w0yhp (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d2211c98-fa14-45d1-927d-7b70d5e860cc) to Test(default) with arguments: #<GlobalID:0x00007fc8e8305710 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/67>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:33.607363', '2023-08-22 11:51:33.607363')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 17 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kror9skk8w3wrofoo3iqdohmrd1w', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 17, 68, '2023-08-22 11:51:33')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:33.613191' WHERE `books`.`id` = 17[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: kror9skk8w3wrofoo3iqdohmrd1w (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9d637f3a-4e62-4caf-9ca5-25657b75cc85) to Test(default) with arguments: #<GlobalID:0x00007fc8e4ac2830 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/68>>
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:33.621110', '2023-08-22 11:51:33.621110')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 18 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gqheseqhp9bt70bmxa10b4tk9cl2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 18, 69, '2023-08-22 11:51:33')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:33.626660' WHERE `books`.`id` = 18[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: gqheseqhp9bt70bmxa10b4tk9cl2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8c2e3c19-9190-4556-ab9e-3eec8e20fa56) to Test(default) with arguments: #<GlobalID:0x00007fc8e5cd2ac0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/69>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 20:51:33 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (16, 17, 18)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (16, 17, 18)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (67, 68, 69)[0m
Completed 200 OK in 20ms (Views: 0.4ms | ActiveRecord: 3.2ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:51:40.694417', '2023-08-22 11:51:40.694417')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:40.790867', '2023-08-22 11:51:40.790867')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 19 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('85i9vziofhs6pltqf62tj8fqztxv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 19, 70, '2023-08-22 11:51:40')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:40.809065' WHERE `books`.`id` = 19[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 85i9vziofhs6pltqf62tj8fqztxv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9bd07829-f455-4399-9e1e-7064215475df) to Test(default) with arguments: #<GlobalID:0x00007fc399ad0750 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/70>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:40.820110', '2023-08-22 11:51:40.820110')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 20 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pcqcm3v5ndy5deloj6gcuuhiai6s', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 20, 71, '2023-08-22 11:51:40')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:40.826939' WHERE `books`.`id` = 20[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: pcqcm3v5ndy5deloj6gcuuhiai6s (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a7e3141c-374b-498b-8a22-c7e2fbb599c6) to Test(default) with arguments: #<GlobalID:0x00007fc399c51818 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/71>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:51:40.834848', '2023-08-22 11:51:40.834848')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 21 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('azl9oeui558fik6vfl7yz7x4e7sy', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:51:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 21, 72, '2023-08-22 11:51:40')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:51:40.841300' WHERE `books`.`id` = 21[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: azl9oeui558fik6vfl7yz7x4e7sy (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: af8dd3a1-6283-45f0-89ad-368f078b86e5) to Test(default) with arguments: #<GlobalID:0x00007fc39cc8f1d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/72>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 20:51:40 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (19, 20, 21)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (19, 20, 21)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (70, 71, 72)[0m
Completed 200 OK in 26ms (Views: 0.6ms | ActiveRecord: 3.7ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 11:58:30.298046', '2023-08-22 11:58:30.298046')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:58:30.406119', '2023-08-22 11:58:30.406119')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 22 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rwf6410v64grvl8ih0g3k97zmxd5', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:58:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 22, 73, '2023-08-22 11:58:30')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:58:30.413704' WHERE `books`.`id` = 22[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.7ms) [0m[32mUploaded file to key: rwf6410v64grvl8ih0g3k97zmxd5 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 860908f6-3e5c-4851-908b-5c0eba28b23a) to Test(default) with arguments: #<GlobalID:0x00007fa1ec8ea8d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/73>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:58:30.426830', '2023-08-22 11:58:30.426830')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 23 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pjnu5fuy891yp6q68g2axq0xeteo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:58:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 23, 74, '2023-08-22 11:58:30')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:58:30.433579' WHERE `books`.`id` = 23[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: pjnu5fuy891yp6q68g2axq0xeteo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6ac5fffb-5410-4962-a481-3b5db56be8ea) to Test(default) with arguments: #<GlobalID:0x00007fa1edb80f38 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/74>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 11:58:30.440436', '2023-08-22 11:58:30.440436')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 24 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('igcylp8u59fjtd3m5v0o236tm088', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 11:58:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 24, 75, '2023-08-22 11:58:30')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 11:58:30.445749' WHERE `books`.`id` = 24[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: igcylp8u59fjtd3m5v0o236tm088 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ded15c0e-3638-4258-87e5-8e5c0073e395) to Test(default) with arguments: #<GlobalID:0x00007fa1ee2d7d68 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/75>>
Started GET "/books" for 127.0.0.1 at 2023-08-22 20:58:30 +0900
Processing by BooksController#index as HTML
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = ) AS check_favorite FROM `books`[0m
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.5ms | Allocations: 3512)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:06:26.884225', '2023-08-22 12:06:26.884225')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:26.990330', '2023-08-22 12:06:26.990330')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 25 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ojwkr2saz2eru5ygwcyuuvmd52y7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:26')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 25, 76, '2023-08-22 12:06:26')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:26.998777' WHERE `books`.`id` = 25[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.8ms) [0m[32mUploaded file to key: ojwkr2saz2eru5ygwcyuuvmd52y7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 18689ad0-6790-4697-8ea3-13e94e3eabd3) to Test(default) with arguments: #<GlobalID:0x00007fd2678fae58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/76>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:27.011570', '2023-08-22 12:06:27.011570')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 26 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9t01ck566qtoz364qmw0v3ombb9m', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 26, 77, '2023-08-22 12:06:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:27.016990' WHERE `books`.`id` = 26[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 9t01ck566qtoz364qmw0v3ombb9m (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bbec56cf-464e-4ad1-ab72-c6d31c46b282) to Test(default) with arguments: #<GlobalID:0x00007fd2677c43b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/77>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:27.025327', '2023-08-22 12:06:27.025327')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 27 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wzdf3nd0xzzsm7kw5mmockp3fswi', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 27, 78, '2023-08-22 12:06:27')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:27.031763' WHERE `books`.`id` = 27[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: wzdf3nd0xzzsm7kw5mmockp3fswi (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4ae7d86a-28ae-4169-abb1-757bf1d54041) to Test(default) with arguments: #<GlobalID:0x00007fd26c132158 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/78>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:06:27 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (25, 26, 27)[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (25, 26, 27)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (76, 77, 78)[0m
Completed 200 OK in 30ms (Views: 0.5ms | ActiveRecord: 3.4ms | Allocations: 10695)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:06:59.027202', '2023-08-22 12:06:59.027202')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:59.129189', '2023-08-22 12:06:59.129189')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 28 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('4lyxhv93l1d0168o20iddolaxezx', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:59')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 28, 79, '2023-08-22 12:06:59')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:59.138630' WHERE `books`.`id` = 28[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (4.3ms) [0m[32mUploaded file to key: 4lyxhv93l1d0168o20iddolaxezx (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 23fe7eba-7b47-49aa-8d39-b1f0be78e129) to Test(default) with arguments: #<GlobalID:0x00007fb6c695cf70 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/79>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:59.150843', '2023-08-22 12:06:59.150843')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 29 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pvsa64deyuz3ghn9vdumihcpnee6', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:59')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 29, 80, '2023-08-22 12:06:59')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:59.157085' WHERE `books`.`id` = 29[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: pvsa64deyuz3ghn9vdumihcpnee6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b52944fd-012d-4a5f-ac10-2b4eaac137a2) to Test(default) with arguments: #<GlobalID:0x00007fb6cba1cf28 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/80>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:59.163879', '2023-08-22 12:06:59.163879')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 30 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r83btckgykn5tjb6cwed15z4t79r', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:59')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 30, 81, '2023-08-22 12:06:59')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:59.169885' WHERE `books`.`id` = 30[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: r83btckgykn5tjb6cwed15z4t79r (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a612fae3-f129-4d6c-b5b7-ad6265e7d90a) to Test(default) with arguments: #<GlobalID:0x00007fb6ca2f39f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/81>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:06:59 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (28, 29, 30)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (28, 29, 30)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (79, 80, 81)[0m
Completed 200 OK in 21ms (Views: 0.4ms | ActiveRecord: 3.6ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:06:59.230318', '2023-08-22 12:06:59.230318')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:06:59.237809', '2023-08-22 12:06:59.237809')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 31 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('6sp03kojrx859bzawzedi4v4ny5t', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:06:59')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 31, 82, '2023-08-22 12:06:59')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:06:59.243541' WHERE `books`.`id` = 31[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 6sp03kojrx859bzawzedi4v4ny5t (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f1812d0b-37e0-4016-ad6d-78c1bbca0d93) to Test(default) with arguments: #<GlobalID:0x00007fb6cbebc560 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/82>>
Started GET "/books/31" for 127.0.0.1 at 2023-08-22 21:06:59 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"31"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (2.2ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 31 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 31[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 31[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 82[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 3.8ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:07:10.856811', '2023-08-22 12:07:10.856811')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:10.966909', '2023-08-22 12:07:10.966909')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 32 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('l93y3u6yild31yy5cchy2zl5kvpk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:10')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 32, 83, '2023-08-22 12:07:10')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:10.975469' WHERE `books`.`id` = 32[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: l93y3u6yild31yy5cchy2zl5kvpk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8045b711-bc4c-4077-831f-306534381165) to Test(default) with arguments: #<GlobalID:0x00007f87480a1a28 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/83>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:10.987768', '2023-08-22 12:07:10.987768')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 33 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('6nxbxp95fafg8yd59o8olp7ksqq8', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:10')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 33, 84, '2023-08-22 12:07:10')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:10.994744' WHERE `books`.`id` = 33[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: 6nxbxp95fafg8yd59o8olp7ksqq8 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 62af8c2d-ca5d-4060-8d81-88ea4970ae7f) to Test(default) with arguments: #<GlobalID:0x00007f874c038588 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/84>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:11.003881', '2023-08-22 12:07:11.003881')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 34 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ezjl0olmxzcp0ymdmg2qt1a8wysd', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 34, 85, '2023-08-22 12:07:11')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:11.009875' WHERE `books`.`id` = 34[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: ezjl0olmxzcp0ymdmg2qt1a8wysd (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bb55b83b-d053-40c9-b539-cdbc551b075f) to Test(default) with arguments: #<GlobalID:0x00007f8743ee3758 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/85>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:07:11 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (1.2ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (32, 33, 34)[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (32, 33, 34)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (83, 84, 85)[0m
Completed 200 OK in 27ms (Views: 0.4ms | ActiveRecord: 4.3ms | Allocations: 10693)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:07:11.079277', '2023-08-22 12:07:11.079277')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:11.085072', '2023-08-22 12:07:11.085072')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 35 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('urxc50d8b83wk5lcp9o84xfhz3vu', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 35, 86, '2023-08-22 12:07:11')[0m
  [1m[36mBook Update (1.1ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:11.089792' WHERE `books`.`id` = 35[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: urxc50d8b83wk5lcp9o84xfhz3vu (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4a8fb5a1-574f-447f-abb9-b2d8b3a56b37) to Test(default) with arguments: #<GlobalID:0x00007f8742c73028 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/86>>
Started GET "/books/35" for 127.0.0.1 at 2023-08-22 21:07:11 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"35"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 35 LIMIT 1[0m
  [1m[36mReview Load (0.7ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 35[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 35[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 86[0m
Completed 200 OK in 10ms (Views: 0.4ms | ActiveRecord: 3.2ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:07:25.260563', '2023-08-22 12:07:25.260563')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:25.357984', '2023-08-22 12:07:25.357984')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 36 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0as9vjwj69a1qnhmguqpa8202sus', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 36, 87, '2023-08-22 12:07:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:25.367036' WHERE `books`.`id` = 36[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.8ms) [0m[32mUploaded file to key: 0as9vjwj69a1qnhmguqpa8202sus (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5037124e-451e-4b7f-b262-0a6730da4301) to Test(default) with arguments: #<GlobalID:0x00007fb8e3c561d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/87>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:25.379263', '2023-08-22 12:07:25.379263')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 37 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xib55koc5wc9meiofsdph32504i9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 37, 88, '2023-08-22 12:07:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:25.385780' WHERE `books`.`id` = 37[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: xib55koc5wc9meiofsdph32504i9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0a122dfe-e686-4a19-9aae-1a7a9638f09a) to Test(default) with arguments: #<GlobalID:0x00007fb8e2d04e98 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/88>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:25.393998', '2023-08-22 12:07:25.393998')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 38 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('99heuqrtxdk8ti4ts2svt9718v6u', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 38, 89, '2023-08-22 12:07:25')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:25.400628' WHERE `books`.`id` = 38[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 99heuqrtxdk8ti4ts2svt9718v6u (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 85e6b68b-5803-4267-8c0b-3033a01d1517) to Test(default) with arguments: #<GlobalID:0x00007fb8e2f8fe38 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/89>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:07:25 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (1.2ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (36, 37, 38)[0m
  [1m[36mActiveStorage::Attachment Load (0.9ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (36, 37, 38)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (87, 88, 89)[0m
Completed 200 OK in 30ms (Views: 0.7ms | ActiveRecord: 4.9ms | Allocations: 10694)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:07:42.243869', '2023-08-22 12:07:42.243869')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:42.351359', '2023-08-22 12:07:42.351359')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 39 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ukx4vn7h009kmg14fbteo6buqdge', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:42')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 39, 90, '2023-08-22 12:07:42')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:42.357921' WHERE `books`.`id` = 39[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: ukx4vn7h009kmg14fbteo6buqdge (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b713b005-2f28-4cb3-a5cc-4934f0d94756) to Test(default) with arguments: #<GlobalID:0x00007fdf681858b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/90>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:42.367926', '2023-08-22 12:07:42.367926')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 40 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qek995oynlb9qg1dszz2qb0xvx0s', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:42')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 40, 91, '2023-08-22 12:07:42')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:42.375115' WHERE `books`.`id` = 40[0m
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: qek995oynlb9qg1dszz2qb0xvx0s (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 51523c6e-f8f3-4c32-9efa-d00ef8ffab6b) to Test(default) with arguments: #<GlobalID:0x00007fdf5faea7e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/91>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:07:42.384309', '2023-08-22 12:07:42.384309')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 41 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('taxiz0j2p9x169zmbf7et1vn0vbm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:07:42')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 41, 92, '2023-08-22 12:07:42')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:07:42.390856' WHERE `books`.`id` = 41[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: taxiz0j2p9x169zmbf7et1vn0vbm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 10d986a3-de3a-4cc2-a463-d95dde15ec10) to Test(default) with arguments: #<GlobalID:0x00007fdf629b3720 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/92>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:07:42 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.8ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (39, 40, 41)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (39, 40, 41)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (90, 91, 92)[0m
Completed 200 OK in 23ms (Views: 0.3ms | ActiveRecord: 3.8ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 1 AND `active_storage_attachments`.`record_type` = 'User' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`id`, `name`, `email`, `uid`, `created_at`, `updated_at`) VALUES (1, '神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:08:18.799503', '2023-08-22 12:08:18.799503')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:08:18.899008', '2023-08-22 12:08:18.899008')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 42 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('al4sxuz0hfatwad7hpb7xcrerrop', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:08:18')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 42, 93, '2023-08-22 12:08:18')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:08:18.907218' WHERE `books`.`id` = 42[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.8ms) [0m[32mUploaded file to key: al4sxuz0hfatwad7hpb7xcrerrop (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 852da62f-bec2-44ae-b693-3fe5efc2bdb0) to Test(default) with arguments: #<GlobalID:0x00007fd0581d19a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/93>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:08:18.918997', '2023-08-22 12:08:18.918997')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 43 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('66pk21c0rsxh8k7eznwb4dx2pdr5', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:08:18')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 43, 94, '2023-08-22 12:08:18')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:08:18.925097' WHERE `books`.`id` = 43[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 66pk21c0rsxh8k7eznwb4dx2pdr5 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b9ee15d6-57a5-4f77-9099-ed49fdf6273a) to Test(default) with arguments: #<GlobalID:0x00007fd0504bc5f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/94>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 1, '2023-08-22 12:08:18.932515', '2023-08-22 12:08:18.932515')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 44 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2qe4xpy5agt1zt108347u6i1szz5', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:08:18')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 44, 95, '2023-08-22 12:08:18')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:08:18.939629' WHERE `books`.`id` = 44[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 2qe4xpy5agt1zt108347u6i1szz5 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: dac1649d-4dd6-4cfa-a488-967b64a6ae2e) to Test(default) with arguments: #<GlobalID:0x00007fd04ff33500 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/95>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:08:18 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (42, 43, 44)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (42, 43, 44)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (93, 94, 95)[0m
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:08:18.997813', '2023-08-22 12:08:18.997813')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 321 LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 321, '2023-08-22 12:08:19.005683', '2023-08-22 12:08:19.005683')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 45 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xqry8x6cojxvyja56eox6go26f2l', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:08:19')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 45, 96, '2023-08-22 12:08:19')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:08:19.012695' WHERE `books`.`id` = 45[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (5.1ms) [0m[32mUploaded file to key: xqry8x6cojxvyja56eox6go26f2l (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 04a11fda-4e61-425d-8ebb-f13aa02d0e90) to Test(default) with arguments: #<GlobalID:0x00007fd0504763c8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/96>>
Started GET "/books/45" for 127.0.0.1 at 2023-08-22 21:08:19 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"45"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 45 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 45[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 45[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 96[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:09:04.350985', '2023-08-22 12:09:04.350985')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 322 LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 322, '2023-08-22 12:09:04.462304', '2023-08-22 12:09:04.462304')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 46 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.8ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('77fjcw5gqg4fl4ix6qecdh3ulyro', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:09:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 46, 97, '2023-08-22 12:09:04')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:09:04.483980' WHERE `books`.`id` = 46[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: 77fjcw5gqg4fl4ix6qecdh3ulyro (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 693b8682-f0d1-4547-862c-7a0d5da4723e) to Test(default) with arguments: #<GlobalID:0x00007fb5f0214ff0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/97>>
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 322 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 322, '2023-08-22 12:09:04.497077', '2023-08-22 12:09:04.497077')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 47 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('h0yjvwk867z08u7xw75vn4bmbk8t', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:09:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 47, 98, '2023-08-22 12:09:04')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:09:04.502951' WHERE `books`.`id` = 47[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: h0yjvwk867z08u7xw75vn4bmbk8t (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 91b7e5b0-a91b-425d-9fd7-f5d2d0356fe3) to Test(default) with arguments: #<GlobalID:0x00007fb5efadf4d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/98>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 322 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 322, '2023-08-22 12:09:04.510493', '2023-08-22 12:09:04.510493')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 48 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('e3k69lmnvb29zr42p5udex51dpac', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:09:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 48, 99, '2023-08-22 12:09:04')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:09:04.516391' WHERE `books`.`id` = 48[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: e3k69lmnvb29zr42p5udex51dpac (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1e657206-a175-4fb8-a3ac-c1f9eec87bdd) to Test(default) with arguments: #<GlobalID:0x00007fb5f03b4298 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/99>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:09:04 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (46, 47, 48)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (46, 47, 48)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (97, 98, 99)[0m
Completed 200 OK in 20ms (Views: 0.4ms | ActiveRecord: 3.5ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:09:04.572704', '2023-08-22 12:09:04.572704')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 323 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 323, '2023-08-22 12:09:04.578368', '2023-08-22 12:09:04.578368')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 49 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u53gd8wj9yzqqcz8fjfe2naoq2wa', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:09:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 49, 100, '2023-08-22 12:09:04')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:09:04.583038' WHERE `books`.`id` = 49[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: u53gd8wj9yzqqcz8fjfe2naoq2wa (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7bf056a8-b502-4200-a388-34ddb6c965a3) to Test(default) with arguments: #<GlobalID:0x00007fb5f05b81c0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/100>>
Started GET "/books/49" for 127.0.0.1 at 2023-08-22 21:09:04 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"49"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 49 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 49[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 49[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 100[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:10:40.736025', '2023-08-22 12:10:40.736025')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 324 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 324, '2023-08-22 12:10:40.831944', '2023-08-22 12:10:40.831944')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 50 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qg4etz29bbvpxlpedncrp08lr961', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:10:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 50, 101, '2023-08-22 12:10:40')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:10:40.847538' WHERE `books`.`id` = 50[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.3ms) [0m[32mUploaded file to key: qg4etz29bbvpxlpedncrp08lr961 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: dac98b0a-a305-4854-a0bf-4e40def8822b) to Test(default) with arguments: #<GlobalID:0x00007fa4804e9ef0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/101>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 324 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 324, '2023-08-22 12:10:40.860023', '2023-08-22 12:10:40.860023')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 51 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('bagck4i4xjxy0ejodncomw5uwmki', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:10:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 51, 102, '2023-08-22 12:10:40')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:10:40.866064' WHERE `books`.`id` = 51[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: bagck4i4xjxy0ejodncomw5uwmki (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b3bf921b-3f82-4062-8866-a1f62e10d0da) to Test(default) with arguments: #<GlobalID:0x00007fa483fa3f50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/102>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 324 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 324, '2023-08-22 12:10:40.877111', '2023-08-22 12:10:40.877111')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 52 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2n2ra0bzvexievwaclvjrfqewruq', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:10:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 52, 103, '2023-08-22 12:10:40')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:10:40.883093' WHERE `books`.`id` = 52[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 2n2ra0bzvexievwaclvjrfqewruq (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5482cbfe-9710-435f-b572-37f76d6373c7) to Test(default) with arguments: #<GlobalID:0x00007fa480b7b188 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/103>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:10:40 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (50, 51, 52)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (50, 51, 52)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (101, 102, 103)[0m
Completed 200 OK in 19ms (Views: 0.5ms | ActiveRecord: 2.7ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:10:40.937242', '2023-08-22 12:10:40.937242')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 325 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 325, '2023-08-22 12:10:40.943505', '2023-08-22 12:10:40.943505')[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 53 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('dng34im93dn6c2ktkjwvugyduohn', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:10:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 53, 104, '2023-08-22 12:10:40')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:10:40.948213' WHERE `books`.`id` = 53[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: dng34im93dn6c2ktkjwvugyduohn (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8160df46-6d75-444f-87ab-370052c92fe5) to Test(default) with arguments: #<GlobalID:0x00007fa4804ce178 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/104>>
Started GET "/books/53" for 127.0.0.1 at 2023-08-22 21:10:40 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"53"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 53 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 53[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 53[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 104[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 21:10:40 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 4ms (ActiveRecord: 1.0ms | Allocations: 1276)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:15:32.955339', '2023-08-22 12:15:32.955339')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 326 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 326, '2023-08-22 12:15:33.056593', '2023-08-22 12:15:33.056593')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 54 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ig9fr59ans5q5eib3vjibqohwqml', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:15:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 54, 105, '2023-08-22 12:15:33')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:15:33.064230' WHERE `books`.`id` = 54[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: ig9fr59ans5q5eib3vjibqohwqml (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 93db84e7-b7a8-4ca1-ae39-5124e863fa61) to Test(default) with arguments: #<GlobalID:0x00007fab876bc4b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/105>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 326 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 326, '2023-08-22 12:15:33.075314', '2023-08-22 12:15:33.075314')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 55 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9dzsmjnx5rxgh2z3t3tihrbuwiug', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:15:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 55, 106, '2023-08-22 12:15:33')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:15:33.080814' WHERE `books`.`id` = 55[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: 9dzsmjnx5rxgh2z3t3tihrbuwiug (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 208d6d9e-95cf-4fa6-884e-1e25bea83506) to Test(default) with arguments: #<GlobalID:0x00007fab8a2404b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/106>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 326 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 326, '2023-08-22 12:15:33.088873', '2023-08-22 12:15:33.088873')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 56 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('livaddhxi5xznw4ipgnz0bng1ioj', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:15:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 56, 107, '2023-08-22 12:15:33')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:15:33.094196' WHERE `books`.`id` = 56[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: livaddhxi5xznw4ipgnz0bng1ioj (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f7d26652-fc8e-447b-ba8d-f34779f94882) to Test(default) with arguments: #<GlobalID:0x00007fab8a253040 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/107>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:15:33 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (54, 55, 56)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (54, 55, 56)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (105, 106, 107)[0m
Completed 200 OK in 20ms (Views: 0.5ms | ActiveRecord: 3.1ms | Allocations: 10695)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:15:33.153588', '2023-08-22 12:15:33.153588')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 327 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 327, '2023-08-22 12:15:33.159084', '2023-08-22 12:15:33.159084')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 57 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('f8p0p2kb9wyrjgs4djk6t1jvyeip', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:15:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 57, 108, '2023-08-22 12:15:33')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:15:33.164528' WHERE `books`.`id` = 57[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: f8p0p2kb9wyrjgs4djk6t1jvyeip (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ca284706-d1f7-4857-8890-170af8564e25) to Test(default) with arguments: #<GlobalID:0x00007fab89fd4080 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/108>>
Started GET "/books/57" for 127.0.0.1 at 2023-08-22 21:15:33 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"57"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 57 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 57[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 57[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 108[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 21:15:33 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 3ms (ActiveRecord: 1.0ms | Allocations: 1276)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:17:34.454177', '2023-08-22 12:17:34.454177')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 328 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 328, '2023-08-22 12:17:34.567005', '2023-08-22 12:17:34.567005')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 58 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2zavdb1j51uzjqdd6kuvf2nhhers', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:17:34')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 58, 109, '2023-08-22 12:17:34')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:17:34.576547' WHERE `books`.`id` = 58[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: 2zavdb1j51uzjqdd6kuvf2nhhers (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4d4d26b2-63dd-429f-a6b0-6bdb8cdef707) to Test(default) with arguments: #<GlobalID:0x00007fc32ab9cc98 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/109>>
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 328 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 328, '2023-08-22 12:17:34.588677', '2023-08-22 12:17:34.588677')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 59 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('s9se7kfl8wx6i884t5ckmssigr0v', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:17:34')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 59, 110, '2023-08-22 12:17:34')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:17:34.596423' WHERE `books`.`id` = 59[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: s9se7kfl8wx6i884t5ckmssigr0v (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 930631d6-e9e2-47a3-b8a9-fe38c4538c94) to Test(default) with arguments: #<GlobalID:0x00007fc327b77298 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/110>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 328 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 328, '2023-08-22 12:17:34.604336', '2023-08-22 12:17:34.604336')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 60 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('3zw5lmrqwry3kr5kx57tk8vo76lo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:17:34')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 60, 111, '2023-08-22 12:17:34')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:17:34.610276' WHERE `books`.`id` = 60[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 3zw5lmrqwry3kr5kx57tk8vo76lo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3086be9b-af16-4ac5-ab04-f1faf24241cd) to Test(default) with arguments: #<GlobalID:0x00007fc32a39b170 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/111>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:17:34 +0900
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:17:34.642510', '2023-08-22 12:17:34.642510')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 329 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 329, '2023-08-22 12:17:34.648283', '2023-08-22 12:17:34.648283')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 61 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('f3z8bbdozvkwwuooyz7rc7fbuu0l', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:17:34')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 61, 112, '2023-08-22 12:17:34')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:17:34.654879' WHERE `books`.`id` = 61[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: f3z8bbdozvkwwuooyz7rc7fbuu0l (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8a780648-8408-4638-94ff-a899de50aff0) to Test(default) with arguments: #<GlobalID:0x00007fc326e12378 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/112>>
Started GET "/books/61" for 127.0.0.1 at 2023-08-22 21:17:34 +0900
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 21:17:34 +0900
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:18:53.815213', '2023-08-22 12:18:53.815213')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 330 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 330, '2023-08-22 12:18:53.909183', '2023-08-22 12:18:53.909183')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 62 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ff0rk2pdv4rgodjd3zugrc1s4ycy', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:18:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 62, 113, '2023-08-22 12:18:53')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:18:53.916390' WHERE `books`.`id` = 62[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: ff0rk2pdv4rgodjd3zugrc1s4ycy (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8204f97a-138a-4202-9ff5-0ffdc615a2f4) to Test(default) with arguments: #<GlobalID:0x00007fe27126f880 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/113>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 330 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 330, '2023-08-22 12:18:53.926800', '2023-08-22 12:18:53.926800')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 63 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wjv2y3rex2iqwingnm7ku13502os', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:18:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 63, 114, '2023-08-22 12:18:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:18:53.932749' WHERE `books`.`id` = 63[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: wjv2y3rex2iqwingnm7ku13502os (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a8935615-f356-4fb5-9987-f228ac07ff0c) to Test(default) with arguments: #<GlobalID:0x00007fe2713d95e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/114>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 330 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 330, '2023-08-22 12:18:53.940126', '2023-08-22 12:18:53.940126')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 64 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('c9hg6d39ima7nxb5u9blfpges8c7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:18:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 64, 115, '2023-08-22 12:18:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:18:53.944445' WHERE `books`.`id` = 64[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.5ms) [0m[32mUploaded file to key: c9hg6d39ima7nxb5u9blfpges8c7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5895c438-d57c-43e1-af3b-02e20babf9f2) to Test(default) with arguments: #<GlobalID:0x00007fe270b11548 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/115>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:18:53 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (62, 63, 64)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (62, 63, 64)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (113, 114, 115)[0m
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 10697)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:18:54.001520', '2023-08-22 12:18:54.001520')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 331 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 331, '2023-08-22 12:18:54.007125', '2023-08-22 12:18:54.007125')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 65 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('fdl5wuojb7cbphurt7tz44nz4x8i', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:18:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 65, 116, '2023-08-22 12:18:54')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:18:54.011754' WHERE `books`.`id` = 65[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: fdl5wuojb7cbphurt7tz44nz4x8i (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4dbf8cf4-ab0c-4f9e-965d-ac9ee94423d4) to Test(default) with arguments: #<GlobalID:0x00007fe2768b51b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/116>>
Started GET "/books/65" for 127.0.0.1 at 2023-08-22 21:18:54 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"65"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 65 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 65[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 65[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 116[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 21:18:54 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.9ms | Allocations: 632)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 12:19:05.090583', '2023-08-22 12:19:05.090583')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 332 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 332, '2023-08-22 12:19:05.196765', '2023-08-22 12:19:05.196765')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 66 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7q6tbzlyxtb8j9ynvui7cg9zc5q8', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:19:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 66, 117, '2023-08-22 12:19:05')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:19:05.204569' WHERE `books`.`id` = 66[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 7q6tbzlyxtb8j9ynvui7cg9zc5q8 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b936a984-6f3f-4949-a145-a414d386f536) to Test(default) with arguments: #<GlobalID:0x00007f80ab388dc0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/117>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 332 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 332, '2023-08-22 12:19:05.215464', '2023-08-22 12:19:05.215464')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 67 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('tgp1b8olvswg5b74judds82b0zn0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:19:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 67, 118, '2023-08-22 12:19:05')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:19:05.222207' WHERE `books`.`id` = 67[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: tgp1b8olvswg5b74judds82b0zn0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9f558705-1115-4c15-876a-a2a5c0b15714) to Test(default) with arguments: #<GlobalID:0x00007f80ac65ee18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/118>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 332 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 332, '2023-08-22 12:19:05.232202', '2023-08-22 12:19:05.232202')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 68 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('p76j48rejwld5hk5fomytwsfn1gs', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:19:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 68, 119, '2023-08-22 12:19:05')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:19:05.239084' WHERE `books`.`id` = 68[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: p76j48rejwld5hk5fomytwsfn1gs (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 095f59b3-0d98-4923-b060-a858a4e33bdd) to Test(default) with arguments: #<GlobalID:0x00007f80b0275280 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/119>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 21:19:05 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (66, 67, 68)[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (66, 67, 68)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (117, 118, 119)[0m
Completed 200 OK in 26ms (Views: 0.6ms | ActiveRecord: 4.2ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 12:19:05.308719', '2023-08-22 12:19:05.308719')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 333 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 333, '2023-08-22 12:19:05.314944', '2023-08-22 12:19:05.314944')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 69 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('16wwp9bqkejr2ayc95vwrrwov758', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 12:19:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 69, 120, '2023-08-22 12:19:05')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 12:19:05.320360' WHERE `books`.`id` = 69[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 16wwp9bqkejr2ayc95vwrrwov758 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9761690f-47ae-4b3e-96b7-403a459d62e1) to Test(default) with arguments: #<GlobalID:0x00007f80a7d1b8a0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/120>>
Started GET "/books/69" for 127.0.0.1 at 2023-08-22 21:19:05 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"69"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 69 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 69[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 69[0m
  [1m[36mActiveStorage::Blob Load (1.0ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 120[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.9ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 21:19:05 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:36:22.470209', '2023-08-22 14:36:22.470209')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 334 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 334, '2023-08-22 14:36:22.582052', '2023-08-22 14:36:22.582052')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 70 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('yimy7tznz6m3jcscznxrgc0ysvl0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 70, 121, '2023-08-22 14:36:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:22.590040' WHERE `books`.`id` = 70[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: yimy7tznz6m3jcscznxrgc0ysvl0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3ff198c9-4f33-43ae-94ba-984b0410d9f8) to Test(default) with arguments: #<GlobalID:0x00007fa107c8f190 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/121>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 334 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 334, '2023-08-22 14:36:22.601168', '2023-08-22 14:36:22.601168')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 71 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('upqu1t49bak9xmyrrpd3x38bcy0e', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:22')[0m
  [1m[36mActiveStorage::Attachment Create (1.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 71, 122, '2023-08-22 14:36:22')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:22.609580' WHERE `books`.`id` = 71[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: upqu1t49bak9xmyrrpd3x38bcy0e (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5818851c-aeac-4713-b6c8-ecd3ee1d36d7) to Test(default) with arguments: #<GlobalID:0x00007fa10324ab70 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/122>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 334 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 334, '2023-08-22 14:36:22.618452', '2023-08-22 14:36:22.618452')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 72 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u33yqlgkpw47wuom4xchti2aevni', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 72, 123, '2023-08-22 14:36:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:22.623853' WHERE `books`.`id` = 72[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: u33yqlgkpw47wuom4xchti2aevni (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fa2ec0bf-29a1-4f7d-96e3-a20c35977b89) to Test(default) with arguments: #<GlobalID:0x00007fa1032a7cd0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/123>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:36:22 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (1.1ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (70, 71, 72)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (70, 71, 72)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (121, 122, 123)[0m
Completed 200 OK in 30ms (Views: 0.4ms | ActiveRecord: 3.8ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:36:22.698868', '2023-08-22 14:36:22.698868')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 335 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 335, '2023-08-22 14:36:22.704431', '2023-08-22 14:36:22.704431')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 73 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cahddxw4bm7uraoyzr18mfe8k8p0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 73, 124, '2023-08-22 14:36:22')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:22.709897' WHERE `books`.`id` = 73[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: cahddxw4bm7uraoyzr18mfe8k8p0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b48f25fa-f2a1-45ff-8879-c067dc7776f6) to Test(default) with arguments: #<GlobalID:0x00007fa10c33b828 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/124>>
Started GET "/books/73" for 127.0.0.1 at 2023-08-22 23:36:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"73"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 73 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 73[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 73[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 124[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:36:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.9ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:36:22 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.4ms | Allocations: 518)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:36:43.939439', '2023-08-22 14:36:43.939439')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 336 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 336, '2023-08-22 14:36:44.064379', '2023-08-22 14:36:44.064379')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 74 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('z8djk02r45wrlt0vthlld8lg33fu', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 74, 125, '2023-08-22 14:36:44')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:44.072895' WHERE `books`.`id` = 74[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.9ms) [0m[32mUploaded file to key: z8djk02r45wrlt0vthlld8lg33fu (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bd716c3a-232f-450d-855d-dacb57b67b29) to Test(default) with arguments: #<GlobalID:0x00007ffcbd0b8d28 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/125>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 336 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 336, '2023-08-22 14:36:44.086123', '2023-08-22 14:36:44.086123')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 75 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('dv1025vip45cxmdo5dcjik677bvf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 75, 126, '2023-08-22 14:36:44')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:44.092096' WHERE `books`.`id` = 75[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: dv1025vip45cxmdo5dcjik677bvf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 72c9dd53-1b4b-4943-8972-06da26b85786) to Test(default) with arguments: #<GlobalID:0x00007ffcbd3e98d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/126>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 336 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 336, '2023-08-22 14:36:44.099178', '2023-08-22 14:36:44.099178')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 76 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ilhglcdji1uj2yz3j0m39i21byf8', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 76, 127, '2023-08-22 14:36:44')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:44.104658' WHERE `books`.`id` = 76[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: ilhglcdji1uj2yz3j0m39i21byf8 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b7c69919-9e92-4c07-86de-ed204202f84c) to Test(default) with arguments: #<GlobalID:0x00007ffcb848da48 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/127>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:36:44 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (74, 75, 76)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (74, 75, 76)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (125, 126, 127)[0m
Completed 200 OK in 31ms (Views: 0.4ms | ActiveRecord: 3.2ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:36:44.178370', '2023-08-22 14:36:44.178370')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 337 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 337, '2023-08-22 14:36:44.183290', '2023-08-22 14:36:44.183290')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 77 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2k3bpavalnu8r6smc7np3llbhucn', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:36:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 77, 128, '2023-08-22 14:36:44')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:36:44.188408' WHERE `books`.`id` = 77[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 2k3bpavalnu8r6smc7np3llbhucn (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: aca55693-0984-415d-8b5d-2f9dc66e0591) to Test(default) with arguments: #<GlobalID:0x00007ffcc1224a50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/128>>
Started GET "/books/77" for 127.0.0.1 at 2023-08-22 23:36:44 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"77"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 77 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 77[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 77[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 128[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 1864)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:36:44 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:36:44.227419', '2023-08-22 14:36:44.227419')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:36:44.244237', '2023-08-22 14:36:44.244237')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:36:44 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.5ms | Allocations: 453)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:38:07.845704', '2023-08-22 14:38:07.845704')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 340 LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (10.0ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 340, '2023-08-22 14:38:07.942706', '2023-08-22 14:38:07.942706')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 78 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('nvf291mz1a4de90laehvdb1za9yf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 78, 129, '2023-08-22 14:38:07')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:07.973395' WHERE `books`.`id` = 78[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: nvf291mz1a4de90laehvdb1za9yf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d28b41c5-0edb-4ed0-8309-76f5c5a8d522) to Test(default) with arguments: #<GlobalID:0x00007fc8515184e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/129>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 340 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 340, '2023-08-22 14:38:07.987798', '2023-08-22 14:38:07.987798')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 79 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('h7vjktuxfbe4bo6bhprgo10ye7zo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 79, 130, '2023-08-22 14:38:07')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:07.994715' WHERE `books`.`id` = 79[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: h7vjktuxfbe4bo6bhprgo10ye7zo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 66c80cb4-9e58-4707-9058-cf29a064532e) to Test(default) with arguments: #<GlobalID:0x00007fc8519ebaa8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/130>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 340 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 340, '2023-08-22 14:38:08.002080', '2023-08-22 14:38:08.002080')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 80 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qg5o2wdvmznt3lv997dyakb80pxj', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:08')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 80, 131, '2023-08-22 14:38:08')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:08.007554' WHERE `books`.`id` = 80[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: qg5o2wdvmznt3lv997dyakb80pxj (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e452b58c-149c-42f2-b0cf-c10c6be1f129) to Test(default) with arguments: #<GlobalID:0x00007fc84c58bd00 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/131>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:38:08 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (78, 79, 80)[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (78, 79, 80)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (129, 130, 131)[0m
Completed 200 OK in 30ms (Views: 0.4ms | ActiveRecord: 3.6ms | Allocations: 10694)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:38:08.090844', '2023-08-22 14:38:08.090844')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 341 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 341, '2023-08-22 14:38:08.096645', '2023-08-22 14:38:08.096645')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 81 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('tw3e4tfx3qmcww58rxtmqbgygrvq', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:08')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 81, 132, '2023-08-22 14:38:08')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:08.102410' WHERE `books`.`id` = 81[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: tw3e4tfx3qmcww58rxtmqbgygrvq (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 606d85de-ac4e-460d-a14d-50260a544312) to Test(default) with arguments: #<GlobalID:0x00007fc85025b028 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/132>>
Started GET "/books/81" for 127.0.0.1 at 2023-08-22 23:38:08 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"81"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 81 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 81[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 81[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 132[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 2.6ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:38:08 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:38:08.146186', '2023-08-22 14:38:08.146186')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 342 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 342, '2023-08-22 14:38:08.152417', '2023-08-22 14:38:08.152417')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 82 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('w6qyh3to0fgtkt863zvkk6aek7sg', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:08')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 82, 133, '2023-08-22 14:38:08')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:08.159193' WHERE `books`.`id` = 82[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: w6qyh3to0fgtkt863zvkk6aek7sg (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3d4f9f30-d396-4c43-8416-305722b43725) to Test(default) with arguments: #<GlobalID:0x00007fc85546d910 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/133>>
Started GET "/books/check_existence?id=82" for 127.0.0.1 at 2023-08-22 23:38:08 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"82"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 82 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.6ms | Allocations: 334)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:38:08.178560', '2023-08-22 14:38:08.178560')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 343 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 343, '2023-08-22 14:38:08.183978', '2023-08-22 14:38:08.183978')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 83 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('uedbbv5l95a70qe7k6mhpq8kqqtr', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:08')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 83, 134, '2023-08-22 14:38:08')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:08.189609' WHERE `books`.`id` = 83[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: uedbbv5l95a70qe7k6mhpq8kqqtr (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 62addd15-4fd3-49c1-9a08-5ace3e2763d6) to Test(default) with arguments: #<GlobalID:0x00007fc85083a818 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/134>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:38:08 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:38:31.364374', '2023-08-22 14:38:31.364374')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 344 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 344, '2023-08-22 14:38:31.459988', '2023-08-22 14:38:31.459988')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 84 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('sdfakoc4klsobvwlps9ufcg126tj', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:31')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 84, 135, '2023-08-22 14:38:31')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:31.477628' WHERE `books`.`id` = 84[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: sdfakoc4klsobvwlps9ufcg126tj (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fa58f868-c81e-446e-b2bd-3894b3ef7525) to Test(default) with arguments: #<GlobalID:0x00007ff567464ec0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/135>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 344 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 344, '2023-08-22 14:38:31.487187', '2023-08-22 14:38:31.487187')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 85 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ixn8h54iak5j3ohzt2i7mxfymmmx', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:31')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 85, 136, '2023-08-22 14:38:31')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:31.494963' WHERE `books`.`id` = 85[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: ixn8h54iak5j3ohzt2i7mxfymmmx (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 04afe027-579c-4dce-b564-c19a708daf60) to Test(default) with arguments: #<GlobalID:0x00007ff56818e0b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/136>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 344 LIMIT 1[0m
  [1m[36mBook Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 344, '2023-08-22 14:38:31.503348', '2023-08-22 14:38:31.503348')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 86 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rbefke532ceii1ec9b14eqrmz8w7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:31')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 86, 137, '2023-08-22 14:38:31')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:31.509883' WHERE `books`.`id` = 86[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: rbefke532ceii1ec9b14eqrmz8w7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ae36b60d-68f7-4b7b-9085-d6adc5c329ce) to Test(default) with arguments: #<GlobalID:0x00007ff568a9ac30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/137>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:38:31 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (84, 85, 86)[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (84, 85, 86)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (135, 136, 137)[0m
Completed 200 OK in 24ms (Views: 0.9ms | ActiveRecord: 4.0ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:38:31.572850', '2023-08-22 14:38:31.572850')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 345 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 345, '2023-08-22 14:38:31.580409', '2023-08-22 14:38:31.580409')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 87 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('y0r2chel9w3s7y4jzjuelng8vr29', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:31')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 87, 138, '2023-08-22 14:38:31')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:31.586939' WHERE `books`.`id` = 87[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: y0r2chel9w3s7y4jzjuelng8vr29 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: edd2ebff-2c27-4f7d-beb3-71a73e44aeeb) to Test(default) with arguments: #<GlobalID:0x00007ff568e980d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/138>>
Started GET "/books/87" for 127.0.0.1 at 2023-08-22 23:38:31 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"87"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 87 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 87[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 87[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 138[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:38:31 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:38:31.629686', '2023-08-22 14:38:31.629686')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 346 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 346, '2023-08-22 14:38:31.637240', '2023-08-22 14:38:31.637240')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 88 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('hvdtzdd7sle9txw1xatmh8nszps2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:31')[0m
  [1m[36mActiveStorage::Attachment Create (1.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 88, 139, '2023-08-22 14:38:31')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:31.647521' WHERE `books`.`id` = 88[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: hvdtzdd7sle9txw1xatmh8nszps2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1a8870f4-8dc6-4b8e-bcc8-e340c2adc260) to Test(default) with arguments: #<GlobalID:0x00007ff567666ac0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/139>>
Started GET "/books/check_existence?id=88" for 127.0.0.1 at 2023-08-22 23:38:31 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"88"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 88 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:38:31.670029', '2023-08-22 14:38:31.670029')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 347 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 347, '2023-08-22 14:38:31.676033', '2023-08-22 14:38:31.676033')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 89 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ue949dis7mgreuyttc57jjftyc40', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:38:31')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 89, 140, '2023-08-22 14:38:31')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:38:31.683663' WHERE `books`.`id` = 89[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: ue949dis7mgreuyttc57jjftyc40 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 45ff8552-be3e-4fb7-9cd9-97886e3809ff) to Test(default) with arguments: #<GlobalID:0x00007ff56c84fc88 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/140>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:38:31 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:50:27.201357', '2023-08-22 14:50:27.201357')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 348 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 348, '2023-08-22 14:50:27.319863', '2023-08-22 14:50:27.319863')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 90 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('t6nseb2kz1ymupjaswpngb3w1m4e', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 90, 141, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.327960' WHERE `books`.`id` = 90[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: t6nseb2kz1ymupjaswpngb3w1m4e (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3c34654e-603a-4777-8a04-564489b99198) to Test(default) with arguments: #<GlobalID:0x00007fdd195d9460 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/141>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 348 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 348, '2023-08-22 14:50:27.339678', '2023-08-22 14:50:27.339678')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 91 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mnfyjnmz4j6bw0kndwity01hyu13', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 91, 142, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.347035' WHERE `books`.`id` = 91[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: mnfyjnmz4j6bw0kndwity01hyu13 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: dd029f14-2c25-4b1e-bf00-74e0af64955f) to Test(default) with arguments: #<GlobalID:0x00007fdd195e8118 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/142>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 348 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 348, '2023-08-22 14:50:27.356162', '2023-08-22 14:50:27.356162')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 92 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xhobbz0usafvrxld5zwzbuco88dq', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 92, 143, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.362248' WHERE `books`.`id` = 92[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: xhobbz0usafvrxld5zwzbuco88dq (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0fcfb931-dc65-4b7e-817a-a418e4bf3ebb) to Test(default) with arguments: #<GlobalID:0x00007fdd1ac5b558 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/143>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:50:27 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (90, 91, 92)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (90, 91, 92)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (141, 142, 143)[0m
Completed 200 OK in 30ms (Views: 0.6ms | ActiveRecord: 3.3ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:50:27.440356', '2023-08-22 14:50:27.440356')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 349 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 349, '2023-08-22 14:50:27.445433', '2023-08-22 14:50:27.445433')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 93 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7cc1hd9iun4ygw21d6h0i3lxio47', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 93, 144, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.451194' WHERE `books`.`id` = 93[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 7cc1hd9iun4ygw21d6h0i3lxio47 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 62c85597-ffb9-4445-b57f-c07e092a9f0a) to Test(default) with arguments: #<GlobalID:0x00007fdd22432ec8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/144>>
Started GET "/books/93" for 127.0.0.1 at 2023-08-22 23:50:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"93"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 93 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 93[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 93[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 144[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 1865)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:50:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.9ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:50:27.488995', '2023-08-22 14:50:27.488995')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 350 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 350, '2023-08-22 14:50:27.495325', '2023-08-22 14:50:27.495325')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 94 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u6og5ztihy15mzhw3r0euo6nalkt', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 94, 145, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.500614' WHERE `books`.`id` = 94[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: u6og5ztihy15mzhw3r0euo6nalkt (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 232abbda-c955-4632-8061-51df99ab08bf) to Test(default) with arguments: #<GlobalID:0x00007fdd1b3ad838 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/145>>
Started GET "/books/check_existence?id=94" for 127.0.0.1 at 2023-08-22 23:50:27 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"94"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 94 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.8ms | Allocations: 334)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:50:27.521203', '2023-08-22 14:50:27.521203')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 351 LIMIT 1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 351, '2023-08-22 14:50:27.528242', '2023-08-22 14:50:27.528242')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 95 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('byybwcpswdsp4tb7n8gcg4gkd7ni', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 95, 146, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.534744' WHERE `books`.`id` = 95[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: byybwcpswdsp4tb7n8gcg4gkd7ni (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bee373d6-ad41-490c-8028-fe6f2f8d3ea6) to Test(default) with arguments: #<GlobalID:0x00007fdd224aa7e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/146>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:50:27 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 14:50:27.564070', '2023-08-22 14:50:27.564070')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-22 23:50:27 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fdd1afc6d28 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230822-8530-bteyu1.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"352"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 352 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 352, '2023-08-22 14:50:27.594853', '2023-08-22 14:50:27.594853', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 96 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('om7ni8p2pevx2tgk4xneu077bkfp', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:50:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 96, 147, '2023-08-22 14:50:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:50:27.601556' WHERE `books`.`id` = 96[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: om7ni8p2pevx2tgk4xneu077bkfp (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 601ba548-13af-4c20-a8a7-edc28d963a3a) to Test(default) with arguments: #<GlobalID:0x00007fdd224e9ec0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/147>>
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 3.5ms | Allocations: 4251)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:53:27.095290', '2023-08-22 14:53:27.095290')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 353 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 353, '2023-08-22 14:53:27.214764', '2023-08-22 14:53:27.214764')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 97 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('damu0agu1biunozu1wj70tvqb3nv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 97, 148, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.223556' WHERE `books`.`id` = 97[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: damu0agu1biunozu1wj70tvqb3nv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e7b5d95f-0f4f-4c66-85ca-cbebbb517c8c) to Test(default) with arguments: #<GlobalID:0x00007f99f84bd018 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/148>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 353 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 353, '2023-08-22 14:53:27.234656', '2023-08-22 14:53:27.234656')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 98 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mgg3rj0szim1xkdzgqmoo7tvgoa1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 98, 149, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.241323' WHERE `books`.`id` = 98[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: mgg3rj0szim1xkdzgqmoo7tvgoa1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e3d53d98-d114-4a19-a70d-f1976ccdf5a5) to Test(default) with arguments: #<GlobalID:0x00007f99f5420180 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/149>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 353 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 353, '2023-08-22 14:53:27.248490', '2023-08-22 14:53:27.248490')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 99 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kc0bp28jpl0sjibtj9c66c4z8z05', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 99, 150, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.254061' WHERE `books`.`id` = 99[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: kc0bp28jpl0sjibtj9c66c4z8z05 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e950b09e-456d-4619-9055-ea69be5b8a89) to Test(default) with arguments: #<GlobalID:0x00007f99f8b3db68 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/150>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:53:27 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (97, 98, 99)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (97, 98, 99)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (148, 149, 150)[0m
Completed 200 OK in 29ms (Views: 0.4ms | ActiveRecord: 2.7ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:53:27.327338', '2023-08-22 14:53:27.327338')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 354 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 354, '2023-08-22 14:53:27.332854', '2023-08-22 14:53:27.332854')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 100 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gkqa501ekvg0sucr0k99p4v5pmo6', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 100, 151, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.341018' WHERE `books`.`id` = 100[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: gkqa501ekvg0sucr0k99p4v5pmo6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 42715141-b7ef-4d7a-b2bf-b2941038b7e8) to Test(default) with arguments: #<GlobalID:0x00007f99f934b8c8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/151>>
Started GET "/books/100" for 127.0.0.1 at 2023-08-22 23:53:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"100"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 100 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 100[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 100[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 151[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:53:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.0ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:53:27.383751', '2023-08-22 14:53:27.383751')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 355 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 355, '2023-08-22 14:53:27.389183', '2023-08-22 14:53:27.389183')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 101 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('baew1b9pejbkjkvoonaf06p6f73g', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 101, 152, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (1.0ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.395605' WHERE `books`.`id` = 101[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: baew1b9pejbkjkvoonaf06p6f73g (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 49be43ec-d7ce-432b-8c15-5cf03462d928) to Test(default) with arguments: #<GlobalID:0x00007f99f572e368 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/152>>
Started GET "/books/check_existence?id=101" for 127.0.0.1 at 2023-08-22 23:53:27 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"101"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 101 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:53:27.418613', '2023-08-22 14:53:27.418613')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 356 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 356, '2023-08-22 14:53:27.426343', '2023-08-22 14:53:27.426343')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 102 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('s08a0dzm7fxbwcopj3bo2pi5tfhv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 102, 153, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.433018' WHERE `books`.`id` = 102[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: s08a0dzm7fxbwcopj3bo2pi5tfhv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bb836507-ea03-4058-bb32-9b98d6adb219) to Test(default) with arguments: #<GlobalID:0x00007f99f93bb240 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/153>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:53:27 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 14:53:27.458085', '2023-08-22 14:53:27.458085')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-22 23:53:27 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f99f8d437f0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230822-8668-xobiq4.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"357"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 357 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 357, '2023-08-22 14:53:27.484374', '2023-08-22 14:53:27.484374', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 103 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('3974igj167gegm3nkwrgpkuel8p1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:53:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 103, 154, '2023-08-22 14:53:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:53:27.491908' WHERE `books`.`id` = 103[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 3974igj167gegm3nkwrgpkuel8p1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8a01d199-ee31-46fc-98a4-12f0f4f38e32) to Test(default) with arguments: #<GlobalID:0x00007f99fe39a928 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/154>>
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 4.0ms | Allocations: 4252)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:56:23.590056', '2023-08-22 14:56:23.590056')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 358 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 358, '2023-08-22 14:56:23.707123', '2023-08-22 14:56:23.707123')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 104 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qkh2utr6powg36j77f4juc5ojdow', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 104, 155, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.715536' WHERE `books`.`id` = 104[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: qkh2utr6powg36j77f4juc5ojdow (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ce8674e9-5eb8-41cc-88a7-a62d91fbf5da) to Test(default) with arguments: #<GlobalID:0x00007fde990ff990 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/155>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 358 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 358, '2023-08-22 14:56:23.727461', '2023-08-22 14:56:23.727461')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 105 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('x3iawxjl5yerex0zhyk5k3pjjyns', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 105, 156, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.735168' WHERE `books`.`id` = 105[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: x3iawxjl5yerex0zhyk5k3pjjyns (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ddff3531-ae71-4991-b8c1-9d38b27a0009) to Test(default) with arguments: #<GlobalID:0x00007fde99718890 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/156>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 358 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 358, '2023-08-22 14:56:23.742908', '2023-08-22 14:56:23.742908')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 106 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kxzlhedlcne97nkgdhlti5lnjcsb', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 106, 157, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.748269' WHERE `books`.`id` = 106[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: kxzlhedlcne97nkgdhlti5lnjcsb (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f543a4a0-ce1b-4a72-b723-ab1c974cba86) to Test(default) with arguments: #<GlobalID:0x00007fde9d2d0f18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/157>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:56:23 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (104, 105, 106)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (104, 105, 106)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (155, 156, 157)[0m
Completed 200 OK in 28ms (Views: 0.4ms | ActiveRecord: 2.8ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:56:23.822351', '2023-08-22 14:56:23.822351')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 359 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 359, '2023-08-22 14:56:23.827331', '2023-08-22 14:56:23.827331')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 107 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('blzf8wejaoqbaky9ly0ydoon4p5v', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 107, 158, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.832864' WHERE `books`.`id` = 107[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: blzf8wejaoqbaky9ly0ydoon4p5v (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0d122552-11d4-4aa9-99f3-eda8e9f7b05a) to Test(default) with arguments: #<GlobalID:0x00007fdea15811f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/158>>
Started GET "/books/107" for 127.0.0.1 at 2023-08-22 23:56:23 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"107"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 107 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 107[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 107[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 158[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:56:23 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.2ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:56:23.871707', '2023-08-22 14:56:23.871707')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 360 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 360, '2023-08-22 14:56:23.878811', '2023-08-22 14:56:23.878811')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 108 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('f65z06yjtm185a3iy8kriyvw5hgk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 108, 159, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.883817' WHERE `books`.`id` = 108[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: f65z06yjtm185a3iy8kriyvw5hgk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7a8b4d9e-c7b1-4325-a39e-c6d9c35c618e) to Test(default) with arguments: #<GlobalID:0x00007fde9d84ba38 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/159>>
Started GET "/books/check_existence?id=108" for 127.0.0.1 at 2023-08-22 23:56:23 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"108"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 108 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:56:23.904366', '2023-08-22 14:56:23.904366')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 361 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 361, '2023-08-22 14:56:23.910694', '2023-08-22 14:56:23.910694')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 109 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('zc2ctaazk754se892n12syesao9v', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 109, 160, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.916614' WHERE `books`.`id` = 109[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: zc2ctaazk754se892n12syesao9v (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b7ef0c0e-ea35-4768-80bd-7172459fc617) to Test(default) with arguments: #<GlobalID:0x00007fde98c509a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/160>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:56:23 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 14:56:23.939801', '2023-08-22 14:56:23.939801')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-22 23:56:23 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fdea1628ec8 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230822-8798-dsvb20.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"362"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 362 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 362, '2023-08-22 14:56:23.962242', '2023-08-22 14:56:23.962242', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 110 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pdz5byk0szjfappcvhc3h22vxuuk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:56:23')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 110, 161, '2023-08-22 14:56:23')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:56:23.969252' WHERE `books`.`id` = 110[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: pdz5byk0szjfappcvhc3h22vxuuk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5583a957-82a5-47a8-a416-ba357a1e5183) to Test(default) with arguments: #<GlobalID:0x00007fde9d520048 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/161>>
Completed 200 OK in 18ms (Views: 0.4ms | ActiveRecord: 3.7ms | Allocations: 4252)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 14:57:22.106458', '2023-08-22 14:57:22.106458')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 363 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 363, '2023-08-22 14:57:22.225909', '2023-08-22 14:57:22.225909')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 111 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('vm2ud9ou5kb4vfq4e59ziwdlu96y', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 111, 162, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.235042' WHERE `books`.`id` = 111[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: vm2ud9ou5kb4vfq4e59ziwdlu96y (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c3e328c0-19fa-471c-93b2-fc8e4e620001) to Test(default) with arguments: #<GlobalID:0x00007f980c352c20 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/162>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 363 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 363, '2023-08-22 14:57:22.248011', '2023-08-22 14:57:22.248011')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 112 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('1x9ictcq1otk929pgoq0u4gmmt1e', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 112, 163, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.254848' WHERE `books`.`id` = 112[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 1x9ictcq1otk929pgoq0u4gmmt1e (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7eb21608-2747-454d-915c-e065b758835d) to Test(default) with arguments: #<GlobalID:0x00007f980c4f0370 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/163>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 363 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 363, '2023-08-22 14:57:22.263652', '2023-08-22 14:57:22.263652')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 113 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('iei4gxr2vr4bln3yqofu7nefqkel', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 113, 164, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.269947' WHERE `books`.`id` = 113[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: iei4gxr2vr4bln3yqofu7nefqkel (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 27256384-84c6-4b6a-b5d6-bc17e7c9c843) to Test(default) with arguments: #<GlobalID:0x00007f980c510a58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/164>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-22 23:57:22 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (111, 112, 113)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (111, 112, 113)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (162, 163, 164)[0m
Completed 200 OK in 31ms (Views: 0.4ms | ActiveRecord: 2.7ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 14:57:22.347913', '2023-08-22 14:57:22.347913')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 364 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 364, '2023-08-22 14:57:22.352958', '2023-08-22 14:57:22.352958')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 114 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('g73uka020atk0jorj5fe3ajh6jcv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 114, 165, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.358332' WHERE `books`.`id` = 114[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: g73uka020atk0jorj5fe3ajh6jcv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: cddf4ff1-88d7-414f-952a-4e70c78f6d6d) to Test(default) with arguments: #<GlobalID:0x00007f9807c62db0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/165>>
Started GET "/books/114" for 127.0.0.1 at 2023-08-22 23:57:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"114"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 114 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 114[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 114[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 165[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-22 23:57:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 14:57:22.399338', '2023-08-22 14:57:22.399338')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 365 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 365, '2023-08-22 14:57:22.404816', '2023-08-22 14:57:22.404816')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 115 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('yz024xlz1a33a9mw9islk0j5r4sv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 115, 166, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.410455' WHERE `books`.`id` = 115[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: yz024xlz1a33a9mw9islk0j5r4sv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ce82f917-6d44-41ce-aac2-9faf68199927) to Test(default) with arguments: #<GlobalID:0x00007f9807cb1758 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/166>>
Started GET "/books/check_existence?id=115" for 127.0.0.1 at 2023-08-22 23:57:22 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"115"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 115 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 14:57:22.430447', '2023-08-22 14:57:22.430447')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 366 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 366, '2023-08-22 14:57:22.436489', '2023-08-22 14:57:22.436489')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 116 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xc7t7nr92h69xqezgl4mchrxkod9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 116, 167, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.443589' WHERE `books`.`id` = 116[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: xc7t7nr92h69xqezgl4mchrxkod9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d272eb1d-3831-4f3c-850e-ae2cfda06c4f) to Test(default) with arguments: #<GlobalID:0x00007f981097a5b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/167>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-22 23:57:22 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 14:57:22.468075', '2023-08-22 14:57:22.468075')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-22 23:57:22 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f980bfa6b08 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230822-8838-xsq9pn.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"367"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 367 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 367, '2023-08-22 14:57:22.492422', '2023-08-22 14:57:22.492422', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 117 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('lseuwu162rmloo6naw5r6618jjwo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 14:57:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 117, 168, '2023-08-22 14:57:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 14:57:22.498338' WHERE `books`.`id` = 117[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: lseuwu162rmloo6naw5r6618jjwo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: cf42da8d-380c-457b-8fb0-a7a9f0e01f5c) to Test(default) with arguments: #<GlobalID:0x00007f980957dc28 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/168>>
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 3.4ms | Allocations: 4254)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:01:06.366711', '2023-08-22 15:01:06.366711')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 368 LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 368, '2023-08-22 15:01:06.491121', '2023-08-22 15:01:06.491121')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 118 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('m52a0s5zutc09lmg88fv3aq7s2gd', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 118, 169, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.498974' WHERE `books`.`id` = 118[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: m52a0s5zutc09lmg88fv3aq7s2gd (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b1be0a9a-a1b2-49b1-a033-0f3141bcc824) to Test(default) with arguments: #<GlobalID:0x00007ffaa2da0e18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/169>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 368 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 368, '2023-08-22 15:01:06.512737', '2023-08-22 15:01:06.512737')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 119 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('neksbwdu2j89a8jtprp0qgm5lnkg', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 119, 170, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.519822' WHERE `books`.`id` = 119[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: neksbwdu2j89a8jtprp0qgm5lnkg (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d9caa092-0314-4349-b5bf-a0c358487e19) to Test(default) with arguments: #<GlobalID:0x00007ffaa325b728 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/170>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 368 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 368, '2023-08-22 15:01:06.526970', '2023-08-22 15:01:06.526970')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 120 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0am43d70ezo17zvgxxyzc86p1b3z', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 120, 171, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.533291' WHERE `books`.`id` = 120[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: 0am43d70ezo17zvgxxyzc86p1b3z (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 90ac170e-4fc6-4306-97b6-30d251d82d7b) to Test(default) with arguments: #<GlobalID:0x00007ffaa2f0da58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/171>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:01:06 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (118, 119, 120)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (118, 119, 120)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (169, 170, 171)[0m
Completed 200 OK in 29ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:01:06.609078', '2023-08-22 15:01:06.609078')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 369 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 369, '2023-08-22 15:01:06.615187', '2023-08-22 15:01:06.615187')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 121 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5gh5msoypkn5a5zamcw14ij038xe', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 121, 172, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.621876' WHERE `books`.`id` = 121[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 5gh5msoypkn5a5zamcw14ij038xe (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 008462f5-1562-4b1b-a234-57cfb1c54732) to Test(default) with arguments: #<GlobalID:0x00007ffaa3392f10 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/172>>
Started GET "/books/121" for 127.0.0.1 at 2023-08-23 00:01:06 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"121"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 121 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 121[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 121[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 172[0m
Completed 200 OK in 11ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:01:06 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 4ms (ActiveRecord: 1.0ms | Allocations: 671)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:01:06.666931', '2023-08-22 15:01:06.666931')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 370 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 370, '2023-08-22 15:01:06.672955', '2023-08-22 15:01:06.672955')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 122 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xizhgwsa050s2whblovhyomr6vg8', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 122, 173, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.679243' WHERE `books`.`id` = 122[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: xizhgwsa050s2whblovhyomr6vg8 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d2d35333-ce9c-40ac-9958-769c2e3a79da) to Test(default) with arguments: #<GlobalID:0x00007ffaa6ec1a28 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/173>>
Started GET "/books/check_existence?id=122" for 127.0.0.1 at 2023-08-23 00:01:06 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"122"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 122 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:01:06.699371', '2023-08-22 15:01:06.699371')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 371 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 371, '2023-08-22 15:01:06.705009', '2023-08-22 15:01:06.705009')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 123 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('o9qntk323154dolx3rf4wln2q6sm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 123, 174, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.711235' WHERE `books`.`id` = 123[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: o9qntk323154dolx3rf4wln2q6sm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 11d2e9d1-00cd-4106-8bda-7f24bd25ab25) to Test(default) with arguments: #<GlobalID:0x00007ffaa34028b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/174>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:01:06 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:01:06.734825', '2023-08-22 15:01:06.734825')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:01:06 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007ffaa343adc8 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-8968-fvvr50.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"372"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 372 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 372, '2023-08-22 15:01:06.759999', '2023-08-22 15:01:06.759999', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 124 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('m399tl4zr07wo0ed3apt6a1niwjo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 124, 175, '2023-08-22 15:01:06')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:06.767947' WHERE `books`.`id` = 124[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (5.7ms) [0m[32mUploaded file to key: m399tl4zr07wo0ed3apt6a1niwjo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e6b9f7fb-d4c6-478d-b731-a412ab994098) to Test(default) with arguments: #<GlobalID:0x00007ffaabd2e008 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/175>>
Completed 200 OK in 23ms (Views: 0.4ms | ActiveRecord: 3.7ms | Allocations: 4247)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:01:27.391321', '2023-08-22 15:01:27.391321')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 373 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 373, '2023-08-22 15:01:27.496954', '2023-08-22 15:01:27.496954')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 125 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('8u5kdofisl8sv94kvfjlu6i8qdi0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 125, 176, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.506256' WHERE `books`.`id` = 125[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 8u5kdofisl8sv94kvfjlu6i8qdi0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 870d10f0-970b-446a-b30d-3c66dcaf67af) to Test(default) with arguments: #<GlobalID:0x00007ffd05868120 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/176>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 373 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 373, '2023-08-22 15:01:27.515844', '2023-08-22 15:01:27.515844')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 126 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('bw7raro290ol8wcqqbsvkqa3fiu4', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 126, 177, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.521375' WHERE `books`.`id` = 126[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: bw7raro290ol8wcqqbsvkqa3fiu4 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ebc2b81a-2f21-4ae8-80fb-6b33b442426f) to Test(default) with arguments: #<GlobalID:0x00007ffd08c2ac60 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/177>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 373 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 373, '2023-08-22 15:01:27.528405', '2023-08-22 15:01:27.528405')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 127 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ubdn3o2969y200zo1zj1lkcdhiuf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 127, 178, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.533616' WHERE `books`.`id` = 127[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: ubdn3o2969y200zo1zj1lkcdhiuf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 683afa55-f471-4c88-af44-9e9b95f5533b) to Test(default) with arguments: #<GlobalID:0x00007ffd042c2398 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/178>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (125, 126, 127)[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (125, 126, 127)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (176, 177, 178)[0m
Completed 200 OK in 25ms (Views: 0.4ms | ActiveRecord: 3.4ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:01:27.598589', '2023-08-22 15:01:27.598589')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 374 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 374, '2023-08-22 15:01:27.605167', '2023-08-22 15:01:27.605167')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 128 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('6gccn842cqlt6lafp5r8jythq6gh', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 128, 179, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.611512' WHERE `books`.`id` = 128[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 6gccn842cqlt6lafp5r8jythq6gh (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 79f60116-d237-4222-93a5-85d16f0c0703) to Test(default) with arguments: #<GlobalID:0x00007ffd08ce6e88 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/179>>
Started GET "/books/128" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"128"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 128 LIMIT 1[0m
  [1m[36mReview Load (0.7ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 128[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 128[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 179[0m
Completed 200 OK in 11ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:01:27.657568', '2023-08-22 15:01:27.657568')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 375 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 375, '2023-08-22 15:01:27.664321', '2023-08-22 15:01:27.664321')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 129 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('j2ckwcrlu711wqna1gnw2efymzr9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 129, 180, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.670053' WHERE `books`.`id` = 129[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: j2ckwcrlu711wqna1gnw2efymzr9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5ed176a4-6f97-45d4-8c3e-34a0abc91cc7) to Test(default) with arguments: #<GlobalID:0x00007ffd046c5788 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/180>>
Started GET "/books/check_existence?id=129" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"129"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 129 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:01:27.688707', '2023-08-22 15:01:27.688707')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 376 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 376, '2023-08-22 15:01:27.693635', '2023-08-22 15:01:27.693635')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 130 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0plksrd50gos3mviru2k1eyqigst', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 130, 181, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.700203' WHERE `books`.`id` = 130[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 0plksrd50gos3mviru2k1eyqigst (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5679f907-ba1d-428b-804f-3069ffc006ce) to Test(default) with arguments: #<GlobalID:0x00007ffd0867e5a0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/181>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:01:27.720623', '2023-08-22 15:01:27.720623')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007ffd04706b20 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9002-quovyc.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"377"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 377 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 377, '2023-08-22 15:01:27.739181', '2023-08-22 15:01:27.739181', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 131 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('svzgq2tbptjoe4aenuemykvfvaj3', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 131, 182, '2023-08-22 15:01:27')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:27.743989' WHERE `books`.`id` = 131[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: svzgq2tbptjoe4aenuemykvfvaj3 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: abda8f9c-5a34-42fb-9406-e8fb82874b2c) to Test(default) with arguments: #<GlobalID:0x00007ffd0d169c40 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/182>>
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 4251)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/131" for 127.0.0.1 at 2023-08-23 00:01:27 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"131"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 131 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 131[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 131[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 182[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:01:44.002539', '2023-08-22 15:01:44.002539')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 378 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 378, '2023-08-22 15:01:44.109534', '2023-08-22 15:01:44.109534')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 132 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('g27qhamo6w586mqkwvva5d4cg5ry', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 132, 183, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.117079' WHERE `books`.`id` = 132[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: g27qhamo6w586mqkwvva5d4cg5ry (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6a51a7c3-806e-4222-882b-9b3caa939ef4) to Test(default) with arguments: #<GlobalID:0x00007fee74fb6e08 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/183>>
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 378 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 378, '2023-08-22 15:01:44.126567', '2023-08-22 15:01:44.126567')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 133 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gb3pzhgy5toav25mc0w2ebqzdnee', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 133, 184, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.133330' WHERE `books`.`id` = 133[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: gb3pzhgy5toav25mc0w2ebqzdnee (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1bdf5f50-5bdb-4569-ba6d-f472130ea73f) to Test(default) with arguments: #<GlobalID:0x00007fee7b818ed8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/184>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 378 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 378, '2023-08-22 15:01:44.140980', '2023-08-22 15:01:44.140980')[0m
  [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 134 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('vmd6emljbafrmvk2gke617q37krl', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 134, 185, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.148462' WHERE `books`.`id` = 134[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: vmd6emljbafrmvk2gke617q37krl (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4c8d724e-136a-46a6-9014-4d37c4bd94b3) to Test(default) with arguments: #<GlobalID:0x00007fee744e3508 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/185>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (132, 133, 134)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (132, 133, 134)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (183, 184, 185)[0m
Completed 200 OK in 23ms (Views: 0.4ms | ActiveRecord: 3.4ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:01:44.208847', '2023-08-22 15:01:44.208847')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 379 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 379, '2023-08-22 15:01:44.215313', '2023-08-22 15:01:44.215313')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 135 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('8vqb5hpj249fnuytjybb3kifu0f1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 135, 186, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.221732' WHERE `books`.`id` = 135[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 8vqb5hpj249fnuytjybb3kifu0f1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 34d75382-d3db-4df9-b931-561be16faea7) to Test(default) with arguments: #<GlobalID:0x00007fee727ed160 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/186>>
Started GET "/books/135" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"135"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 135 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 135[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 135[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 186[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:01:44.260353', '2023-08-22 15:01:44.260353')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 380 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 380, '2023-08-22 15:01:44.266656', '2023-08-22 15:01:44.266656')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 136 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('z61qmhwsgbq8cg3f5npyi4g8h4u1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 136, 187, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.273018' WHERE `books`.`id` = 136[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: z61qmhwsgbq8cg3f5npyi4g8h4u1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: cecebe40-03a0-4871-8020-c7b8a7fb9ac1) to Test(default) with arguments: #<GlobalID:0x00007fee74ffb5d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/187>>
Started GET "/books/check_existence?id=136" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"136"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 136 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:01:44.295646', '2023-08-22 15:01:44.295646')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 381 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 381, '2023-08-22 15:01:44.302370', '2023-08-22 15:01:44.302370')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 137 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('23xjrn5x6pn3r60eqjc9iretk0ix', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 137, 188, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.308898' WHERE `books`.`id` = 137[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 23xjrn5x6pn3r60eqjc9iretk0ix (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 47490336-6031-42f5-beaa-3de321968bb6) to Test(default) with arguments: #<GlobalID:0x00007fee7b8444e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/188>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:01:44.331234', '2023-08-22 15:01:44.331234')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fee7b898a20 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9034-x5p7lp.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"382"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 382 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 382, '2023-08-22 15:01:44.353399', '2023-08-22 15:01:44.353399', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 138 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9wxf3nan4ufd7p3tvofxzdwepltz', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:01:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 138, 189, '2023-08-22 15:01:44')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:01:44.360189' WHERE `books`.`id` = 138[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 9wxf3nan4ufd7p3tvofxzdwepltz (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e70484de-5c2b-4b58-a51a-bde64f7b4714) to Test(default) with arguments: #<GlobalID:0x00007fee7d83fb58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/189>>
Completed 200 OK in 18ms (Views: 0.4ms | ActiveRecord: 3.6ms | Allocations: 4251)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/138" for 127.0.0.1 at 2023-08-23 00:01:44 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"138"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 138 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 138[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 138[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 189[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1736)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:05:21.828394', '2023-08-22 15:05:21.828394')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 383 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 383, '2023-08-22 15:05:21.940415', '2023-08-22 15:05:21.940415')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 139 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rq6nkcrtzsgx0mbhrbbq0xo1nlh7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 139, 190, '2023-08-22 15:05:21')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:21.949561' WHERE `books`.`id` = 139[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.9ms) [0m[32mUploaded file to key: rq6nkcrtzsgx0mbhrbbq0xo1nlh7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b0c0b1d5-1f2d-4278-b23a-5e4b458d1938) to Test(default) with arguments: #<GlobalID:0x00007ff400082e00 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/190>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 383 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 383, '2023-08-22 15:05:21.963014', '2023-08-22 15:05:21.963014')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 140 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('estnvyd5z66t95s5dy8les7me20h', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 140, 191, '2023-08-22 15:05:21')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:21.969641' WHERE `books`.`id` = 140[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: estnvyd5z66t95s5dy8les7me20h (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a7991da4-c873-4b39-9553-57d7923e873c) to Test(default) with arguments: #<GlobalID:0x00007ff40057f8e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/191>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 383 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 383, '2023-08-22 15:05:21.977115', '2023-08-22 15:05:21.977115')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 141 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('llssx8580oorkq3y9xhu63rq5xej', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 141, 192, '2023-08-22 15:05:21')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:21.982313' WHERE `books`.`id` = 141[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: llssx8580oorkq3y9xhu63rq5xej (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 51244cb1-497d-48aa-ab61-1c47e862cbae) to Test(default) with arguments: #<GlobalID:0x00007ff4007431e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/192>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:05:21 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (139, 140, 141)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (139, 140, 141)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (190, 191, 192)[0m
Completed 200 OK in 30ms (Views: 0.4ms | ActiveRecord: 3.3ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:05:22.056417', '2023-08-22 15:05:22.056417')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 384 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 384, '2023-08-22 15:05:22.061841', '2023-08-22 15:05:22.061841')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 142 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('a8797cucmxog5p1icv0bergpnbjx', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 142, 193, '2023-08-22 15:05:22')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:22.066672' WHERE `books`.`id` = 142[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: a8797cucmxog5p1icv0bergpnbjx (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 12b52d77-a815-461b-bd23-8384fda14ef5) to Test(default) with arguments: #<GlobalID:0x00007ff400845a20 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/193>>
Started GET "/books/142" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"142"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 142 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 142[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 142[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 193[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 1.0ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:05:22.103474', '2023-08-22 15:05:22.103474')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 385 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 385, '2023-08-22 15:05:22.109797', '2023-08-22 15:05:22.109797')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 143 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qxxxh7p3qynnoll7hrjchn0keniy', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 143, 194, '2023-08-22 15:05:22')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:22.114771' WHERE `books`.`id` = 143[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: qxxxh7p3qynnoll7hrjchn0keniy (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: dd5086a7-ad22-4395-8aa7-2a2d588c9f9a) to Test(default) with arguments: #<GlobalID:0x00007ff3fc510390 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/194>>
Started GET "/books/check_existence?id=143" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"143"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 143 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (3.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:05:22.135524', '2023-08-22 15:05:22.135524')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 386 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 386, '2023-08-22 15:05:22.140691', '2023-08-22 15:05:22.140691')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 144 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('oc26uy93y69a7dlf4batjqn90qwk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 144, 195, '2023-08-22 15:05:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:22.146087' WHERE `books`.`id` = 144[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: oc26uy93y69a7dlf4batjqn90qwk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0efd2117-049d-48f7-aec0-9abc54a37700) to Test(default) with arguments: #<GlobalID:0x00007ff3fded11d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/195>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:05:22.166849', '2023-08-22 15:05:22.166849')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007ff40546d6f0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9250-uwzfdc.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"387"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 387 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 387, '2023-08-22 15:05:22.186293', '2023-08-22 15:05:22.186293', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 145 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('zkdwgsftz12rhzdlmpzgufh5i1h3', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 145, 196, '2023-08-22 15:05:22')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:22.192924' WHERE `books`.`id` = 145[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: zkdwgsftz12rhzdlmpzgufh5i1h3 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d4e92a56-528b-48a7-94c7-aadc61583373) to Test(default) with arguments: #<GlobalID:0x00007ff401374888 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/196>>
Completed 200 OK in 15ms (Views: 0.5ms | ActiveRecord: 3.3ms | Allocations: 4251)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/145" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"145"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 145 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 145[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 145[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 196[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:05:22.221033', '2023-08-22 15:05:22.221033')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:05:22 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"388"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 388 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 388, '2023-08-22 15:05:22.234689', '2023-08-22 15:05:22.234689', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 146 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 146 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('m5ko73ld9o9n3dkihw0no7hi1mnn', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:05:22')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 146, 197, '2023-08-22 15:05:22')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:05:22.538109' WHERE `books`.`id` = 146[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: m5ko73ld9o9n3dkihw0no7hi1mnn (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ae62463d-5efe-402d-a52d-3f5d12aa9521) to Test(default) with arguments: #<GlobalID:0x00007ff3fdf8ae50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/197>>
Completed 200 OK in 311ms (Views: 0.3ms | ActiveRecord: 3.7ms | Allocations: 181364)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:06:21.576752', '2023-08-22 15:06:21.576752')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 389 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 389, '2023-08-22 15:06:21.676284', '2023-08-22 15:06:21.676284')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 147 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pav5zvoos2ucx5xy8l8abpg4gciy', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 147, 198, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.684092' WHERE `books`.`id` = 147[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: pav5zvoos2ucx5xy8l8abpg4gciy (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9c12a11c-dc7a-4fb4-8b03-68180f97e78b) to Test(default) with arguments: #<GlobalID:0x00007f8b17e3fe00 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/198>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 389 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 389, '2023-08-22 15:06:21.694735', '2023-08-22 15:06:21.694735')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 148 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7uopbma87ier5z208fddtc4xph87', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 148, 199, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.702317' WHERE `books`.`id` = 148[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 7uopbma87ier5z208fddtc4xph87 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8ed945d6-c2d4-4951-aef9-28054d862e35) to Test(default) with arguments: #<GlobalID:0x00007f8b1b934b00 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/199>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 389 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 389, '2023-08-22 15:06:21.710517', '2023-08-22 15:06:21.710517')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 149 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('x8wkyrvpb7rhcrypk0fdshynxsma', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 149, 200, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.715257' WHERE `books`.`id` = 149[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: x8wkyrvpb7rhcrypk0fdshynxsma (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6ca58c28-306a-4e15-a326-0e5ed76805d4) to Test(default) with arguments: #<GlobalID:0x00007f8b1c80db68 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/200>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (147, 148, 149)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (147, 148, 149)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (198, 199, 200)[0m
Completed 200 OK in 19ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:06:21.769632', '2023-08-22 15:06:21.769632')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 390 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 390, '2023-08-22 15:06:21.776238', '2023-08-22 15:06:21.776238')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 150 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wggww5znuspfq86qcsrm0jhnr89n', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 150, 201, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.781657' WHERE `books`.`id` = 150[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: wggww5znuspfq86qcsrm0jhnr89n (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d999c87e-c13c-48b5-8ab9-ef0b6cd40f0a) to Test(default) with arguments: #<GlobalID:0x00007f8b17dcaab0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/201>>
Started GET "/books/150" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"150"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (1.1ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 150 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 150[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 150[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 201[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:06:21.820803', '2023-08-22 15:06:21.820803')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 391 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 391, '2023-08-22 15:06:21.826578', '2023-08-22 15:06:21.826578')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 151 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('n5ha2lmojjt8f3p9mtj4meale0vu', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 151, 202, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.832447' WHERE `books`.`id` = 151[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: n5ha2lmojjt8f3p9mtj4meale0vu (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 604609c3-d193-4367-ac1a-4c2cfe69d494) to Test(default) with arguments: #<GlobalID:0x00007f8b1b631340 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/202>>
Started GET "/books/check_existence?id=151" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"151"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 151 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:06:21.850563', '2023-08-22 15:06:21.850563')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 392 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 392, '2023-08-22 15:06:21.857155', '2023-08-22 15:06:21.857155')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 152 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('f0gkzoh6x75g7nawz5hgmzkoeowq', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 152, 203, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (1.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.862571' WHERE `books`.`id` = 152[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: f0gkzoh6x75g7nawz5hgmzkoeowq (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 899b16ee-3040-49fd-a913-240dbe3264fb) to Test(default) with arguments: #<GlobalID:0x00007f8b1be662e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/203>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:06:21.886322', '2023-08-22 15:06:21.886322')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f8b1b672868 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9293-q530bi.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"393"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 393 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 393, '2023-08-22 15:06:21.905915', '2023-08-22 15:06:21.905915', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 153 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('iz45thsaox14lnp4led3fbi25f3w', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:21')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 153, 204, '2023-08-22 15:06:21')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:21.912763' WHERE `books`.`id` = 153[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: iz45thsaox14lnp4led3fbi25f3w (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 866ef4b2-bcfa-4747-84f3-b738b784bfca) to Test(default) with arguments: #<GlobalID:0x00007f8b17ed59f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/204>>
Completed 200 OK in 17ms (Views: 0.4ms | ActiveRecord: 4.2ms | Allocations: 4252)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/153" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"153"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 153 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 153[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 153[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 204[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:06:21.941514', '2023-08-22 15:06:21.941514')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:06:21 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"394"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 394 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 394, '2023-08-22 15:06:21.956331', '2023-08-22 15:06:21.956331', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 154 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 154 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mw69yfbghdyqqywqdkweaq03i0or', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:06:22')[0m
  [1m[36mActiveStorage::Attachment Create (1.7ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 154, 205, '2023-08-22 15:06:22')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:06:22.307096' WHERE `books`.`id` = 154[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: mw69yfbghdyqqywqdkweaq03i0or (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2ad313a4-0965-4365-9f11-9c0f5374be24) to Test(default) with arguments: #<GlobalID:0x00007f8b22885130 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/205>>
Completed 200 OK in 361ms (Views: 0.4ms | ActiveRecord: 5.9ms | Allocations: 181374)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/154" for 127.0.0.1 at 2023-08-23 00:06:22 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"154"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 154 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 154[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 154[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 205[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:09:11.547158', '2023-08-22 15:09:11.547158')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 395 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 395, '2023-08-22 15:09:11.672758', '2023-08-22 15:09:11.672758')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 155 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('4dyzkr9qn7yb9x0x2ciem6jlo1kp', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 155, 206, '2023-08-22 15:09:11')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:11.680004' WHERE `books`.`id` = 155[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: 4dyzkr9qn7yb9x0x2ciem6jlo1kp (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5149e819-fe03-41a7-9ad0-d78ec8c40e35) to Test(default) with arguments: #<GlobalID:0x00007faba0c8bdd0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/206>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 395 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 395, '2023-08-22 15:09:11.692103', '2023-08-22 15:09:11.692103')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 156 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7lql1vz1945mdj9ltienqy2mesu2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 156, 207, '2023-08-22 15:09:11')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:11.697981' WHERE `books`.`id` = 156[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 7lql1vz1945mdj9ltienqy2mesu2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 857b2871-c5a8-4553-aaeb-0a99d6cbaded) to Test(default) with arguments: #<GlobalID:0x00007faba42f41d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/207>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 395 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 395, '2023-08-22 15:09:11.705296', '2023-08-22 15:09:11.705296')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 157 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u1au9tr2xjuml63z7mlut8qh4pzf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 157, 208, '2023-08-22 15:09:11')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:11.710729' WHERE `books`.`id` = 157[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: u1au9tr2xjuml63z7mlut8qh4pzf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c8c27c39-7f28-4b01-bca5-7fcd562a1846) to Test(default) with arguments: #<GlobalID:0x00007faba1304c20 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/208>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:09:11 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (155, 156, 157)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (155, 156, 157)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (206, 207, 208)[0m
Completed 200 OK in 30ms (Views: 0.6ms | ActiveRecord: 3.3ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:09:11.790125', '2023-08-22 15:09:11.790125')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 396 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 396, '2023-08-22 15:09:11.796101', '2023-08-22 15:09:11.796101')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 158 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ikox59oyg0cq77u1ez1ls9czgqnv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 158, 209, '2023-08-22 15:09:11')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:11.802544' WHERE `books`.`id` = 158[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: ikox59oyg0cq77u1ez1ls9czgqnv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 61be8608-77a3-4fb2-a5d2-0e3790907c39) to Test(default) with arguments: #<GlobalID:0x00007faba14a87c0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/209>>
Started GET "/books/158" for 127.0.0.1 at 2023-08-23 00:09:11 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"158"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 158 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 158[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 158[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 209[0m
Completed 200 OK in 10ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:09:11 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.1ms | Allocations: 671)
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:09:11.850522', '2023-08-22 15:09:11.850522')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 397 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 397, '2023-08-22 15:09:11.857835', '2023-08-22 15:09:11.857835')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 159 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r42up1cbo78om9sdzpff1ceoseqf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 159, 210, '2023-08-22 15:09:11')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:11.863865' WHERE `books`.`id` = 159[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: r42up1cbo78om9sdzpff1ceoseqf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 70b905d0-1867-4b84-97e7-dfd24e8a7791) to Test(default) with arguments: #<GlobalID:0x00007faba4f97110 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/210>>
Started GET "/books/check_existence?id=159" for 127.0.0.1 at 2023-08-23 00:09:11 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"159"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 159 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:09:11.881931', '2023-08-22 15:09:11.881931')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 398 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 398, '2023-08-22 15:09:11.942195', '2023-08-22 15:09:11.942195')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 160 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('8dalr9dgld8gzwo8rupc8q73ssvd', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 160, 211, '2023-08-22 15:09:11')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:11.948563' WHERE `books`.`id` = 160[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 8dalr9dgld8gzwo8rupc8q73ssvd (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c8db3a48-6800-4a84-9cfc-f9d89012c76b) to Test(default) with arguments: #<GlobalID:0x00007faba155bed8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/211>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:09:11 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:09:11.972352', '2023-08-22 15:09:11.972352')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:09:11 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007faba15883e8 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9423-zlg7mb.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"399"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 399 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 399, '2023-08-22 15:09:11.996741', '2023-08-22 15:09:11.996741', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 161 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('kr8tioxi05hqk5ewc0frv36i7n1i', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:11')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 161, 212, '2023-08-22 15:09:12')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:12.001975' WHERE `books`.`id` = 161[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: kr8tioxi05hqk5ewc0frv36i7n1i (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d35971bc-bd82-485e-b2aa-5bc1d216dc71) to Test(default) with arguments: #<GlobalID:0x00007faba4ffb750 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/212>>
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 2.9ms | Allocations: 4237)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/161" for 127.0.0.1 at 2023-08-23 00:09:12 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"161"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 161 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 161[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 161[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 212[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:09:12.028831', '2023-08-22 15:09:12.028831')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:09:12 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"400"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 400 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 400, '2023-08-22 15:09:12.043180', '2023-08-22 15:09:12.043180', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 162 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 162 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('hhkebo7d2woj3fe582fiouaxzaju', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:12')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 162, 213, '2023-08-22 15:09:12')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:12.329661' WHERE `books`.`id` = 162[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: hhkebo7d2woj3fe582fiouaxzaju (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ed091f62-f223-4246-89d8-919d8e4f18ae) to Test(default) with arguments: #<GlobalID:0x00007fabac044bb0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/213>>
Completed 200 OK in 296ms (Views: 0.3ms | ActiveRecord: 4.4ms | Allocations: 181383)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/162" for 127.0.0.1 at 2023-08-23 00:09:12 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"162"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 162 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 162[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 162[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 213[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:09:12.357950', '2023-08-22 15:09:12.357950')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:09:12 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"401"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 401 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 11ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:09:24.944098', '2023-08-22 15:09:24.944098')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 402 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 402, '2023-08-22 15:09:25.046353', '2023-08-22 15:09:25.046353')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 163 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wim2g85hnkhu2lqh5a6z6ueif17s', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 163, 214, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.052740' WHERE `books`.`id` = 163[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: wim2g85hnkhu2lqh5a6z6ueif17s (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6ffc6584-a0cc-412f-89ba-61fe4f8ec26d) to Test(default) with arguments: #<GlobalID:0x00007fb74cc0c960 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/214>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 402 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 402, '2023-08-22 15:09:25.063622', '2023-08-22 15:09:25.063622')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 164 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jrr6f2ln9cg4ck9bouk30pwgnc1z', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 164, 215, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.070228' WHERE `books`.`id` = 164[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: jrr6f2ln9cg4ck9bouk30pwgnc1z (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d0424a96-d7ac-4758-9a7b-9d591536eb6c) to Test(default) with arguments: #<GlobalID:0x00007fb74cc2eab0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/215>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 402 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 402, '2023-08-22 15:09:25.077940', '2023-08-22 15:09:25.077940')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 165 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('f9iehiq6oyrkmelaz47qioo045dk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 165, 216, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.084835' WHERE `books`.`id` = 165[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: f9iehiq6oyrkmelaz47qioo045dk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 02fee938-4d8c-4234-9e9f-04590a8cbfd5) to Test(default) with arguments: #<GlobalID:0x00007fb74cc5ced8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/216>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (163, 164, 165)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (163, 164, 165)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (214, 215, 216)[0m
Completed 200 OK in 23ms (Views: 0.4ms | ActiveRecord: 3.6ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:09:25.145152', '2023-08-22 15:09:25.145152')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 403 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 403, '2023-08-22 15:09:25.151690', '2023-08-22 15:09:25.151690')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 166 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('b4l7epnx8vby16wrvr4rz4fpvwi9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 166, 217, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.157192' WHERE `books`.`id` = 166[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: b4l7epnx8vby16wrvr4rz4fpvwi9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 33a04faa-ee8c-4dfd-836b-6580ea748bde) to Test(default) with arguments: #<GlobalID:0x00007fb7494b89a0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/217>>
Started GET "/books/166" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"166"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 166 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 166[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 166[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 217[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.7ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:09:25.193797', '2023-08-22 15:09:25.193797')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 404 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 404, '2023-08-22 15:09:25.199669', '2023-08-22 15:09:25.199669')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 167 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jevb5z4i8bvf1hqzvb0p8avu57eb', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 167, 218, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.205173' WHERE `books`.`id` = 167[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: jevb5z4i8bvf1hqzvb0p8avu57eb (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1a540b46-3cd7-481a-b661-6e2c3a57a709) to Test(default) with arguments: #<GlobalID:0x00007fb74cbde178 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/218>>
Started GET "/books/check_existence?id=167" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"167"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 167 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:09:25.222236', '2023-08-22 15:09:25.222236')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 405 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 405, '2023-08-22 15:09:25.227654', '2023-08-22 15:09:25.227654')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 168 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('isezd2gxkn1ekm244ltrj41frmya', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 168, 219, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.233359' WHERE `books`.`id` = 168[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: isezd2gxkn1ekm244ltrj41frmya (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6fbd0d1b-7d2d-436a-a8c0-e4cdad0d0cda) to Test(default) with arguments: #<GlobalID:0x00007fb74957f118 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/219>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:09:25.255582', '2023-08-22 15:09:25.255582')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fb751b0f620 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9455-u6eowg.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"406"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 406 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 406, '2023-08-22 15:09:25.275000', '2023-08-22 15:09:25.275000', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 169 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('17499y0gn5l4rt1vjwdgrkcm6o0c', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 169, 220, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.281176' WHERE `books`.`id` = 169[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 17499y0gn5l4rt1vjwdgrkcm6o0c (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 35772e0a-74c3-4871-a385-77330dbbbea2) to Test(default) with arguments: #<GlobalID:0x00007fb74cd067a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/220>>
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 2.8ms | Allocations: 4250)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/169" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"169"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 169 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 169[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 169[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 220[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:09:25.306921', '2023-08-22 15:09:25.306921')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"407"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 407 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 407, '2023-08-22 15:09:25.320039', '2023-08-22 15:09:25.320039', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 170 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 170 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r3l0wbdu3yvpcs4i2njswmgh141m', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:09:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 170, 221, '2023-08-22 15:09:25')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:09:25.563384' WHERE `books`.`id` = 170[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: r3l0wbdu3yvpcs4i2njswmgh141m (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1035f983-0f04-4d38-9a4b-25243a82435b) to Test(default) with arguments: #<GlobalID:0x00007fb74969f818 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/221>>
Completed 200 OK in 251ms (Views: 0.3ms | ActiveRecord: 3.8ms | Allocations: 181374)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/170" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"170"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 170 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 170[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 170[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 221[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1775)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:09:25.589249', '2023-08-22 15:09:25.589249')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:09:25 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"408"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 408 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:21:36.014759', '2023-08-22 15:21:36.014759')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 409 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 409, '2023-08-22 15:21:36.126460', '2023-08-22 15:21:36.126460')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 171 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7qjh5i4yzyrxfyxpe1ptzs4cv6ed', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 171, 222, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.131848' WHERE `books`.`id` = 171[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 7qjh5i4yzyrxfyxpe1ptzs4cv6ed (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0f6b41ff-7628-46d9-8bfa-38793762869b) to Test(default) with arguments: #<GlobalID:0x00007f8b8e9edd08 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/222>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 409 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 409, '2023-08-22 15:21:36.143186', '2023-08-22 15:21:36.143186')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 172 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('yya2gbjsypv6zzu22p257nygpl4g', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 172, 223, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.149144' WHERE `books`.`id` = 172[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: yya2gbjsypv6zzu22p257nygpl4g (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2366a4c6-0e68-4be9-9c49-a2cd10456595) to Test(default) with arguments: #<GlobalID:0x00007f8b9749fd48 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/223>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 409 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 409, '2023-08-22 15:21:36.157908', '2023-08-22 15:21:36.157908')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 173 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ier8735d4srr54nvwuw3wyl7bygm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 173, 224, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.162748' WHERE `books`.`id` = 173[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: ier8735d4srr54nvwuw3wyl7bygm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f0795f4c-ff12-463e-8abc-7fc9d6caa52d) to Test(default) with arguments: #<GlobalID:0x00007f8b8ea92330 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/224>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (171, 172, 173)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (171, 172, 173)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (222, 223, 224)[0m
Completed 200 OK in 31ms (Views: 0.4ms | ActiveRecord: 2.9ms | Allocations: 10693)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:21:36.239697', '2023-08-22 15:21:36.239697')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 410 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 410, '2023-08-22 15:21:36.244595', '2023-08-22 15:21:36.244595')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 174 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xw0us5ffi9u7q8dm13bgaeux3u8v', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 174, 225, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.248970' WHERE `books`.`id` = 174[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: xw0us5ffi9u7q8dm13bgaeux3u8v (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 75c9af37-9b5f-4027-ae84-9157266f415f) to Test(default) with arguments: #<GlobalID:0x00007f8b972c8d30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/225>>
Started GET "/books/174" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"174"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 174 LIMIT 1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 174[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 174[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 225[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 1864)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.7ms | Allocations: 671)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:21:36.284236', '2023-08-22 15:21:36.284236')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 411 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 411, '2023-08-22 15:21:36.290134', '2023-08-22 15:21:36.290134')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 175 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ybe51swr7ncxhu3mvoa1j1rl7shv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 175, 226, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.2ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.295413' WHERE `books`.`id` = 175[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: ybe51swr7ncxhu3mvoa1j1rl7shv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bad92c5e-1d68-4c55-b9f9-8949550c4bf3) to Test(default) with arguments: #<GlobalID:0x00007f8b974b4950 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/226>>
Started GET "/books/check_existence?id=175" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"175"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 175 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:21:36.312582', '2023-08-22 15:21:36.312582')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 412 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 412, '2023-08-22 15:21:36.317552', '2023-08-22 15:21:36.317552')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 176 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qmtyasj22oil2da9wlz8v9031g7l', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 176, 227, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.322863' WHERE `books`.`id` = 176[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: qmtyasj22oil2da9wlz8v9031g7l (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8c6d7c6a-1345-4617-a1f7-08d85c4a01f3) to Test(default) with arguments: #<GlobalID:0x00007f8b92866f30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/227>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.6ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:21:36.345454', '2023-08-22 15:21:36.345454')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f8b9754f450 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-9754-c5c1ag.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"413"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 413 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 413, '2023-08-22 15:21:36.365814', '2023-08-22 15:21:36.365814', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 177 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('b228g5j6n6j0e77zjoy1fepn4mf4', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 177, 228, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.371058' WHERE `books`.`id` = 177[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: b228g5j6n6j0e77zjoy1fepn4mf4 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 721d4789-5f07-4bfc-ab8f-221ea7847670) to Test(default) with arguments: #<GlobalID:0x00007f8b9379e570 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/228>>
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 3.0ms | Allocations: 4253)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/177" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"177"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 177 LIMIT 1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 177[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 177[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 228[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.8ms | Allocations: 1736)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:21:36.399595', '2023-08-22 15:21:36.399595')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"414"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 414 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 414, '2023-08-22 15:21:36.413762', '2023-08-22 15:21:36.413762', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 178 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 178 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2ai1x9qhoq5mx23jf0mofgc8vgav', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:21:36')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 178, 229, '2023-08-22 15:21:36')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:21:36.808121' WHERE `books`.`id` = 178[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 2ai1x9qhoq5mx23jf0mofgc8vgav (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9caf4c2f-b87e-445e-974e-1a072335ceb0) to Test(default) with arguments: #<GlobalID:0x00007f8b8eb526a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/229>>
Completed 200 OK in 403ms (Views: 0.3ms | ActiveRecord: 4.2ms | Allocations: 181374)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/178" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"178"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 178 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 178[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 178[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 229[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:21:36 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"-1"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.5ms | Allocations: 840)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:43:40.103562', '2023-08-22 15:43:40.103562')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 415 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 415, '2023-08-22 15:43:40.213349', '2023-08-22 15:43:40.213349')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 179 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('8ha0085qslm4gsfcoslfb63xdjrf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 179, 230, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.219582' WHERE `books`.`id` = 179[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: 8ha0085qslm4gsfcoslfb63xdjrf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5f0f0730-f9ad-4e0e-97bf-ad784841941f) to Test(default) with arguments: #<GlobalID:0x00007fbf7626fd58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/230>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 415 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '文部科学省', '日本', 'その他', 415, '2023-08-22 15:43:40.231328', '2023-08-22 15:43:40.231328')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 180 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ieb859d1u9wc4wz028a2b9gmknfw', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 180, 231, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.237177' WHERE `books`.`id` = 180[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: ieb859d1u9wc4wz028a2b9gmknfw (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 825d6c6a-5b21-4e7e-9ec9-6403619fae57) to Test(default) with arguments: #<GlobalID:0x00007fbf7aa16d50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/231>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 415 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '文部科学省', '日本', 'その他', 415, '2023-08-22 15:43:40.244597', '2023-08-22 15:43:40.244597')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 181 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('geno2bz96qejcgrldboj65w7kmoi', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 181, 232, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.250074' WHERE `books`.`id` = 181[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: geno2bz96qejcgrldboj65w7kmoi (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4b13090d-4f91-4203-8839-03203683a294) to Test(default) with arguments: #<GlobalID:0x00007fbf7aa674a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/232>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (179, 180, 181)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (179, 180, 181)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (230, 231, 232)[0m
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 10695)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:43:40.319733', '2023-08-22 15:43:40.319733')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 416 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 416, '2023-08-22 15:43:40.324919', '2023-08-22 15:43:40.324919')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 182 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5sephnbebb0a55qs86enoiozl6jr', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 182, 233, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.329699' WHERE `books`.`id` = 182[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 5sephnbebb0a55qs86enoiozl6jr (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 642c335e-d4eb-4fc5-af91-b2843b1308ba) to Test(default) with arguments: #<GlobalID:0x00007fbf7aea5240 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/233>>
Started GET "/books/182" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"182"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 182 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 182[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 182[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 233[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.1ms | Allocations: 672)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:43:40.384421', '2023-08-22 15:43:40.384421')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 417 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 417, '2023-08-22 15:43:40.390555', '2023-08-22 15:43:40.390555')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 183 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jg0hjh2x3l2n8jqm9fy1z4bdyhlo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 183, 234, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.395255' WHERE `books`.`id` = 183[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: jg0hjh2x3l2n8jqm9fy1z4bdyhlo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7ce17915-54c1-44cd-8715-b23a5ad5543f) to Test(default) with arguments: #<GlobalID:0x00007fbf73283068 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/234>>
Started GET "/books/check_existence?id=183" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"183"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 183 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:43:40.413281', '2023-08-22 15:43:40.413281')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 418 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '文部科学省', '日本', 'その他', 418, '2023-08-22 15:43:40.418062', '2023-08-22 15:43:40.418062')[0m
  [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 184 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('a1xou3m7ww78carn9lnovbfu555k', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 184, 235, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.425040' WHERE `books`.`id` = 184[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: a1xou3m7ww78carn9lnovbfu555k (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 90614131-68db-46fc-bf1d-ef6425ac85b2) to Test(default) with arguments: #<GlobalID:0x00007fbf7e01ff78 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/235>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:43:40.454821', '2023-08-22 15:43:40.454821')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fbf76b08500 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10562-tm0v2t.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"419"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 419 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 419, '2023-08-22 15:43:40.477652', '2023-08-22 15:43:40.477652', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 185 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('4x6vpwup5523bcioe54jl7iun2ha', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 185, 236, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.483903' WHERE `books`.`id` = 185[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 4x6vpwup5523bcioe54jl7iun2ha (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5bd4e189-04a6-42a3-9d19-8d9681d0656c) to Test(default) with arguments: #<GlobalID:0x00007fbf7afa7648 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/236>>
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 3.5ms | Allocations: 4252)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/185" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"185"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 185 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 185[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 185[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 236[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.6ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:43:40.511761', '2023-08-22 15:43:40.511761')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"420"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 420 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 420, '2023-08-22 15:43:40.525096', '2023-08-22 15:43:40.525096', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 186 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 186 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('i05jte3qysnh02yvpups4mtwgie6', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 186, 237, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.820466' WHERE `books`.`id` = 186[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: i05jte3qysnh02yvpups4mtwgie6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bb51a918-539a-45f8-bab0-1557b5f0c38e) to Test(default) with arguments: #<GlobalID:0x00007fbf76bd0190 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/237>>
Completed 200 OK in 305ms (Views: 0.4ms | ActiveRecord: 5.1ms | Allocations: 181371)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/186" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"186"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 186 LIMIT 1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 186[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 186[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 237[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:43:40.848155', '2023-08-22 15:43:40.848155')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:43:40 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"421"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 421 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 3378)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:43:40.872130', '2023-08-22 15:43:40.872130')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 422 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '日本', 'その他', 422, '2023-08-22 15:43:40.877589', '2023-08-22 15:43:40.877589')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 187 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ch0fwcfou0vvi6ssywni5mr9drc7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:43:40')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 187, 238, '2023-08-22 15:43:40')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:43:40.881768' WHERE `books`.`id` = 187[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: ch0fwcfou0vvi6ssywni5mr9drc7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: cafffa4c-3b26-4802-a5ec-12cecfa38bc8) to Test(default) with arguments: #<GlobalID:0x00007fbf73431810 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/238>>
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:44:00.505866', '2023-08-22 15:44:00.505866')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 423 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 423, '2023-08-22 15:44:00.612229', '2023-08-22 15:44:00.612229')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 188 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qqi0gk9uzzqwx5bk85zv5ln6ye16', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 188, 239, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.617823' WHERE `books`.`id` = 188[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: qqi0gk9uzzqwx5bk85zv5ln6ye16 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 81a637c9-c37b-4550-89fa-139941223aec) to Test(default) with arguments: #<GlobalID:0x00007fc21df87e10 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/239>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 423 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 423, '2023-08-22 15:44:00.626098', '2023-08-22 15:44:00.626098')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 189 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('umorz7rk0omm09wqelro0a2yru5y', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 189, 240, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.632149' WHERE `books`.`id` = 189[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: umorz7rk0omm09wqelro0a2yru5y (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3e1f99d8-fbcc-4c4f-852a-7d0a1238a4d8) to Test(default) with arguments: #<GlobalID:0x00007fc21844dea0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/240>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 423 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 423, '2023-08-22 15:44:00.640303', '2023-08-22 15:44:00.640303')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 190 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ktt3uk8mhnchh5iw5t47mhx64g1z', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 190, 241, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.646751' WHERE `books`.`id` = 190[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: ktt3uk8mhnchh5iw5t47mhx64g1z (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c62bc217-f371-41f4-b0eb-b445f09841fb) to Test(default) with arguments: #<GlobalID:0x00007fc21dfcc240 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/241>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (188, 189, 190)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (188, 189, 190)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (239, 240, 241)[0m
Completed 200 OK in 23ms (Views: 0.5ms | ActiveRecord: 3.0ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:44:00.706656', '2023-08-22 15:44:00.706656')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 424 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 424, '2023-08-22 15:44:00.712968', '2023-08-22 15:44:00.712968')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 191 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('bfuqfrkowsdd06ij3vaeuv5qbo0p', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 191, 242, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.718934' WHERE `books`.`id` = 191[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: bfuqfrkowsdd06ij3vaeuv5qbo0p (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0fd1863f-ad56-4765-a712-1e489079300f) to Test(default) with arguments: #<GlobalID:0x00007fc21c7263a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/242>>
Started GET "/books/191" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"191"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 191 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 191[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 191[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 242[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.7ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:44:00.759351', '2023-08-22 15:44:00.759351')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 425 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 425, '2023-08-22 15:44:00.765383', '2023-08-22 15:44:00.765383')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 192 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ceowdwl35380bvs6q5sh8vrqxehh', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 192, 243, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.770740' WHERE `books`.`id` = 192[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: ceowdwl35380bvs6q5sh8vrqxehh (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3ea68a30-9653-4969-a01f-93e5a80cea66) to Test(default) with arguments: #<GlobalID:0x00007fc218547bf8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/243>>
Started GET "/books/check_existence?id=192" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"192"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 192 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:44:00.787771', '2023-08-22 15:44:00.787771')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 426 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 426, '2023-08-22 15:44:00.792958', '2023-08-22 15:44:00.792958')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 193 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u34inf7rfuvs68ixki7y15kcvwzj', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 193, 244, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (1.2ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.799460' WHERE `books`.`id` = 193[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: u34inf7rfuvs68ixki7y15kcvwzj (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f7bf60d8-7945-4b72-a641-4b98c396eaa1) to Test(default) with arguments: #<GlobalID:0x00007fc21856cd18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/244>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms | Allocations: 183)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:44:00.818870', '2023-08-22 15:44:00.818870')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fc2185a5280 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10595-hfkmsa.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"427"}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 427 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 427, '2023-08-22 15:44:00.836331', '2023-08-22 15:44:00.836331', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 194 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('spv0utpenvmys4sg9twjvzx2sggz', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:00')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 194, 245, '2023-08-22 15:44:00')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:00.842577' WHERE `books`.`id` = 194[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: spv0utpenvmys4sg9twjvzx2sggz (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e026ea28-cd8c-412e-8244-a7d1eb62fca7) to Test(default) with arguments: #<GlobalID:0x00007fc2185b43e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/245>>
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 3.4ms | Allocations: 4252)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/194" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"194"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 194 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 194[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 194[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 245[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:44:00.868860', '2023-08-22 15:44:00.868860')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:00 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"428"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 428 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 428, '2023-08-22 15:44:00.884064', '2023-08-22 15:44:00.884064', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 195 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 195 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5cge5azgem5p3i3k8jpgp92zshw2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 195, 246, '2023-08-22 15:44:01')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:01.121647' WHERE `books`.`id` = 195[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 5cge5azgem5p3i3k8jpgp92zshw2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5fcf6263-a672-4bcb-9c82-c68a3ebc836e) to Test(default) with arguments: #<GlobalID:0x00007fc2240af350 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/246>>
Completed 200 OK in 246ms (Views: 0.3ms | ActiveRecord: 3.7ms | Allocations: 181383)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/195" for 127.0.0.1 at 2023-08-23 00:44:01 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"195"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 195 LIMIT 1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 195[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 195[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 246[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:44:01.147604', '2023-08-22 15:44:01.147604')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:01 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"429"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 429 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 3381)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:44:01.170872', '2023-08-22 15:44:01.170872')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 430 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 430, '2023-08-22 15:44:01.177257', '2023-08-22 15:44:01.177257')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 196 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('06w1iz8eijlqhlcxusyj553mxxud', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 196, 247, '2023-08-22 15:44:01')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:01.183301' WHERE `books`.`id` = 196[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 06w1iz8eijlqhlcxusyj553mxxud (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c85e9888-00cc-4c64-9721-4a971550f461) to Test(default) with arguments: #<GlobalID:0x00007fc2242c7c78 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/247>>
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:44:17.076837', '2023-08-22 15:44:17.076837')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 431 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 431, '2023-08-22 15:44:17.176751', '2023-08-22 15:44:17.176751')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 197 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('16a35a6pnhe0t6qq8c9l012ehb03', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 197, 248, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.183550' WHERE `books`.`id` = 197[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: 16a35a6pnhe0t6qq8c9l012ehb03 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4eeb8965-8e31-4b3f-a7e2-345a61aa26f3) to Test(default) with arguments: #<GlobalID:0x00007f923a37a1f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/248>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 431 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 431, '2023-08-22 15:44:17.194181', '2023-08-22 15:44:17.194181')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 198 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('hwjjpgmek552lan79fcx9laze1p6', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 198, 249, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.199764' WHERE `books`.`id` = 198[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: hwjjpgmek552lan79fcx9laze1p6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 898a7cab-fa6d-43b4-85aa-e6dd5ff0476c) to Test(default) with arguments: #<GlobalID:0x00007f9235bdb748 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/249>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 431 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 431, '2023-08-22 15:44:17.207264', '2023-08-22 15:44:17.207264')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 199 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5s5or756pvnebbzu6c43iccgqb7i', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 199, 250, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.212574' WHERE `books`.`id` = 199[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: 5s5or756pvnebbzu6c43iccgqb7i (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 658b907d-4ec5-4ea9-bf3f-725fdc4316d6) to Test(default) with arguments: #<GlobalID:0x00007f92351c2d88 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/250>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (197, 198, 199)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (197, 198, 199)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (248, 249, 250)[0m
Completed 200 OK in 19ms (Views: 0.4ms | ActiveRecord: 3.1ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:44:17.266302', '2023-08-22 15:44:17.266302')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 432 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 432, '2023-08-22 15:44:17.272568', '2023-08-22 15:44:17.272568')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 200 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('83bfd7y4opwfwnv5rfw2hjnvyv22', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 200, 251, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.278495' WHERE `books`.`id` = 200[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 83bfd7y4opwfwnv5rfw2hjnvyv22 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0ec64990-5c9e-4706-b896-58af7abad978) to Test(default) with arguments: #<GlobalID:0x00007f92354395a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/251>>
Started GET "/books/200" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"200"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 200 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 200[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 200[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 251[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.8ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:44:17.316494', '2023-08-22 15:44:17.316494')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 433 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 433, '2023-08-22 15:44:17.324522', '2023-08-22 15:44:17.324522')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 201 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7uspoa6nyqwluwvdcnta5r6ujaja', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 201, 252, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.331684' WHERE `books`.`id` = 201[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 7uspoa6nyqwluwvdcnta5r6ujaja (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2df141fe-6f9c-4c0a-8f73-8917c4168a57) to Test(default) with arguments: #<GlobalID:0x00007f923e0e40c0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/252>>
Started GET "/books/check_existence?id=201" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"201"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 201 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:44:17.352716', '2023-08-22 15:44:17.352716')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 434 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 434, '2023-08-22 15:44:17.360032', '2023-08-22 15:44:17.360032')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 202 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xttevq5t0wuexn62ar5tz5s8ivhm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 202, 253, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.366109' WHERE `books`.`id` = 202[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: xttevq5t0wuexn62ar5tz5s8ivhm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d76d76d2-d41d-4350-b574-f9219e9d9471) to Test(default) with arguments: #<GlobalID:0x00007f92354b9028 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/253>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:44:17.389948', '2023-08-22 15:44:17.389948')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f9239869548 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10631-am0b6e.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"435"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 435 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 435, '2023-08-22 15:44:17.415783', '2023-08-22 15:44:17.415783', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 203 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('tcfm3qvj74oiz4kofwisifbkasag', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 203, 254, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.422443' WHERE `books`.`id` = 203[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: tcfm3qvj74oiz4kofwisifbkasag (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e296a46d-bf35-4c86-8a7b-c8f19f2f8bb8) to Test(default) with arguments: #<GlobalID:0x00007f9235500658 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/254>>
Completed 200 OK in 16ms (Views: 0.3ms | ActiveRecord: 3.6ms | Allocations: 4253)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/203" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"203"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 203 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 203[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 203[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 254[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:44:17.450927', '2023-08-22 15:44:17.450927')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"436"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 436 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 436, '2023-08-22 15:44:17.465326', '2023-08-22 15:44:17.465326', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 204 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 204 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('hbamks5v4n4t06oum6ywqn4x8xo2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 204, 255, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.736051' WHERE `books`.`id` = 204[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: hbamks5v4n4t06oum6ywqn4x8xo2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a1b0d92c-9b56-4166-bd04-3643a586f2c1) to Test(default) with arguments: #<GlobalID:0x00007f923e1a63f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/255>>
Completed 200 OK in 278ms (Views: 0.3ms | ActiveRecord: 3.9ms | Allocations: 181385)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/204" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"204"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 204 LIMIT 1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 204[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 204[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 255[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.1ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:44:17.762056', '2023-08-22 15:44:17.762056')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:17 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"437"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 437 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 3381)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:44:17.786159', '2023-08-22 15:44:17.786159')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 438 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 438, '2023-08-22 15:44:17.792228', '2023-08-22 15:44:17.792228')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 205 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cyjjm6qzheqc04jqg2sbn2fkoz79', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:17')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 205, 256, '2023-08-22 15:44:17')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:17.798692' WHERE `books`.`id` = 205[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: cyjjm6qzheqc04jqg2sbn2fkoz79 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ee4e6461-5f9f-434e-940e-bdb9b066bc44) to Test(default) with arguments: #<GlobalID:0x00007f9235671320 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/256>>
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:44:28.385494', '2023-08-22 15:44:28.385494')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 439 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 439, '2023-08-22 15:44:28.501771', '2023-08-22 15:44:28.501771')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 206 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9doj2bnzcnoqp06e9bv0kvmeb5ix', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 206, 257, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.509345' WHERE `books`.`id` = 206[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: 9doj2bnzcnoqp06e9bv0kvmeb5ix (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 95df6893-2482-4582-91de-69f61baa2afd) to Test(default) with arguments: #<GlobalID:0x00007fbf509e8448 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/257>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 439 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 439, '2023-08-22 15:44:28.519472', '2023-08-22 15:44:28.519472')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 207 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('uxxjyejdre7mwirizrh7f2i1tkso', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 207, 258, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.525489' WHERE `books`.`id` = 207[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: uxxjyejdre7mwirizrh7f2i1tkso (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ef2f5bae-1a2b-4ee8-8f96-d0642fb93458) to Test(default) with arguments: #<GlobalID:0x00007fbf50bed810 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/258>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 439 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 439, '2023-08-22 15:44:28.532406', '2023-08-22 15:44:28.532406')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 208 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wqqc62q7uyyf7k8s3j1gmyih6hxm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 208, 259, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.538532' WHERE `books`.`id` = 208[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: wqqc62q7uyyf7k8s3j1gmyih6hxm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fe4ac925-b521-435e-b263-57271223334b) to Test(default) with arguments: #<GlobalID:0x00007fbf54e54668 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/259>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (206, 207, 208)[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (206, 207, 208)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (257, 258, 259)[0m
Completed 200 OK in 20ms (Views: 0.5ms | ActiveRecord: 3.1ms | Allocations: 10696)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:44:28.594059', '2023-08-22 15:44:28.594059')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 440 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 440, '2023-08-22 15:44:28.599814', '2023-08-22 15:44:28.599814')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 209 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mf5oer8zw7hu2rth0qes0i39u3kn', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 209, 260, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.605050' WHERE `books`.`id` = 209[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: mf5oer8zw7hu2rth0qes0i39u3kn (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 37db3716-de27-4af5-a6b1-80bcccc51e37) to Test(default) with arguments: #<GlobalID:0x00007fbf50d995d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/260>>
Started GET "/books/209" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"209"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 209 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 209[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 209[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 260[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.7ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:44:28.643303', '2023-08-22 15:44:28.643303')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 441 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 441, '2023-08-22 15:44:28.649541', '2023-08-22 15:44:28.649541')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 210 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0apmewkzbajaiksvnencqa70patd', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 210, 261, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.655081' WHERE `books`.`id` = 210[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.1ms) [0m[32mUploaded file to key: 0apmewkzbajaiksvnencqa70patd (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 146c1c6c-fa34-44dc-9630-1e9b33496529) to Test(default) with arguments: #<GlobalID:0x00007fbf5a2440c0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/261>>
Started GET "/books/check_existence?id=210" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"210"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 210 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:44:28.674246', '2023-08-22 15:44:28.674246')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 442 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 442, '2023-08-22 15:44:28.679282', '2023-08-22 15:44:28.679282')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 211 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('dbq4zc5cx88mnhk0nfa2v83vbj5d', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 211, 262, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.683996' WHERE `books`.`id` = 211[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: dbq4zc5cx88mnhk0nfa2v83vbj5d (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 69f748bb-3bac-4799-b6bb-1162b53bc2d1) to Test(default) with arguments: #<GlobalID:0x00007fbf5a26d088 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/262>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:44:28.706789', '2023-08-22 15:44:28.706789')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fbf50e415d0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10664-e3kdho.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"443"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 443 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 443, '2023-08-22 15:44:28.725339', '2023-08-22 15:44:28.725339', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 212 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ghsu9qk860zxhl0hf3c1tvan1joc', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 212, 263, '2023-08-22 15:44:28')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:28.731014' WHERE `books`.`id` = 212[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: ghsu9qk860zxhl0hf3c1tvan1joc (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 9914304b-095c-4d2e-aee6-9710f7c19c59) to Test(default) with arguments: #<GlobalID:0x00007fbf5a2c4720 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/263>>
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 4252)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/212" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"212"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 212 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 212[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 212[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 263[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:44:28.757600', '2023-08-22 15:44:28.757600')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:28 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"444"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 444 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 444, '2023-08-22 15:44:28.773778', '2023-08-22 15:44:28.773778', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 213 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 213 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7dbpk9jx8w91f5oab13g3e1gc872', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 213, 264, '2023-08-22 15:44:29')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:29.016323' WHERE `books`.`id` = 213[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: 7dbpk9jx8w91f5oab13g3e1gc872 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3f482e2f-3625-4893-a360-da275632ec4b) to Test(default) with arguments: #<GlobalID:0x00007fbf5a394498 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/264>>
Completed 200 OK in 253ms (Views: 0.5ms | ActiveRecord: 5.2ms | Allocations: 181370)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/213" for 127.0.0.1 at 2023-08-23 00:44:29 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"213"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 213 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 213[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 213[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 264[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:44:29.047737', '2023-08-22 15:44:29.047737')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:44:29 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"445"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 445 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 3381)
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:44:29.069567', '2023-08-22 15:44:29.069567')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 446 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 446, '2023-08-22 15:44:29.074311', '2023-08-22 15:44:29.074311')[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 214 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('y2qjhywlrjy8a467v0wl3hx3gam2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 214, 265, '2023-08-22 15:44:29')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:29.078506' WHERE `books`.`id` = 214[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: y2qjhywlrjy8a467v0wl3hx3gam2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0ebbcb3f-8542-4977-8260-2447a46501fc) to Test(default) with arguments: #<GlobalID:0x00007fbf5c82c0a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/265>>
Started PATCH "/books/214" for 127.0.0.1 at 2023-08-23 00:44:29 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fbf50ff8c70 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10664-a7f2ts.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"446"}, "id"=>"214"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 446 LIMIT 1[0m
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 214 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 446 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 214 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 214 LIMIT 1[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 15:44:29.099972', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 214[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 214 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.9ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 265[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('vn9ivb39cai0w6ke19duooslvbe2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:44:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 214, 266, '2023-08-22 15:44:29')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:44:29.107808' WHERE `books`.`id` = 214[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: vn9ivb39cai0w6ke19duooslvbe2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 265 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 548395fe-9735-408f-b926-66d8aba37a01) to Test(default) with arguments: #<GlobalID:0x00007fbf5c8b72c0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/265>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6ed181b2-e1f7-4db3-b040-78bbae7b9a93) to Test(default) with arguments: #<GlobalID:0x00007fbf5c8b43e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/266>>
Completed 200 OK in 24ms (Views: 0.3ms | ActiveRecord: 5.2ms | Allocations: 5801)
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:45:30.147803', '2023-08-22 15:45:30.147803')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 447 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 447, '2023-08-22 15:45:30.254799', '2023-08-22 15:45:30.254799')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 215 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('hgi6dznharytwqog03mx4cuquvff', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 215, 267, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.262104' WHERE `books`.`id` = 215[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: hgi6dznharytwqog03mx4cuquvff (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b37936ff-b54d-4aeb-8eea-6a01751da861) to Test(default) with arguments: #<GlobalID:0x00007fe0052922b8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/267>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 447 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 447, '2023-08-22 15:45:30.273303', '2023-08-22 15:45:30.273303')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 216 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('8edoz59f3lnycomwj8tahq5rsue2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 216, 268, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.279115' WHERE `books`.`id` = 216[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: 8edoz59f3lnycomwj8tahq5rsue2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7e87c1d2-0f58-4304-9edd-a3fab544657a) to Test(default) with arguments: #<GlobalID:0x00007fe007c450b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/268>>
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 447 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 447, '2023-08-22 15:45:30.287843', '2023-08-22 15:45:30.287843')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 217 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2hbaouf80ebgykja9rmrv5cwogbm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 217, 269, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.293336' WHERE `books`.`id` = 217[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 2hbaouf80ebgykja9rmrv5cwogbm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 55f732c2-8ecb-45c9-bd7f-82900564de17) to Test(default) with arguments: #<GlobalID:0x00007fe007c9a4e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/269>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (215, 216, 217)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (215, 216, 217)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (267, 268, 269)[0m
Completed 200 OK in 17ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 10695)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:45:30.343185', '2023-08-22 15:45:30.343185')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 448 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 448, '2023-08-22 15:45:30.348458', '2023-08-22 15:45:30.348458')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 218 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('l7m4emnezurc2ah65767c3rily1j', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 218, 270, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.352940' WHERE `books`.`id` = 218[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: l7m4emnezurc2ah65767c3rily1j (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d87a8dd3-d04d-40e4-82e0-abc47f4bf8dd) to Test(default) with arguments: #<GlobalID:0x00007fe004561148 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/270>>
Started GET "/books/218" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"218"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 218 LIMIT 1[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 218[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 218[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 270[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.1ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.0ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:45:30.393660', '2023-08-22 15:45:30.393660')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 449 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 449, '2023-08-22 15:45:30.400060', '2023-08-22 15:45:30.400060')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 219 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5lnlw8yyrr6vukiux93t54ipgjd1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 219, 271, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.407217' WHERE `books`.`id` = 219[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 5lnlw8yyrr6vukiux93t54ipgjd1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 99522ae3-9b03-461e-a04f-b65a95f701d0) to Test(default) with arguments: #<GlobalID:0x00007fe007e779f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/271>>
Started GET "/books/check_existence?id=219" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"219"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 219 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:45:30.426616', '2023-08-22 15:45:30.426616')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 450 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 450, '2023-08-22 15:45:30.432799', '2023-08-22 15:45:30.432799')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 220 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('k38018815iqw4zdmilif55h2j7fr', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 220, 272, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.438619' WHERE `books`.`id` = 220[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: k38018815iqw4zdmilif55h2j7fr (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3e7c6bcd-ccfb-4967-b38a-819dcca55ac4) to Test(default) with arguments: #<GlobalID:0x00007fe008838958 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/272>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:45:30.462247', '2023-08-22 15:45:30.462247')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fe007ed4ec0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10700-pgaf5u.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"451"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 451 LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 451, '2023-08-22 15:45:30.482946', '2023-08-22 15:45:30.482946', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 221 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mhf63ucckivn0erd3kxf8ct8se5t', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 221, 273, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.490676' WHERE `books`.`id` = 221[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: mhf63ucckivn0erd3kxf8ct8se5t (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 36a61fd2-440a-4b12-976d-6a1ce0b32cdb) to Test(default) with arguments: #<GlobalID:0x00007fe00557ff98 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/273>>
Completed 200 OK in 19ms (Views: 0.5ms | ActiveRecord: 4.1ms | Allocations: 4255)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/221" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"221"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 221 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 221[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 221[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 273[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1736)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:45:30.518214', '2023-08-22 15:45:30.518214')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"452"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 452 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 452, '2023-08-22 15:45:30.534104', '2023-08-22 15:45:30.534104', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 222 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 222 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5b35ft2bx7f583d0jlpve9ue244e', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 222, 274, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.820081' WHERE `books`.`id` = 222[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: 5b35ft2bx7f583d0jlpve9ue244e (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3269ad66-b412-4b65-8f81-bc1040eda530) to Test(default) with arguments: #<GlobalID:0x00007fe00997df10 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/274>>
Completed 200 OK in 294ms (Views: 0.3ms | ActiveRecord: 4.1ms | Allocations: 181382)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/222" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"222"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 222 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 222[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 222[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 274[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1775)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:45:30.846598', '2023-08-22 15:45:30.846598')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"453"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 453 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 0.1ms | ActiveRecord: 1.2ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:45:30.869905', '2023-08-22 15:45:30.869905')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 454 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 454, '2023-08-22 15:45:30.874592', '2023-08-22 15:45:30.874592')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 223 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jmomxa7gh76yhq9d1jddbmi5g6a9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 223, 275, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.880778' WHERE `books`.`id` = 223[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: jmomxa7gh76yhq9d1jddbmi5g6a9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2288e31f-ffa1-4a08-a458-0abde5d5a875) to Test(default) with arguments: #<GlobalID:0x00007fe00dad4e50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/275>>
Started PATCH "/books/223" for 127.0.0.1 at 2023-08-23 00:45:30 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fe00daada08 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10700-4vhdil.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"454"}, "id"=>"223"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 454 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 223 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 454 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 223 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 223 LIMIT 1[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 15:45:30.900836', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 223[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 223 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.2ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 275[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mhemcr668lop5dilacpnl1zsjd44', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:45:30')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 223, 276, '2023-08-22 15:45:30')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:45:30.907107' WHERE `books`.`id` = 223[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.6ms) [0m[32mUploaded file to key: mhemcr668lop5dilacpnl1zsjd44 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 275 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 2b8d549d-442e-445d-b9a5-e2e812c04a59) to Test(default) with arguments: #<GlobalID:0x00007fe005674368 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/275>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bd3143de-3671-4e18-811a-caca50a0102b) to Test(default) with arguments: #<GlobalID:0x00007fe00566d518 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/276>>
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 4.5ms | Allocations: 5796)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:48:52.630071', '2023-08-22 15:48:52.630071')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 455 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 455, '2023-08-22 15:48:52.745657', '2023-08-22 15:48:52.745657')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 224 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('de1l5gdfcqsgom3secmntyf4avrg', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 224, 277, '2023-08-22 15:48:52')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:52.753196' WHERE `books`.`id` = 224[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: de1l5gdfcqsgom3secmntyf4avrg (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5b27e4f5-33c4-4a8d-aaa7-af6792e91d9b) to Test(default) with arguments: #<GlobalID:0x00007fa6cae59728 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/277>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 455 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 455, '2023-08-22 15:48:52.764896', '2023-08-22 15:48:52.764896')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 225 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9gtm6dnkcd01c77nvhpx4ktay34a', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 225, 278, '2023-08-22 15:48:52')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:52.772280' WHERE `books`.`id` = 225[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 9gtm6dnkcd01c77nvhpx4ktay34a (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ff7ef399-e15b-43ec-b7a6-6a96b6dda781) to Test(default) with arguments: #<GlobalID:0x00007fa6c6aa0f90 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/278>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 455 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 455, '2023-08-22 15:48:52.780421', '2023-08-22 15:48:52.780421')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 226 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('uho630uqdoyda5nvov1vsotc6xi1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 226, 279, '2023-08-22 15:48:52')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:52.788144' WHERE `books`.`id` = 226[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: uho630uqdoyda5nvov1vsotc6xi1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 20a900ee-d4bb-4f5c-a89a-ef9676665c9c) to Test(default) with arguments: #<GlobalID:0x00007fa6caf8e440 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/279>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:48:52 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (224, 225, 226)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (224, 225, 226)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (277, 278, 279)[0m
Completed 200 OK in 30ms (Views: 0.5ms | ActiveRecord: 3.4ms | Allocations: 10695)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:48:52.860944', '2023-08-22 15:48:52.860944')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 456 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 456, '2023-08-22 15:48:52.866773', '2023-08-22 15:48:52.866773')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 227 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('y7tfnppvrjlurcdpnz2iun0qvalo', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 227, 280, '2023-08-22 15:48:52')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:52.872023' WHERE `books`.`id` = 227[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: y7tfnppvrjlurcdpnz2iun0qvalo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 550e1a9a-f7bb-41c6-8698-8d29198a3bc5) to Test(default) with arguments: #<GlobalID:0x00007fa6cc2fcf18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/280>>
Started GET "/books/227" for 127.0.0.1 at 2023-08-23 00:48:52 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"227"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 227 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 227[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 227[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 280[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:48:52 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 2ms (ActiveRecord: 0.7ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:48:52.909005', '2023-08-22 15:48:52.909005')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 457 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 457, '2023-08-22 15:48:52.915858', '2023-08-22 15:48:52.915858')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 228 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xm58v0faebvwx4edry8izc8j9mfz', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 228, 281, '2023-08-22 15:48:52')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:52.921098' WHERE `books`.`id` = 228[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: xm58v0faebvwx4edry8izc8j9mfz (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3a31be48-9dec-4917-b038-491da303c9b2) to Test(default) with arguments: #<GlobalID:0x00007fa6cf413ac0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/281>>
Started GET "/books/check_existence?id=228" for 127.0.0.1 at 2023-08-23 00:48:52 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"228"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 228 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.6ms | Allocations: 334)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:48:52.940609', '2023-08-22 15:48:52.940609')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 458 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 458, '2023-08-22 15:48:52.945802', '2023-08-22 15:48:52.945802')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 229 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('vsug9airq5dca9sf1xema3ii56nz', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 229, 282, '2023-08-22 15:48:52')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:52.951091' WHERE `books`.`id` = 229[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: vsug9airq5dca9sf1xema3ii56nz (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7976b257-0c16-460e-b1e8-37404650f367) to Test(default) with arguments: #<GlobalID:0x00007fa6c6d2c980 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/282>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:48:52 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:48:52.975216', '2023-08-22 15:48:52.975216')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:48:52 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fa6c8760ef0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10881-ximwc6.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"459"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 459 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 459, '2023-08-22 15:48:52.996865', '2023-08-22 15:48:52.996865', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 230 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('dc12g7ie32p25mrema9sicihgkui', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 230, 283, '2023-08-22 15:48:53')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:53.004732' WHERE `books`.`id` = 230[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: dc12g7ie32p25mrema9sicihgkui (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1efc691c-326d-4260-ae7e-3e93033eac07) to Test(default) with arguments: #<GlobalID:0x00007fa6cb038080 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/283>>
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 3.7ms | Allocations: 4251)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/230" for 127.0.0.1 at 2023-08-23 00:48:53 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"230"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 230 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 230[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 230[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 283[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:48:53.030840', '2023-08-22 15:48:53.030840')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:48:53 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"460"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 460 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 460, '2023-08-22 15:48:53.045412', '2023-08-22 15:48:53.045412', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 231 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 231 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('v45felyak9gkk2aat5ig83q2hr3f', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 231, 284, '2023-08-22 15:48:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:53.382431' WHERE `books`.`id` = 231[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: v45felyak9gkk2aat5ig83q2hr3f (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3e437257-13f2-4ef1-b1be-48dd310ce03a) to Test(default) with arguments: #<GlobalID:0x00007fa6cf639e58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/284>>
Completed 200 OK in 346ms (Views: 0.4ms | ActiveRecord: 4.5ms | Allocations: 181375)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/231" for 127.0.0.1 at 2023-08-23 00:48:53 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"231"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 231 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 231[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 231[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 284[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:48:53.409699', '2023-08-22 15:48:53.409699')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:48:53 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"461"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 461 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 11ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:48:53.435935', '2023-08-22 15:48:53.435935')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 462 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 462, '2023-08-22 15:48:53.441213', '2023-08-22 15:48:53.441213')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 232 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('a3ussgmla6e5jnso8i4mbeizccg6', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 232, 285, '2023-08-22 15:48:53')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:53.446895' WHERE `books`.`id` = 232[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: a3ussgmla6e5jnso8i4mbeizccg6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: abf9a720-a55d-4842-957b-be0e98a5109e) to Test(default) with arguments: #<GlobalID:0x00007fa6d2074d30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/285>>
Started PATCH "/books/232" for 127.0.0.1 at 2023-08-23 00:48:53 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fa6d204d8e8 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-10881-4hn0l3.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"462"}, "id"=>"232"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 462 LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 232 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 462 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 232 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 232 LIMIT 1[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 15:48:53.471278', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 232[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 232 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.4ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 285[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cn7bpw6ej01ttoe3cpn1luq1plg1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:48:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 232, 286, '2023-08-22 15:48:53')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:48:53.477868' WHERE `books`.`id` = 232[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: cn7bpw6ej01ttoe3cpn1luq1plg1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 285 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: a0b9cb5a-64d1-4523-88e6-151b1b25aeec) to Test(default) with arguments: #<GlobalID:0x00007fa6d2104098 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/285>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2d15b50f-d06a-4b6f-8f5e-adcafd3e956a) to Test(default) with arguments: #<GlobalID:0x00007fa6d20fd248 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/286>>
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 4.2ms | Allocations: 5805)
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 232 LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 232 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 286 LIMIT 1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 15:52:24.276393', '2023-08-22 15:52:24.276393')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 463 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 463, '2023-08-22 15:52:24.390345', '2023-08-22 15:52:24.390345')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 233 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('4n8xae3z06mduin1ss9q98103x7s', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 233, 287, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.397785' WHERE `books`.`id` = 233[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: 4n8xae3z06mduin1ss9q98103x7s (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1d3acb71-0bd4-4c22-83e9-b1b9af3ce04c) to Test(default) with arguments: #<GlobalID:0x00007f86c03989a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/287>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 463 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 463, '2023-08-22 15:52:24.410600', '2023-08-22 15:52:24.410600')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 234 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('iav9wvytvot402x24wxaiji5xyra', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 234, 288, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.416884' WHERE `books`.`id` = 234[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: iav9wvytvot402x24wxaiji5xyra (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1478061e-7382-442f-adbb-0d0acbad7d49) to Test(default) with arguments: #<GlobalID:0x00007f86c055dae0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/288>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 463 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 463, '2023-08-22 15:52:24.425102', '2023-08-22 15:52:24.425102')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 235 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wd6fr5vwn9tgguw7qyc3dh1xgcop', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 235, 289, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.431103' WHERE `books`.`id` = 235[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: wd6fr5vwn9tgguw7qyc3dh1xgcop (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 619e4e08-b3e6-4ce5-b93c-9d477b8c43ac) to Test(default) with arguments: #<GlobalID:0x00007f86c1979920 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/289>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (233, 234, 235)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (233, 234, 235)[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (287, 288, 289)[0m
Completed 200 OK in 28ms (Views: 0.4ms | ActiveRecord: 2.8ms | Allocations: 10697)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 15:52:24.505120', '2023-08-22 15:52:24.505120')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 464 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 464, '2023-08-22 15:52:24.509620', '2023-08-22 15:52:24.509620')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 236 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7515ay49s2ch1w5p5iz34c3omn59', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 236, 290, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.514336' WHERE `books`.`id` = 236[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: 7515ay49s2ch1w5p5iz34c3omn59 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 55bea344-40d2-4870-a47d-054335d44787) to Test(default) with arguments: #<GlobalID:0x00007f86c6386310 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/290>>
Started GET "/books/236" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"236"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 236 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 236[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 236[0m
  [1m[36mActiveStorage::Blob Load (0.8ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 290[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 3.0ms | Allocations: 1864)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.9ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 15:52:24.554801', '2023-08-22 15:52:24.554801')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 465 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 465, '2023-08-22 15:52:24.560821', '2023-08-22 15:52:24.560821')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 237 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jpetvo2n15q7rdjov02mziz9ktq1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 237, 291, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.566502' WHERE `books`.`id` = 237[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: jpetvo2n15q7rdjov02mziz9ktq1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 7733bf7b-2d01-4240-a2b9-0bad6281b982) to Test(default) with arguments: #<GlobalID:0x00007f86c63b4b70 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/291>>
Started GET "/books/check_existence?id=237" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"237"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 237 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 15:52:24.586573', '2023-08-22 15:52:24.586573')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 466 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 466, '2023-08-22 15:52:24.593731', '2023-08-22 15:52:24.593731')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 238 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cr45zh1rgs4p2uzo1hq8buaaef3s', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 238, 292, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.599569' WHERE `books`.`id` = 238[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: cr45zh1rgs4p2uzo1hq8buaaef3s (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: dad0cdd1-9f58-4e31-840a-77b08ab8b4ca) to Test(default) with arguments: #<GlobalID:0x00007f86c63cde18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/292>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.4ms | Allocations: 183)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 15:52:24.625041', '2023-08-22 15:52:24.625041')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f86c711e3b0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11010-xs7qbi.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"467"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 467 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 467, '2023-08-22 15:52:24.647084', '2023-08-22 15:52:24.647084', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 239 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xxayb8t0tgpogv3c9syv413t3t9w', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 239, 293, '2023-08-22 15:52:24')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:24.653687' WHERE `books`.`id` = 239[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: xxayb8t0tgpogv3c9syv413t3t9w (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f405c741-1613-4b9b-9826-0caf28114b0d) to Test(default) with arguments: #<GlobalID:0x00007f86c6415510 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/293>>
Completed 200 OK in 19ms (Views: 0.4ms | ActiveRecord: 3.7ms | Allocations: 4250)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/239" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"239"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 239 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 239[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 239[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 293[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 15:52:24.683034', '2023-08-22 15:52:24.683034')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:52:24 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"468"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 468 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 468, '2023-08-22 15:52:24.697772', '2023-08-22 15:52:24.697772', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 240 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 240 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('94hjv1rk5d35eudc4k5cx2m5oiii', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 240, 294, '2023-08-22 15:52:25')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:25.039299' WHERE `books`.`id` = 240[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 94hjv1rk5d35eudc4k5cx2m5oiii (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 671ead64-cc45-475b-9ad3-76795d6cde8a) to Test(default) with arguments: #<GlobalID:0x00007f86c1d212f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/294>>
Completed 200 OK in 352ms (Views: 0.4ms | ActiveRecord: 5.5ms | Allocations: 181368)
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/240" for 127.0.0.1 at 2023-08-23 00:52:25 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"240"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 240 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 240[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 240[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 294[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 15:52:25.068856', '2023-08-22 15:52:25.068856')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 00:52:25 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"469"}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 469 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 12ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 15:52:25.096584', '2023-08-22 15:52:25.096584')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 470 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 470, '2023-08-22 15:52:25.102860', '2023-08-22 15:52:25.102860')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 241 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rr1beo527vsu87mb67wr19byq5c7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 241, 295, '2023-08-22 15:52:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:25.109286' WHERE `books`.`id` = 241[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: rr1beo527vsu87mb67wr19byq5c7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f888fae9-058c-4394-9b73-66f1db54c848) to Test(default) with arguments: #<GlobalID:0x00007f86c6535030 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/295>>
Started PATCH "/books/241" for 127.0.0.1 at 2023-08-23 00:52:25 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007f86c650dc60 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11010-a1qhlh.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"470"}, "id"=>"241"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 470 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 241 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 470 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 241 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 241 LIMIT 1[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 15:52:25.129781', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 241[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 241 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.5ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 295[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('6r44rc7cddgyjsqqsiejojt58aza', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 15:52:25')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 241, 296, '2023-08-22 15:52:25')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 15:52:25.136406' WHERE `books`.`id` = 241[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 6r44rc7cddgyjsqqsiejojt58aza (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 295 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: d1348080-a121-40ad-bb1c-df60efa076d9) to Test(default) with arguments: #<GlobalID:0x00007f86c72541f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/295>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0c9a1243-7181-444a-a020-ca2e69d5dfad) to Test(default) with arguments: #<GlobalID:0x00007f86c724d290 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/296>>
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 4.5ms | Allocations: 5802)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:06:53.708605', '2023-08-22 16:06:53.708605')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 471 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 471, '2023-08-22 16:06:53.822750', '2023-08-22 16:06:53.822750')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 242 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('72ldobgp9ujt5oye7am7456btxmz', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 242, 297, '2023-08-22 16:06:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:53.828579' WHERE `books`.`id` = 242[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.9ms) [0m[32mUploaded file to key: 72ldobgp9ujt5oye7am7456btxmz (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4fbf1c51-5ce5-4278-9932-56a4b58289cb) to Test(default) with arguments: #<GlobalID:0x00007feaf3aef048 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/297>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 471 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 471, '2023-08-22 16:06:53.841067', '2023-08-22 16:06:53.841067')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 243 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xpqjamdhj14p244eedgnv5zkte2r', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 243, 298, '2023-08-22 16:06:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:53.848265' WHERE `books`.`id` = 243[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: xpqjamdhj14p244eedgnv5zkte2r (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a1c1b862-9f3c-4943-90b8-117abbc16c1e) to Test(default) with arguments: #<GlobalID:0x00007feaf8096df8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/298>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 471 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 471, '2023-08-22 16:06:53.856028', '2023-08-22 16:06:53.856028')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 244 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('g1mutdmys2n3zc2qq7tnrl4u0g0k', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 244, 299, '2023-08-22 16:06:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:53.864217' WHERE `books`.`id` = 244[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: g1mutdmys2n3zc2qq7tnrl4u0g0k (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 90a9c4a2-e1af-4ca4-adfd-d3729b62f580) to Test(default) with arguments: #<GlobalID:0x00007feaf3c1a670 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/299>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 01:06:53 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (242, 243, 244)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (242, 243, 244)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (297, 298, 299)[0m
Completed 200 OK in 28ms (Views: 0.4ms | ActiveRecord: 2.9ms | Allocations: 10697)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:06:53.937202', '2023-08-22 16:06:53.937202')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 472 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 472, '2023-08-22 16:06:53.943637', '2023-08-22 16:06:53.943637')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 245 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rcpjidunr39x5hll8aikiblrtkf1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 245, 300, '2023-08-22 16:06:53')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:53.950851' WHERE `books`.`id` = 245[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: rcpjidunr39x5hll8aikiblrtkf1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8e3c72f2-65e3-429b-a918-6fd74f5f2276) to Test(default) with arguments: #<GlobalID:0x00007feaefb21268 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/300>>
Started GET "/books/245" for 127.0.0.1 at 2023-08-23 01:06:53 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"245"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 245 LIMIT 1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 245[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 245[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 300[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 01:06:53 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.0ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 16:06:53.992601', '2023-08-22 16:06:53.992601')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 473 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 473, '2023-08-22 16:06:53.999768', '2023-08-22 16:06:53.999768')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 246 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2rcc67sj58ro57ev1mxn18lw3mrt', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 246, 301, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.007876' WHERE `books`.`id` = 246[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 2rcc67sj58ro57ev1mxn18lw3mrt (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0e211e82-2c0a-46cf-834e-6fe1f62ee628) to Test(default) with arguments: #<GlobalID:0x00007feaefb53b00 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/301>>
Started GET "/books/check_existence?id=246" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"246"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 246 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.4ms | Allocations: 334)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 16:06:54.028951', '2023-08-22 16:06:54.028951')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 474 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 474, '2023-08-22 16:06:54.034671', '2023-08-22 16:06:54.034671')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 247 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r3whhew4neq4no5n94j0ealwh2qk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 247, 302, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.041999' WHERE `books`.`id` = 247[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: r3whhew4neq4no5n94j0ealwh2qk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: cb39caea-5710-4e26-96ae-ff02f1371cfd) to Test(default) with arguments: #<GlobalID:0x00007feaf8550cb8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/302>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.6ms | Allocations: 183)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 16:06:54.065355', '2023-08-22 16:06:54.065355')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007feaf50691f8 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11421-dk106o.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"475"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 475 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 475, '2023-08-22 16:06:54.091455', '2023-08-22 16:06:54.091455', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 248 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5uu8itgkfjh63lkldeajyvafl50v', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 248, 303, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.099507' WHERE `books`.`id` = 248[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 5uu8itgkfjh63lkldeajyvafl50v (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 77ec1b05-9f63-49d3-b256-a4d7a16c1fe3) to Test(default) with arguments: #<GlobalID:0x00007feaefbc8388 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/303>>
Completed 200 OK in 21ms (Views: 0.4ms | ActiveRecord: 4.1ms | Allocations: 4249)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/248" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"248"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 248 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 248[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 248[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 303[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 1736)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 16:06:54.132288', '2023-08-22 16:06:54.132288')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"476"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 476 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 476, '2023-08-22 16:06:54.148295', '2023-08-22 16:06:54.148295', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 249 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 249 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xuicfypatzvvgrhss13jnqazazmo', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 249, 304, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.457982' WHERE `books`.`id` = 249[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: xuicfypatzvvgrhss13jnqazazmo (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e5f25c74-bace-4b9c-be29-3c263624949e) to Test(default) with arguments: #<GlobalID:0x00007feaf03f41b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/304>>
Completed 200 OK in 319ms (Views: 0.4ms | ActiveRecord: 4.8ms | Allocations: 181379)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/249" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"249"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 249 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 249[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 249[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 304[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 16:06:54.485342', '2023-08-22 16:06:54.485342')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"477"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 477 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 12ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 16:06:54.511902', '2023-08-22 16:06:54.511902')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 478 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 478, '2023-08-22 16:06:54.517635', '2023-08-22 16:06:54.517635')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 250 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('6hj47on0rzv2heg6iba1lcbr4tm6', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 250, 305, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.524258' WHERE `books`.`id` = 250[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 6hj47on0rzv2heg6iba1lcbr4tm6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c9924d7b-ffd5-473c-95a6-d4f0b6f8278f) to Test(default) with arguments: #<GlobalID:0x00007feafb0cc1f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/305>>
Started PATCH "/books/250" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007feafb104d78 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11421-3453h.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"478"}, "id"=>"250"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 478 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 250 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 478 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 250 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 250 LIMIT 1[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 16:06:54.545165', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 250[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 250 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.4ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 305[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xpa1lw22cl6azssjbvm6w3uc4kzc', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 250, 306, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.551688' WHERE `books`.`id` = 250[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: xpa1lw22cl6azssjbvm6w3uc4kzc (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 305 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 5463d7ad-65d3-4616-a637-009c6f6c2d48) to Test(default) with arguments: #<GlobalID:0x00007feafb157758 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/305>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 51880bb9-4016-4b28-964b-cb901072aac0) to Test(default) with arguments: #<GlobalID:0x00007feafb1547d8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/306>>
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 5.2ms | Allocations: 5790)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 16:06:54.566172', '2023-08-22 16:06:54.566172')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 479 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 479, '2023-08-22 16:06:54.573199', '2023-08-22 16:06:54.573199')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 251 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('96dg77d2vity8gvcqqc4jeg5b8fr', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:06:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 251, 307, '2023-08-22 16:06:54')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:06:54.578477' WHERE `books`.`id` = 251[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: 96dg77d2vity8gvcqqc4jeg5b8fr (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: da526fc8-b160-470f-8cb5-4bcc0308d6a5) to Test(default) with arguments: #<GlobalID:0x00007feaf5890e58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/307>>
Started PATCH "/books/251" for 127.0.0.1 at 2023-08-23 01:06:54 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"479"}, "id"=>"251"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 479 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 251 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 479 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 251 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 307 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' AND `books`.`id` != 251 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1828)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:07:04.471882', '2023-08-22 16:07:04.471882')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 480 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 480, '2023-08-22 16:07:04.579312', '2023-08-22 16:07:04.579312')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 252 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ofy4hjd5dmjve5fs0mkgoqt9rfi4', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 252, 308, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.586188' WHERE `books`.`id` = 252[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: ofy4hjd5dmjve5fs0mkgoqt9rfi4 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 32408d0e-ee5d-4221-ba69-d624db4cbc39) to Test(default) with arguments: #<GlobalID:0x00007ff6e71b07e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/308>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 480 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 480, '2023-08-22 16:07:04.597048', '2023-08-22 16:07:04.597048')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 253 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('47rpi6rftvdqa1p6xb9pisjidlb9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 253, 309, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.603994' WHERE `books`.`id` = 253[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 47rpi6rftvdqa1p6xb9pisjidlb9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 77d904a0-326e-444b-8543-7389045412aa) to Test(default) with arguments: #<GlobalID:0x00007ff6e1c6a838 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/309>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 480 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 480, '2023-08-22 16:07:04.611732', '2023-08-22 16:07:04.611732')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 254 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('dcuh77dvdjm31l0ra1k4j0yylxp7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 254, 310, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.617949' WHERE `books`.`id` = 254[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: dcuh77dvdjm31l0ra1k4j0yylxp7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a3d7ace5-ed91-4af2-a311-0a0e89d9c436) to Test(default) with arguments: #<GlobalID:0x00007ff6e71e8e68 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/310>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (252, 253, 254)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (252, 253, 254)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (308, 309, 310)[0m
Completed 200 OK in 24ms (Views: 0.5ms | ActiveRecord: 3.4ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:07:04.680021', '2023-08-22 16:07:04.680021')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 481 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 481, '2023-08-22 16:07:04.685973', '2023-08-22 16:07:04.685973')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 255 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('eggbhrjdots644iz6y82j5olt7x7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 255, 311, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.691717' WHERE `books`.`id` = 255[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: eggbhrjdots644iz6y82j5olt7x7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b14a2bee-322d-414e-b0e6-6e86c0ac41a0) to Test(default) with arguments: #<GlobalID:0x00007ff6e719f6a0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/311>>
Started GET "/books/255" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"255"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 255 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 255[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 255[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 311[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.9ms | Allocations: 671)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 16:07:04.730262', '2023-08-22 16:07:04.730262')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 482 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 482, '2023-08-22 16:07:04.736502', '2023-08-22 16:07:04.736502')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 256 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qq047njqamyb1uhkz512u0neqa9m', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 256, 312, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.742088' WHERE `books`.`id` = 256[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: qq047njqamyb1uhkz512u0neqa9m (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6f73cc96-8ed3-4b8e-ad93-821ea5754214) to Test(default) with arguments: #<GlobalID:0x00007ff6e71a4d30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/312>>
Started GET "/books/check_existence?id=256" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"256"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 256 LIMIT 1[0m
Completed 200 OK in 2ms (ActiveRecord: 0.7ms | Allocations: 334)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 16:07:04.759740', '2023-08-22 16:07:04.759740')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 483 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 483, '2023-08-22 16:07:04.766441', '2023-08-22 16:07:04.766441')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 257 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('72vynib6dolo8ojx18drsrelh13f', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 257, 313, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.2ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.770617' WHERE `books`.`id` = 257[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 72vynib6dolo8ojx18drsrelh13f (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e8edda63-8719-42dc-85f4-dfd7bc9b5d21) to Test(default) with arguments: #<GlobalID:0x00007ff6dee09e30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/313>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 16:07:04.789679', '2023-08-22 16:07:04.789679')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007ff6e7236370 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11450-59c2ys.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"484"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 484 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 484, '2023-08-22 16:07:04.809818', '2023-08-22 16:07:04.809818', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 258 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('19cguy915uo18khqoew9ryztpneg', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:04')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 258, 314, '2023-08-22 16:07:04')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:04.815185' WHERE `books`.`id` = 258[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 19cguy915uo18khqoew9ryztpneg (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fafa3d0c-4c4c-45ee-a4dd-b1527a5c655c) to Test(default) with arguments: #<GlobalID:0x00007ff6e7239570 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/314>>
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 4249)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/258" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"258"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 258 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 258[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 258[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 314[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 16:07:04.839927', '2023-08-22 16:07:04.839927')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:07:04 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"485"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 485 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 485, '2023-08-22 16:07:04.853734', '2023-08-22 16:07:04.853734', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 259 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 259 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('aegouu6kue8h9vem7vq5tru89zk6', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 259, 315, '2023-08-22 16:07:05')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:05.082821' WHERE `books`.`id` = 259[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: aegouu6kue8h9vem7vq5tru89zk6 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d14946da-461f-4f6d-a63d-9c700ad3d3d2) to Test(default) with arguments: #<GlobalID:0x00007ff6e73f2998 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/315>>
Completed 200 OK in 237ms (Views: 0.4ms | ActiveRecord: 3.7ms | Allocations: 181378)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/259" for 127.0.0.1 at 2023-08-23 01:07:05 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"259"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 259 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 259[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 259[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 315[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 16:07:05.109151', '2023-08-22 16:07:05.109151')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:07:05 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"486"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 486 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 9ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 16:07:05.132985', '2023-08-22 16:07:05.132985')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 487 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 487, '2023-08-22 16:07:05.138906', '2023-08-22 16:07:05.138906')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 260 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('i7gs0h9eigbt7hholk8mjofm2t01', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 260, 316, '2023-08-22 16:07:05')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:05.144604' WHERE `books`.`id` = 260[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: i7gs0h9eigbt7hholk8mjofm2t01 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c426b442-4e1d-4579-8d22-9836aa473dcf) to Test(default) with arguments: #<GlobalID:0x00007ff6e26abf40 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/316>>
Started PATCH "/books/260" for 127.0.0.1 at 2023-08-23 01:07:05 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007ff6dee907f0 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11450-ik330b.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"487"}, "id"=>"260"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 487 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 260 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 487 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 260 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 260 LIMIT 1[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 16:07:05.165169', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 260[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 260 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 316[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0iej4av72r8snypb1tsikxnlas8y', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 260, 317, '2023-08-22 16:07:05')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:05.171666' WHERE `books`.`id` = 260[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 0iej4av72r8snypb1tsikxnlas8y (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 316 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 8eb814a5-5b88-447b-842f-f7b2c00ff497) to Test(default) with arguments: #<GlobalID:0x00007ff6e2700fb8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/316>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8cec1df2-4c7e-4eb0-aeb0-8ba5557dd098) to Test(default) with arguments: #<GlobalID:0x00007ff6e26fa0c8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/317>>
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 4.2ms | Allocations: 5802)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 16:07:05.183430', '2023-08-22 16:07:05.183430')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 488 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 488, '2023-08-22 16:07:05.189337', '2023-08-22 16:07:05.189337')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 261 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('tpvom4e7rehp292gvjo4jqwyeio5', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:05')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 261, 318, '2023-08-22 16:07:05')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:05.196689' WHERE `books`.`id` = 261[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: tpvom4e7rehp292gvjo4jqwyeio5 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 188d4239-7134-4e2b-8fb7-79690f0d4d1f) to Test(default) with arguments: #<GlobalID:0x00007ff6e278aa10 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/318>>
Started PATCH "/books/261" for 127.0.0.1 at 2023-08-23 01:07:05 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"488"}, "id"=>"261"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 488 LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 261 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 488 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 261 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 318 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' AND `books`.`id` != 261 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 1821)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:07:12.127541', '2023-08-22 16:07:12.127541')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 489 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 489, '2023-08-22 16:07:12.235168', '2023-08-22 16:07:12.235168')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 262 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xng14rd0ip6zxmce1mh5dtfuce3y', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:07:12')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 262, 319, '2023-08-22 16:07:12')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:07:12.241894' WHERE `books`.`id` = 262[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: xng14rd0ip6zxmce1mh5dtfuce3y (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f8bfb584-7442-46f9-bba0-c7ec7d49dc08) to Test(default) with arguments: #<GlobalID:0x00007fcf19560cf8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/319>>
Started PATCH "/books/262" for 127.0.0.1 at 2023-08-23 01:07:12 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"489"}, "id"=>"262"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 489 LIMIT 1[0m
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 262 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 489 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 262 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 319 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' AND `books`.`id` != 262 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 14ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 5805)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:08:28.789626', '2023-08-22 16:08:28.789626')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 490 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 490, '2023-08-22 16:08:28.888584', '2023-08-22 16:08:28.888584')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 263 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wvb20zfjk2nnyd222f0bdboyfk2p', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 263, 320, '2023-08-22 16:08:28')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:28.894551' WHERE `books`.`id` = 263[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (3.3ms) [0m[32mUploaded file to key: wvb20zfjk2nnyd222f0bdboyfk2p (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d5cd34a7-7a2f-4e21-a1bc-4f455949ee5c) to Test(default) with arguments: #<GlobalID:0x00007fc2d325ff10 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/320>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 490 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 490, '2023-08-22 16:08:28.906018', '2023-08-22 16:08:28.906018')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 264 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ssqkanvgm7k6c06p0fno8rbglrrs', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 264, 321, '2023-08-22 16:08:28')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:28.911912' WHERE `books`.`id` = 264[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: ssqkanvgm7k6c06p0fno8rbglrrs (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e3cdfd02-d107-44cd-9126-41636ed5d042) to Test(default) with arguments: #<GlobalID:0x00007fc2d2b8e740 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/321>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 490 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 490, '2023-08-22 16:08:28.919018', '2023-08-22 16:08:28.919018')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 265 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r8frlwry3veuygrk6gldlyrr99lg', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 265, 322, '2023-08-22 16:08:28')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:28.923779' WHERE `books`.`id` = 265[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: r8frlwry3veuygrk6gldlyrr99lg (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 06f6172b-3362-4687-bba0-3f9b43742dad) to Test(default) with arguments: #<GlobalID:0x00007fc2d1e17fd0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/322>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 01:08:28 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (263, 264, 265)[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (263, 264, 265)[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (320, 321, 322)[0m
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 10695)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:08:28.976313', '2023-08-22 16:08:28.976313')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 491 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 491, '2023-08-22 16:08:28.981252', '2023-08-22 16:08:28.981252')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 266 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qok60yxq9ntnsznbhcxr93u0tyh0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:28')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 266, 323, '2023-08-22 16:08:28')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:28.987136' WHERE `books`.`id` = 266[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: qok60yxq9ntnsznbhcxr93u0tyh0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 3c8450a7-fbff-472d-9105-f29c3b52e84e) to Test(default) with arguments: #<GlobalID:0x00007fc2d34811e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/323>>
Started GET "/books/266" for 127.0.0.1 at 2023-08-23 01:08:28 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"266"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 266 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 266[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 266[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 323[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 0.9ms | Allocations: 671)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 16:08:29.026730', '2023-08-22 16:08:29.026730')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 492 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 492, '2023-08-22 16:08:29.033045', '2023-08-22 16:08:29.033045')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 267 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('aa9eco3h6lvjoiacih2b3kab4ke1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 267, 324, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.039011' WHERE `books`.`id` = 267[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: aa9eco3h6lvjoiacih2b3kab4ke1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5a616a09-7022-4501-af5e-e4e7dd809b0e) to Test(default) with arguments: #<GlobalID:0x00007fc2ced53ae8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/324>>
Started GET "/books/check_existence?id=267" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"267"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 267 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 16:08:29.058480', '2023-08-22 16:08:29.058480')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 493 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 493, '2023-08-22 16:08:29.064575', '2023-08-22 16:08:29.064575')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 268 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('g0rw8bjo6ix1c253u0ye2m5v35ou', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 268, 325, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.071050' WHERE `books`.`id` = 268[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: g0rw8bjo6ix1c253u0ye2m5v35ou (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fe6f8fb8-d42e-4746-b6ae-5253e1058f03) to Test(default) with arguments: #<GlobalID:0x00007fc2d2dc48e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/325>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 16:08:29.092475', '2023-08-22 16:08:29.092475')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fc2d34c4e68 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11594-swcry7.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"494"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 494 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 494, '2023-08-22 16:08:29.114763', '2023-08-22 16:08:29.114763', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 269 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('sber7572kjsikyr9bbhicjk48rha', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 269, 326, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.120745' WHERE `books`.`id` = 269[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: sber7572kjsikyr9bbhicjk48rha (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f41f82ef-352b-41e0-8059-5ef823268369) to Test(default) with arguments: #<GlobalID:0x00007fc2d2ddff58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/326>>
Completed 200 OK in 17ms (Views: 0.5ms | ActiveRecord: 3.7ms | Allocations: 4252)
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/269" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"269"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 269 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 269[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 269[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 326[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 1736)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 16:08:29.147871', '2023-08-22 16:08:29.147871')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"495"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 495 LIMIT 1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 495, '2023-08-22 16:08:29.164023', '2023-08-22 16:08:29.164023', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 270 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 270 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('7udz5wwygt5emayomyr6dbeun3m2', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 270, 327, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.452125' WHERE `books`.`id` = 270[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: 7udz5wwygt5emayomyr6dbeun3m2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 610258c2-d39c-49dd-8ce1-b26d5873be49) to Test(default) with arguments: #<GlobalID:0x00007fc2cee42df0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/327>>
Completed 200 OK in 298ms (Views: 0.3ms | ActiveRecord: 5.0ms | Allocations: 181364)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/270" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"270"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 270 LIMIT 1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 270[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 270[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 327[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 16:08:29.478761', '2023-08-22 16:08:29.478761')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"496"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 496 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 10ms (Views: 0.1ms | ActiveRecord: 1.6ms | Allocations: 3381)
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 16:08:29.503508', '2023-08-22 16:08:29.503508')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 497 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 497, '2023-08-22 16:08:29.508792', '2023-08-22 16:08:29.508792')[0m
  [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 271 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rnl6biru01okgp57xz614pp8gnfx', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 271, 328, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.514813' WHERE `books`.`id` = 271[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: rnl6biru01okgp57xz614pp8gnfx (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b1c91c43-f18e-4288-8509-f3ca26b1c8b1) to Test(default) with arguments: #<GlobalID:0x00007fc2cef4b198 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/328>>
Started PATCH "/books/271" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fc2d2073c98 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11594-x0c8zu.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"497"}, "id"=>"271"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 497 LIMIT 1[0m
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 271 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 497 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 271 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 271 LIMIT 1[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 16:08:29.534627', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 271[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 271 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 328[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('v2pz2ycy5ipe1sod8s15w7ggph82', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 271, 329, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.542625' WHERE `books`.`id` = 271[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: v2pz2ycy5ipe1sod8s15w7ggph82 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 328 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 1eafe904-6ba4-43ec-b275-06874a7327a4) to Test(default) with arguments: #<GlobalID:0x00007fc2d388a3e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/328>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 47229949-24fb-4c96-b73a-435a80c1b2f8) to Test(default) with arguments: #<GlobalID:0x00007fc2d38834f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/329>>
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 4.8ms | Allocations: 5801)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 16:08:29.554083', '2023-08-22 16:08:29.554083')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 498 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 498, '2023-08-22 16:08:29.560384', '2023-08-22 16:08:29.560384')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 272 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jjz3572kihcyil09gi3qupu0ujmx', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:08:29')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 272, 330, '2023-08-22 16:08:29')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:08:29.567195' WHERE `books`.`id` = 272[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: jjz3572kihcyil09gi3qupu0ujmx (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d72941c8-e177-42c1-a363-688ded5b8475) to Test(default) with arguments: #<GlobalID:0x00007fc2d3913a50 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/330>>
Started PATCH "/books/272" for 127.0.0.1 at 2023-08-23 01:08:29 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"498"}, "id"=>"272"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 498 LIMIT 1[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 272 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 498 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 272 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 330 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' AND `books`.`id` != 272 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 7ms (Views: 0.1ms | ActiveRecord: 2.4ms | Allocations: 1821)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = -1 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('東京二郎', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:09:47.190735', '2023-08-22 16:09:47.190735')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:09:47.195546', '2023-08-22 16:09:47.195546')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 500 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 500, '2023-08-22 16:09:47.297465', '2023-08-22 16:09:47.297465')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 273 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('vxvwvh8u4nvfh6oeko82dg6fl20m', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:09:47')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 273, 331, '2023-08-22 16:09:47')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:09:47.304499' WHERE `books`.`id` = 273[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.9ms) [0m[32mUploaded file to key: vxvwvh8u4nvfh6oeko82dg6fl20m (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ea1f36ec-4db6-4b66-b4cb-219cd683c7da) to Test(default) with arguments: #<GlobalID:0x00007fdc09cbaa88 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/331>>
Started PATCH "/books/273" for 127.0.0.1 at 2023-08-23 01:09:47 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "user_id"=>"499"}, "id"=>"273"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 499 LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 273 LIMIT 1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 500 LIMIT 1[0m
Completed 400 Bad Request in 10ms (Views: 0.3ms | ActiveRecord: 1.3ms | Allocations: 4037)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('東京二郎', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:09:54.317353', '2023-08-22 16:09:54.317353')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:09:54.320980', '2023-08-22 16:09:54.320980')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 502 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 502, '2023-08-22 16:09:54.416141', '2023-08-22 16:09:54.416141')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 274 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xyybaix0uh3ul2nvuh0aw5hcxy9g', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:09:54')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 274, 332, '2023-08-22 16:09:54')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:09:54.424322' WHERE `books`.`id` = 274[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: xyybaix0uh3ul2nvuh0aw5hcxy9g (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2a02ce38-4999-4e15-a47e-40d5889b75aa) to Test(default) with arguments: #<GlobalID:0x00007fb83cba2268 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/332>>
Started PATCH "/books/274" for 127.0.0.1 at 2023-08-23 01:09:54 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "user_id"=>"501"}, "id"=>"274"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 501 LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 274 LIMIT 1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 502 LIMIT 1[0m
Completed 400 Bad Request in 8ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 4037)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:10:03.170270', '2023-08-22 16:10:03.170270')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 503 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 503, '2023-08-22 16:10:03.272222', '2023-08-22 16:10:03.272222')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 275 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2piprxla8hr86i12vk0ykes9cuj1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:10:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 275, 333, '2023-08-22 16:10:03')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:10:03.280036' WHERE `books`.`id` = 275[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: 2piprxla8hr86i12vk0ykes9cuj1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6233655c-dbc5-4121-80d1-b5775aa6b5fa) to Test(default) with arguments: #<GlobalID:0x00007f894a3f7bd8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/333>>
Started PATCH "/books/275" for 127.0.0.1 at 2023-08-23 01:10:03 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"503"}, "id"=>"275"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 503 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 275 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 503 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 275 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 333 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' AND `books`.`id` != 275 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 16ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 5805)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('東京二郎', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:12:44.350230', '2023-08-22 16:12:44.350230')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:12:44.355242', '2023-08-22 16:12:44.355242')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 505 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 505, '2023-08-22 16:12:44.480686', '2023-08-22 16:12:44.480686')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 276 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('x6t38e7e2wp8qnrmmj3z725i4xlv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:44')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 276, 334, '2023-08-22 16:12:44')[0m
  [1m[36mBook Update (1.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:44.487854' WHERE `books`.`id` = 276[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.9ms) [0m[32mUploaded file to key: x6t38e7e2wp8qnrmmj3z725i4xlv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 254c8d90-9943-4f50-9a59-2833657f2d2b) to Test(default) with arguments: #<GlobalID:0x00007fe558f49198 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/334>>
Started PATCH "/books/276" for 127.0.0.1 at 2023-08-23 01:12:44 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "user_id"=>"504"}, "id"=>"276"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 504 LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 276 LIMIT 1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 505 LIMIT 1[0m
Completed 400 Bad Request in 12ms (Views: 0.3ms | ActiveRecord: 1.3ms | Allocations: 4037)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('東京二郎', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:12:52.007898', '2023-08-22 16:12:52.007898')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:12:52.012289', '2023-08-22 16:12:52.012289')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 507 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 507, '2023-08-22 16:12:52.116107', '2023-08-22 16:12:52.116107')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 277 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9tz464e2sei38tiqprlpor1gfiyt', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 277, 335, '2023-08-22 16:12:52')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:52.123224' WHERE `books`.`id` = 277[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: 9tz464e2sei38tiqprlpor1gfiyt (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d2e006f0-23fa-404a-a4b8-e74ae5606a3c) to Test(default) with arguments: #<GlobalID:0x00007f8ff3aefa30 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/335>>
Started PATCH "/books/277" for 127.0.0.1 at 2023-08-23 01:12:52 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "user_id"=>"506"}, "id"=>"277"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 506 LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 277 LIMIT 1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 507 LIMIT 1[0m
Completed 400 Bad Request in 8ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 4037)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:12:57.557539', '2023-08-22 16:12:57.557539')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 508 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 508, '2023-08-22 16:12:57.664013', '2023-08-22 16:12:57.664013')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 278 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('23xm5j02gochxsxaw2suott5ye11', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 278, 336, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.672164' WHERE `books`.`id` = 278[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: 23xm5j02gochxsxaw2suott5ye11 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2f3caa3a-0ed3-4206-8204-cbef7ddfeebc) to Test(default) with arguments: #<GlobalID:0x00007fa8712f6ba8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/336>>
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 508 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 508, '2023-08-22 16:12:57.683082', '2023-08-22 16:12:57.683082')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 279 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.7ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r5pbpjobtqip8qcx5r81bgnzz9si', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 279, 337, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.689868' WHERE `books`.`id` = 279[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: r5pbpjobtqip8qcx5r81bgnzz9si (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 43bbd71c-5927-4c4f-b9d0-c65e199a1cca) to Test(default) with arguments: #<GlobalID:0x00007fa870bfe008 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/337>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 508 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書3' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書3', '東京太郎', '東京出版', 'その他', 508, '2023-08-22 16:12:57.698441', '2023-08-22 16:12:57.698441')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 280 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('fgubsjdimj2zhryhlu84d8xe0o8m', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 280, 338, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.704025' WHERE `books`.`id` = 280[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: fgubsjdimj2zhryhlu84d8xe0o8m (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d7a9d7e6-f999-4489-8283-da4722770069) to Test(default) with arguments: #<GlobalID:0x00007fa874324fa0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/338>>
Started GET "/books?current_user_id=1" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#index as HTML
  Parameters: {"current_user_id"=>"1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 1) AS check_favorite FROM `books`[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` IN (278, 279, 280)[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` IN (278, 279, 280)[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` IN (336, 337, 338)[0m
Completed 200 OK in 25ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 10696)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:12:57.765548', '2023-08-22 16:12:57.765548')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 509 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 509, '2023-08-22 16:12:57.772104', '2023-08-22 16:12:57.772104')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 281 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('oo3nrf1xa0c26kwzmt87e8ol3nao', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 281, 339, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.777441' WHERE `books`.`id` = 281[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: oo3nrf1xa0c26kwzmt87e8ol3nao (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f61f7627-b454-4b06-a051-b4edd89bde35) to Test(default) with arguments: #<GlobalID:0x00007fa86fde4058 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/339>>
Started GET "/books/281" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"281"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 281 LIMIT 1[0m
  [1m[36mReview Load (0.6ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 281[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 281[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 339[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 1864)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/-1" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 3ms (ActiveRecord: 1.0ms | Allocations: 671)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 16:12:57.819241', '2023-08-22 16:12:57.819241')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 510 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 510, '2023-08-22 16:12:57.827229', '2023-08-22 16:12:57.827229')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 282 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('imku25ajsgjy962oiv29yiave8c8', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 282, 340, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.833573' WHERE `books`.`id` = 282[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: imku25ajsgjy962oiv29yiave8c8 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: ff6f3114-726a-41e0-be85-ba0a1f20e6dd) to Test(default) with arguments: #<GlobalID:0x00007fa86fe2e928 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/340>>
Started GET "/books/check_existence?id=282" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"282"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 282 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.5ms | Allocations: 334)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 16:12:57.852380', '2023-08-22 16:12:57.852380')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 511 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 511, '2023-08-22 16:12:57.859085', '2023-08-22 16:12:57.859085')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 283 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0ovuz7uaajyyticjdwhlriwvb3ty', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 283, 341, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.864913' WHERE `books`.`id` = 283[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: 0ovuz7uaajyyticjdwhlriwvb3ty (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 304c6aa4-d1cb-4481-8bfd-b061d81486d2) to Test(default) with arguments: #<GlobalID:0x00007fa871717890 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/341>>
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 183)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 16:12:57.890354', '2023-08-22 16:12:57.890354')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fa871737e88 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11950-9wrihy.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"512"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 512 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 512, '2023-08-22 16:12:57.911029', '2023-08-22 16:12:57.911029', '国語の参考書')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 284 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jilrmwjupu6i067esu1oqqzme5ln', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 284, 342, '2023-08-22 16:12:57')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:57.916172' WHERE `books`.`id` = 284[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: jilrmwjupu6i067esu1oqqzme5ln (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f425afd2-c0ac-41a6-8c4e-2b6e670143da) to Test(default) with arguments: #<GlobalID:0x00007fa86fe870f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/342>>
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 4245)
  [1m[35m (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/284" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"284"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 284 LIMIT 1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 284[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 284[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 342[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1736)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa6@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎6', 'kanagawa6@sample.com', 'kanakana12346', '2023-08-22 16:12:57.943600', '2023-08-22 16:12:57.943600')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:12:57 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"参考書1", "author"=>"東京太郎", "publisher"=>"東京出版", "subject"=>"国語", "description"=>"国語の参考書", "user_id"=>"513"}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 513 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`, `description`) VALUES ('参考書1', '東京太郎', '東京出版', '国語', 513, '2023-08-22 16:12:57.958601', '2023-08-22 16:12:57.958601', '国語の参考書')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.7ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 285 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' AND `books`.`id` != 285 LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('o6454ismd8glos8dvcfmujq6p52n', 'default_image.jpg', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:58')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 285, 343, '2023-08-22 16:12:58')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:58.269656' WHERE `books`.`id` = 285[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: o6454ismd8glos8dvcfmujq6p52n (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f9a01764-42dc-4762-94f1-440b9398ce73) to Test(default) with arguments: #<GlobalID:0x00007fa874749e78 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/343>>
Completed 200 OK in 321ms (Views: 0.4ms | ActiveRecord: 4.9ms | Allocations: 181374)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started GET "/books/285" for 127.0.0.1 at 2023-08-23 01:12:58 +0900
Processing by BooksController#show as HTML
  Parameters: {"id"=>"285"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM questions WHERE questions.book_id = books.id) AS questions_count FROM `books` WHERE `books`.`id` = 285 LIMIT 1[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 285[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 285[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 343[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 1775)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa7@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎7', 'kanagawa7@sample.com', 'kanakana12347', '2023-08-22 16:12:58.301757', '2023-08-22 16:12:58.301757')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2023-08-23 01:12:58 +0900
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"514"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 514 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 11ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 3381)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa8@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎8', 'kanagawa8@sample.com', 'kanakana12348', '2023-08-22 16:12:58.329804', '2023-08-22 16:12:58.329804')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 515 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 515, '2023-08-22 16:12:58.335178', '2023-08-22 16:12:58.335178')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 286 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('r47gs0wmft8ayee92u97n25o0nb4', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:58')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 286, 344, '2023-08-22 16:12:58')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:58.341701' WHERE `books`.`id` = 286[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.7ms) [0m[32mUploaded file to key: r47gs0wmft8ayee92u97n25o0nb4 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c7ce6cd9-2439-4d52-9996-e7b5053995b4) to Test(default) with arguments: #<GlobalID:0x00007fa87b107e00 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/344>>
Started PATCH "/books/286" for 127.0.0.1 at 2023-08-23 01:12:58 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "description"=>"英語の参考書", "image"=>#<ActionDispatch::Http::UploadedFile:0x00007fa87b0e4a68 @tempfile=#<Tempfile:/var/folders/yt/n2c9x7ss2hl4j9xj69nspgsm0000gn/T/RackMultipart20230823-11950-msqhyw.png>, @original_filename="no_image.png", @content_type="image/png", @headers="content-disposition: form-data; name=\"book[image]\"; filename=\"no_image.png\"\r\ncontent-type: image/png\r\ncontent-length: 6027\r\n">, "user_id"=>"515"}, "id"=>"286"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 515 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 286 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 515 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` INNER JOIN `active_storage_attachments` ON `active_storage_blobs`.`id` = `active_storage_attachments`.`blob_id` WHERE `active_storage_attachments`.`record_id` = 286 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' AND `books`.`id` != 286 LIMIT 1[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`name` = '参考書2', `books`.`author` = '神奈川一郎', `books`.`publisher` = '神奈川書房', `books`.`subject` = '英語', `books`.`updated_at` = '2023-08-22 16:12:58.362498', `books`.`description` = '英語の参考書' WHERE `books`.`id` = 286[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 286 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 344[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('mebnryo49ob1a0vva9zk3vi4ezu1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:58')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 286, 345, '2023-08-22 16:12:58')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:58.369536' WHERE `books`.`id` = 286[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: mebnryo49ob1a0vva9zk3vi4ezu1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 344 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 880c3106-a930-45fc-8144-592e3201bba7) to Test(default) with arguments: #<GlobalID:0x00007fa87a91ea68 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/344>>
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c6ab7d68-8ec2-42f7-992a-f00791b3b887) to Test(default) with arguments: #<GlobalID:0x00007fa87a917c40 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/345>>
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 5.1ms | Allocations: 5805)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa9@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎9', 'kanagawa9@sample.com', 'kanakana12349', '2023-08-22 16:12:58.381108', '2023-08-22 16:12:58.381108')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 516 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 516, '2023-08-22 16:12:58.386448', '2023-08-22 16:12:58.386448')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 287 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('9fh6c7nn7tigl5za251u0sxk9evn', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:58')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 287, 346, '2023-08-22 16:12:58')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:58.393258' WHERE `books`.`id` = 287[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: 9fh6c7nn7tigl5za251u0sxk9evn (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bc4db578-0767-4548-994e-58d950c81837) to Test(default) with arguments: #<GlobalID:0x00007fa87b164290 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/346>>
Started PATCH "/books/287" for 127.0.0.1 at 2023-08-23 01:12:58 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"", "author"=>"", "subject"=>"", "user_id"=>"516"}, "id"=>"287"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 516 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 287 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 516 LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 287 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 346 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '' AND `books`.`id` != 287 LIMIT 1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 400 Bad Request in 8ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 1821)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa10@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('東京二郎', 'kanagawa10@sample.com', 'kanakana123410', '2023-08-22 16:12:58.417101', '2023-08-22 16:12:58.417101')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa11@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎10', 'kanagawa11@sample.com', 'kanakana123411', '2023-08-22 16:12:58.421495', '2023-08-22 16:12:58.421495')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 518 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 518, '2023-08-22 16:12:58.428570', '2023-08-22 16:12:58.428570')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 288 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('612szqcj3r5u3ffhvom80txehyof', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:12:58')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 288, 347, '2023-08-22 16:12:58')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:12:58.435064' WHERE `books`.`id` = 288[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 612szqcj3r5u3ffhvom80txehyof (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 702f69cd-84a9-4ed1-8ca4-e71b1e78c813) to Test(default) with arguments: #<GlobalID:0x00007fa87aa1f728 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/347>>
Started PATCH "/books/288" for 127.0.0.1 at 2023-08-23 01:12:58 +0900
Processing by BooksController#update as HTML
  Parameters: {"book"=>{"name"=>"参考書2", "author"=>"神奈川一郎", "publisher"=>"神奈川書房", "subject"=>"英語", "user_id"=>"517"}, "id"=>"288"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 517 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 288 LIMIT 1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 518 LIMIT 1[0m
Completed 400 Bad Request in 3ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 552)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:20:12.968765', '2023-08-22 16:20:12.968765')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 519 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 519, '2023-08-22 16:20:13.059498', '2023-08-22 16:20:13.059498')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 289 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('cuoiqa9crtb1uu6cescn69vud1wi', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:20:13')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 289, 348, '2023-08-22 16:20:13')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:20:13.066415' WHERE `books`.`id` = 289[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: cuoiqa9crtb1uu6cescn69vud1wi (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f14accfb-a6a1-43d9-936c-81bcc2f391bd) to Test(default) with arguments: #<GlobalID:0x00007fcacd86a598 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/348>>
Started DELETE "/books/289" for 127.0.0.1 at 2023-08-23 01:20:13 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"289"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 289 LIMIT 1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 519 LIMIT 1[0m
Completed 400 Bad Request in 7ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 3978)
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:57:47.834414', '2023-08-22 16:57:47.834414')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 520 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 520, '2023-08-22 16:57:47.955110', '2023-08-22 16:57:47.955110')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 290 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('qvg49ntcbk8f0toc8f5j0n0nuxqc', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:57:47')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 290, 349, '2023-08-22 16:57:47')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:57:47.962131' WHERE `books`.`id` = 290[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.0ms) [0m[32mUploaded file to key: qvg49ntcbk8f0toc8f5j0n0nuxqc (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 850400ce-a202-41fa-910d-5845d3e8a615) to Test(default) with arguments: #<GlobalID:0x00007f835d659f18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/349>>
Started DELETE "/books/290" for 127.0.0.1 at 2023-08-23 01:57:47 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"current_user_id"=>"520", "id"=>"290"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 520 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 290 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 520 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 290[0m
  [1m[36mQuestion Load (0.5ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`book_id` = 290[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 290[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 290 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.3ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 349[0m
  [1m[36mBook Destroy (0.3ms)[0m  [1m[31mDELETE FROM `books` WHERE `books`.`id` = 290[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 349 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 18ad97ca-b5b0-4e4c-b701-a877d5c74d15) to Test(default) with arguments: #<GlobalID:0x00007f8365be6550 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/349>>
Completed 204 No Content in 43ms (ActiveRecord: 8.2ms | Allocations: 16725)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:57:48.062364', '2023-08-22 16:57:48.062364')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 521 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 521, '2023-08-22 16:57:48.067621', '2023-08-22 16:57:48.067621')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 291 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rs8f6rcbj4pz6c3kk2jilbmqsw57', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:57:48')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 291, 350, '2023-08-22 16:57:48')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:57:48.074504' WHERE `books`.`id` = 291[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: rs8f6rcbj4pz6c3kk2jilbmqsw57 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6425ad8f-975b-4b0b-8ebc-f7503def54b6) to Test(default) with arguments: #<GlobalID:0x00007f835eccd2e0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/350>>
Started DELETE "/books/291" for 127.0.0.1 at 2023-08-23 01:57:48 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"291"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 291 LIMIT 1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 521 LIMIT 1[0m
Completed 400 Bad Request in 4ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 719)
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 16:59:09.222617', '2023-08-22 16:59:09.222617')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 522 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 522, '2023-08-22 16:59:09.327050', '2023-08-22 16:59:09.327050')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 292 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('4qdqzv5agumfczg7yzk14ta6ryj0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:59:09')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 292, 351, '2023-08-22 16:59:09')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:59:09.334468' WHERE `books`.`id` = 292[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: 4qdqzv5agumfczg7yzk14ta6ryj0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5385f02f-b727-44b4-9248-cd45da3e51d8) to Test(default) with arguments: #<GlobalID:0x00007fca4c4ceed8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/351>>
  [1m[35m (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started DELETE "/books/292" for 127.0.0.1 at 2023-08-23 01:59:09 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"current_user_id"=>"522", "id"=>"292"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 522 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 292 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 522 LIMIT 1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 292[0m
  [1m[36mQuestion Load (0.4ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`book_id` = 292[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 292[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 292 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.6ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 351[0m
  [1m[36mBook Destroy (0.4ms)[0m  [1m[31mDELETE FROM `books` WHERE `books`.`id` = 292[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 351 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 810002cc-6b78-4b6f-83c4-4ccca384a579) to Test(default) with arguments: #<GlobalID:0x00007fca53820418 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/351>>
Completed 204 No Content in 44ms (ActiveRecord: 8.1ms | Allocations: 16725)
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (37.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 16:59:09.470438', '2023-08-22 16:59:09.470438')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 523 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 523, '2023-08-22 16:59:09.476923', '2023-08-22 16:59:09.476923')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 293 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('iq1egrdguik6quzx330txk4yxxkl', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 16:59:09')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 293, 352, '2023-08-22 16:59:09')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 16:59:09.481736' WHERE `books`.`id` = 293[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: iq1egrdguik6quzx330txk4yxxkl (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8f6d1859-4aff-4802-98aa-e6eb9ee20041) to Test(default) with arguments: #<GlobalID:0x00007fca4a6b8570 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/352>>
Started DELETE "/books/293" for 127.0.0.1 at 2023-08-23 01:59:09 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"293"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` IS NULL LIMIT 1[0m
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 293 LIMIT 1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 523 LIMIT 1[0m
Completed 400 Bad Request in 3ms (Views: 0.2ms | ActiveRecord: 0.8ms | Allocations: 719)
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 17:00:25.934251', '2023-08-22 17:00:25.934251')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 524 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 524, '2023-08-22 17:00:26.038663', '2023-08-22 17:00:26.038663')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 294 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ff31fueyaggs37dugyvpkkj67c1p', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 17:00:26')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 294, 353, '2023-08-22 17:00:26')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 17:00:26.044547' WHERE `books`.`id` = 294[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: ff31fueyaggs37dugyvpkkj67c1p (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2dc0f9cb-913e-41e1-9ecb-f2c537b06311) to Test(default) with arguments: #<GlobalID:0x00007fab2cbc21e8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/353>>
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started DELETE "/books/294" for 127.0.0.1 at 2023-08-23 02:00:26 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"current_user_id"=>"524", "id"=>"294"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 524 LIMIT 1[0m
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 294 LIMIT 1[0m
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 524 LIMIT 1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 294[0m
  [1m[36mQuestion Load (0.3ms)[0m  [1m[34mSELECT `questions`.* FROM `questions` WHERE `questions`.`book_id` = 294[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 294[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 294 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Attachment Destroy (0.2ms)[0m  [1m[31mDELETE FROM `active_storage_attachments` WHERE `active_storage_attachments`.`id` = 353[0m
  [1m[36mBook Destroy (0.2ms)[0m  [1m[31mDELETE FROM `books` WHERE `books`.`id` = 294[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 353 LIMIT 1[0m
[ActiveJob] Enqueued ActiveStorage::PurgeJob (Job ID: 0df64da6-6434-460a-9287-525422685189) to Test(default) with arguments: #<GlobalID:0x00007fab2ddef5f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/353>>
Completed 204 No Content in 36ms (ActiveRecord: 6.9ms | Allocations: 16725)
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 17:00:26.117202', '2023-08-22 17:00:26.117202')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 525 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書2' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書2', '東京太郎', '東京出版', 'その他', 525, '2023-08-22 17:00:26.121159', '2023-08-22 17:00:26.121159')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 295 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('wy6rlpb9tvwz9iuo8l81ftm9clxk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 17:00:26')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 295, 354, '2023-08-22 17:00:26')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 17:00:26.125366' WHERE `books`.`id` = 295[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.9ms) [0m[32mUploaded file to key: wy6rlpb9tvwz9iuo8l81ftm9clxk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b15f2df3-07dc-496c-bce6-17b9b7c13cf8) to Test(default) with arguments: #<GlobalID:0x00007fab2cf70e98 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/354>>
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 17:00:26.130966', '2023-08-22 17:00:26.130966')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
Started DELETE "/books/295" for 127.0.0.1 at 2023-08-23 02:00:26 +0900
Processing by BooksController#destroy as HTML
  Parameters: {"current_user_id"=>"526", "id"=>"295"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 526 LIMIT 1[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 295 LIMIT 1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 525 LIMIT 1[0m
Completed 400 Bad Request in 3ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 638)
  [1m[35m (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM `books`[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:25:52.437721', '2023-08-22 18:25:52.437721')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 527 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 527, '2023-08-22 18:25:52.557307', '2023-08-22 18:25:52.557307')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 296 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('4ft2m9y3bhbuysvk9yhls3tvi8an', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:25:52')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 296, 355, '2023-08-22 18:25:52')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:25:52.565783' WHERE `books`.`id` = 296[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: 4ft2m9y3bhbuysvk9yhls3tvi8an (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 984825c2-82fc-4fb3-9dab-e91bc55f93bd) to Test(default) with arguments: #<GlobalID:0x00007fc0e64fdea0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/355>>
Started GET "/books/search_books?current_user_id=527&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:25:52 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"527", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (2.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 527) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 296[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 296[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 296[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 355[0m
Completed 200 OK in 36ms (Views: 0.3ms | ActiveRecord: 6.3ms | Allocations: 11852)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:26:45.345454', '2023-08-22 18:26:45.345454')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 528 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 528, '2023-08-22 18:26:45.438833', '2023-08-22 18:26:45.438833')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 297 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('0ekwo7dxd1bb8qaz4enpmbb42zlm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:26:45')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 297, 356, '2023-08-22 18:26:45')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:26:45.444355' WHERE `books`.`id` = 297[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: 0ekwo7dxd1bb8qaz4enpmbb42zlm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d31e6862-0983-4dfa-aba6-43fab1f80a6e) to Test(default) with arguments: #<GlobalID:0x00007f880ac86d58 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/356>>
Started GET "/books/search_books?current_user_id=528&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:26:45 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"528", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 528) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 297[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 297[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 297[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 356[0m
Completed 200 OK in 43ms (Views: 0.3ms | ActiveRecord: 5.5ms | Allocations: 11853)
Started GET "/books/search_books?current_user_id=528&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:26:45 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"528", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 528) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 297[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 297[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 297[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 356[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 2275)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:26:56.889846', '2023-08-22 18:26:56.889846')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 529 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 529, '2023-08-22 18:26:56.987412', '2023-08-22 18:26:56.987412')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 298 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('vm76z2u3wp66kr6kbfqxs4nc0e7z', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:26:56')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 298, 357, '2023-08-22 18:26:56')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:26:56.993387' WHERE `books`.`id` = 298[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: vm76z2u3wp66kr6kbfqxs4nc0e7z (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: be3c36d9-926b-4fd9-b337-8ae290f9525b) to Test(default) with arguments: #<GlobalID:0x00007f888df1ae60 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/357>>
Started GET "/books/search_books?current_user_id=529&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:26:57 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"529", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 529) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.7ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 298[0m
  [1m[36mFavoriteBook Load (0.6ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 298[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 298[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 357[0m
Completed 200 OK in 30ms (Views: 0.3ms | ActiveRecord: 5.9ms | Allocations: 11852)
Started GET "/books/search_books?current_user_id=529&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:26:57 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"529", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 529) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 298[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 298[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 298[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 357[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 2275)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:28:02.014287', '2023-08-22 18:28:02.014287')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 530 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 530, '2023-08-22 18:28:02.128285', '2023-08-22 18:28:02.128285')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 299 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('6octiao5k7kgxovl6x2v8ekbhmtf', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:28:02')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 299, 358, '2023-08-22 18:28:02')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:28:02.135781' WHERE `books`.`id` = 299[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.2ms) [0m[32mUploaded file to key: 6octiao5k7kgxovl6x2v8ekbhmtf (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 342e696b-afe2-4692-b3a9-79e097b6a70a) to Test(default) with arguments: #<GlobalID:0x00007f806c221f48 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/358>>
Started GET "/books/search_books?current_user_id=530&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:28:02 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"530", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 530) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 299[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 299[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 299[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 358[0m
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 4.2ms | Allocations: 11851)
Started GET "/books/search_books?current_user_id=530&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:28:02 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"530", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 530) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 299[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 299[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 299[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 358[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2275)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 18:28:02.229584', '2023-08-22 18:28:02.229584')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 531 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 531, '2023-08-22 18:28:02.234009', '2023-08-22 18:28:02.234009')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 300 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('eai3vgbic78m3ur873mokka1jgi3', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:28:02')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 300, 359, '2023-08-22 18:28:02')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:28:02.238602' WHERE `books`.`id` = 300[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: eai3vgbic78m3ur873mokka1jgi3 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4ee91489-82a0-4244-8f31-e5e3c7b9e631) to Test(default) with arguments: #<GlobalID:0x00007f80749fe920 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/359>>
Started GET "/books/search_books?current_user_id=531&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:28:02 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"531", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 531) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 300[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 300[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 300[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 359[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=531&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:28:02 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"531", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 531) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 300[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 300[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 300[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 359[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1994)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 18:28:02.277030', '2023-08-22 18:28:02.277030')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 532 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 532, '2023-08-22 18:28:02.282886', '2023-08-22 18:28:02.282886')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 301 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('a20p69jgsgi870gmzfvn41ygk9wx', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:28:02')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 301, 360, '2023-08-22 18:28:02')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:28:02.288374' WHERE `books`.`id` = 301[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: a20p69jgsgi870gmzfvn41ygk9wx (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 2b38f45b-07d5-48a8-8add-1025742db7c4) to Test(default) with arguments: #<GlobalID:0x00007f8074a4e8a8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/360>>
Started GET "/books/search_books?current_user_id=532&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:28:02 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"532", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 532) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 301[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 301[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 301[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 360[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=532&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:28:02 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"532", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 532) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 301[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 301[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 301[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 360[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 1994)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:29:06.797185', '2023-08-22 18:29:06.797185')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 533 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 533, '2023-08-22 18:29:06.895790', '2023-08-22 18:29:06.895790')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 302 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('hfb7rm4mwsfr3ll6rjffa0ry3kj9', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 302, 361, '2023-08-22 18:29:06')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:06.901394' WHERE `books`.`id` = 302[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: hfb7rm4mwsfr3ll6rjffa0ry3kj9 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: d581894a-bdb9-439c-af8c-bf97bc313536) to Test(default) with arguments: #<GlobalID:0x00007fd6a736d7f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/361>>
Started GET "/books/search_books?current_user_id=533&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:06 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"533", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 533) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 302[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 302[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 302[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 361[0m
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 4.3ms | Allocations: 11852)
Started GET "/books/search_books?current_user_id=533&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:06 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"533", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 533) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.2ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 302[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 302[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 302[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 361[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.6ms | Allocations: 2275)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 18:29:06.969460', '2023-08-22 18:29:06.969460')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 534 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 534, '2023-08-22 18:29:06.974233', '2023-08-22 18:29:06.974233')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 303 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jd5sx9wu07fenzl3sqi0yz7li2qk', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:06')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 303, 362, '2023-08-22 18:29:06')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:06.979075' WHERE `books`.`id` = 303[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: jd5sx9wu07fenzl3sqi0yz7li2qk (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 26013a1d-eaaf-4d57-836e-2150c9357182) to Test(default) with arguments: #<GlobalID:0x00007fd6a9bac840 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/362>>
Started GET "/books/search_books?current_user_id=534&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:06 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"534", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 534) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 303[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 303[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 303[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 362[0m
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 1.9ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=534&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:06 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"534", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 534) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 303[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 303[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 303[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 362[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 1994)
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 18:29:07.015248', '2023-08-22 18:29:07.015248')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 535 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 535, '2023-08-22 18:29:07.020759', '2023-08-22 18:29:07.020759')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 304 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('u19i2tswnujuxnvbnklv4ab196c0', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 304, 363, '2023-08-22 18:29:07')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:07.026884' WHERE `books`.`id` = 304[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: u19i2tswnujuxnvbnklv4ab196c0 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4cc06dce-8bc2-4e44-b622-9e13c6207092) to Test(default) with arguments: #<GlobalID:0x00007fd6af1589b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/363>>
Started GET "/books/search_books?current_user_id=535&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:07 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"535", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (1.2ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 535) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 304[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 304[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 304[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 363[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=535&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:07 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"535", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 535) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 304[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 304[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 304[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 363[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 1994)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 18:29:07.063431', '2023-08-22 18:29:07.063431')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 536 LIMIT 1[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 536, '2023-08-22 18:29:07.069436', '2023-08-22 18:29:07.069436')[0m
  [1m[36mActiveStorage::Attachment Load (0.8ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 305 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('w940ylhpd3hjzwqjpnv1ea0crsv2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:07')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 305, 364, '2023-08-22 18:29:07')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:07.076615' WHERE `books`.`id` = 305[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: w940ylhpd3hjzwqjpnv1ea0crsv2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bcc79599-d5dc-486d-a6b8-0012a0f144a8) to Test(default) with arguments: #<GlobalID:0x00007fd6a6480998 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/364>>
Started GET "/books/search_books?current_user_id=536&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:07 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"536", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 536) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 305[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 305[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 305[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 364[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=536&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:07 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"536", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 536) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 305[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 305[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 305[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 364[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 1994)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:29:26.518326', '2023-08-22 18:29:26.518326')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 537 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 537, '2023-08-22 18:29:26.617537', '2023-08-22 18:29:26.617537')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 306 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('e610h4i5k4o18id3we7vhcr16lcm', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:26')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 306, 365, '2023-08-22 18:29:26')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:26.623506' WHERE `books`.`id` = 306[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: e610h4i5k4o18id3we7vhcr16lcm (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 6e456e0a-4b60-49b2-8a0d-ad92b6ad0929) to Test(default) with arguments: #<GlobalID:0x00007fa856b2edb8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/365>>
Started GET "/books/search_books?current_user_id=537&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:26 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"537", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 537) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 306[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 306[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 306[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 365[0m
Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 4.8ms | Allocations: 11850)
Started GET "/books/search_books?current_user_id=537&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:26 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"537", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 537) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 306[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 306[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 306[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 365[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2275)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:29:47.282311', '2023-08-22 18:29:47.282311')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 538 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 538, '2023-08-22 18:29:47.388502', '2023-08-22 18:29:47.388502')[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 307 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('sjczqn86q23l7fe2k70v3nysn5w7', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:47')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 307, 366, '2023-08-22 18:29:47')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:47.395111' WHERE `books`.`id` = 307[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.4ms) [0m[32mUploaded file to key: sjczqn86q23l7fe2k70v3nysn5w7 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 4daac241-06f9-4c7b-a90b-d1e2a3823af6) to Test(default) with arguments: #<GlobalID:0x00007fd47cc158b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/366>>
Started GET "/books/search_books?current_user_id=538&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"538", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 538) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 307[0m
  [1m[36mFavoriteBook Load (0.5ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 307[0m
  [1m[36mActiveStorage::Attachment Load (0.6ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 307[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 366[0m
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 5.4ms | Allocations: 11852)
Started GET "/books/search_books?current_user_id=538&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"538", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 538) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 307[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 307[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 307[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 366[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.6ms | Allocations: 2275)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 18:29:47.466978', '2023-08-22 18:29:47.466978')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 539 LIMIT 1[0m
  [1m[36mBook Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 539, '2023-08-22 18:29:47.471141', '2023-08-22 18:29:47.471141')[0m
  [1m[36mActiveStorage::Attachment Load (0.2ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 308 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('rtqpps1l96da6lrbo9u2chq33l9x', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:47')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 308, 367, '2023-08-22 18:29:47')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:47.474965' WHERE `books`.`id` = 308[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.8ms) [0m[32mUploaded file to key: rtqpps1l96da6lrbo9u2chq33l9x (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 8425b9f3-bca5-4628-9a77-aaa633a0f7f5) to Test(default) with arguments: #<GlobalID:0x00007fd47af232c0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/367>>
Started GET "/books/search_books?current_user_id=539&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"539", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 539) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 308[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 308[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 308[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 367[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.6ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=539&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"539", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 539) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 308[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 308[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 308[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 367[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 1994)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 18:29:47.516255', '2023-08-22 18:29:47.516255')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 540 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 540, '2023-08-22 18:29:47.522386', '2023-08-22 18:29:47.522386')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 309 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xkrz7gm6hdcn8gxez4xio8yehvj1', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:47')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 309, 368, '2023-08-22 18:29:47')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:47.528275' WHERE `books`.`id` = 309[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: xkrz7gm6hdcn8gxez4xio8yehvj1 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 1f8daf0c-7c27-4c82-b02d-03784305d9a7) to Test(default) with arguments: #<GlobalID:0x00007fd47f353198 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/368>>
Started GET "/books/search_books?current_user_id=540&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"540", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 540) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 309[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 309[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 309[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 368[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.1ms | Allocations: 2107)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 18:29:47.565468', '2023-08-22 18:29:47.565468')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 541 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 541, '2023-08-22 18:29:47.572106', '2023-08-22 18:29:47.572106')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 310 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('s8g52pzyilk3vlrrzeji6rh2syek', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:29:47')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 310, 369, '2023-08-22 18:29:47')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:29:47.576832' WHERE `books`.`id` = 310[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: s8g52pzyilk3vlrrzeji6rh2syek (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 713b10c6-abc1-4469-b978-f299e1f32a68) to Test(default) with arguments: #<GlobalID:0x00007fd4858f1a90 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/369>>
Started GET "/books/search_books?current_user_id=541&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"541", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 541) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 310[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 310[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 310[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 369[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 2107)
Started GET "/books/search_books?current_user_id=541&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:29:47 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"541", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 541) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 310[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 310[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 310[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 369[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 1994)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:30:14.713821', '2023-08-22 18:30:14.713821')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 542 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 542, '2023-08-22 18:30:14.817230', '2023-08-22 18:30:14.817230')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 311 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('2may2tpq1ed433ayuuunex7kk7ox', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:30:14')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 311, 370, '2023-08-22 18:30:14')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:30:14.822792' WHERE `books`.`id` = 311[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: 2may2tpq1ed433ayuuunex7kk7ox (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 292b918a-9b08-44a4-98da-398827310a47) to Test(default) with arguments: #<GlobalID:0x00007f8fe9b96768 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/370>>
Started GET "/books/search_books?current_user_id=542&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:30:14 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"542", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 542) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 311[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 311[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 311[0m
  [1m[36mActiveStorage::Blob Load (0.5ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 370[0m
Completed 200 OK in 27ms (Views: 0.3ms | ActiveRecord: 5.3ms | Allocations: 11853)
Started GET "/books/search_books?current_user_id=542&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:30:14 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"542", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 542) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 311[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 311[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 311[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 370[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2275)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:32:59.197080', '2023-08-22 18:32:59.197080')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 543 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 543, '2023-08-22 18:32:59.311264', '2023-08-22 18:32:59.311264')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 312 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('1zc49pkmxge4ccast5corshktzup', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:32:59')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 312, 371, '2023-08-22 18:32:59')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:32:59.318144' WHERE `books`.`id` = 312[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: 1zc49pkmxge4ccast5corshktzup (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 25f281f5-8112-467e-a77c-b85a9ccf0731) to Test(default) with arguments: #<GlobalID:0x00007fe1377ce190 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/371>>
Started GET "/books/search_books?current_user_id=543&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:32:59 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"543", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 543) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 312[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 312[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 312[0m
  [1m[36mActiveStorage::Blob Load (0.6ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 371[0m
Completed 200 OK in 35ms (Views: 0.3ms | ActiveRecord: 4.7ms | Allocations: 11852)
Started GET "/books/search_books?current_user_id=543&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:32:59 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"543", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 543) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 312[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 312[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 312[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 371[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 2.2ms | Allocations: 2275)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:33:24.235218', '2023-08-22 18:33:24.235218')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 544 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 544, '2023-08-22 18:33:24.346369', '2023-08-22 18:33:24.346369')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 313 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('yr74sdj58s898jr1sik04rn3rjws', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:33:24')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 313, 372, '2023-08-22 18:33:24')[0m
  [1m[36mBook Update (0.6ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:33:24.353480' WHERE `books`.`id` = 313[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: yr74sdj58s898jr1sik04rn3rjws (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 14a64d1d-87f0-4906-91bc-4ba2df0fef0b) to Test(default) with arguments: #<GlobalID:0x00007ffe63c71668 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/372>>
Started GET "/books/search_books?current_user_id=544&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:33:24 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"544", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 544) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 313[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 313[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 313[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 372[0m
Completed 200 OK in 27ms (Views: 0.4ms | ActiveRecord: 4.6ms | Allocations: 11851)
Started GET "/books/search_books?current_user_id=544&search_books_keyword=[FILTERED]" for 127.0.0.1 at 2023-08-23 03:33:24 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"544", "search_books_keyword"=>"[FILTERED]"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 544) AS check_favorite FROM `books` WHERE (name LIKE '%%' OR author LIKE '%%' OR publisher LIKE '%%' OR subject LIKE '%%')[0m
  [1m[36mReview Load (0.5ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 313[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 313[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 313[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 372[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 2275)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:35:57.507241', '2023-08-22 18:35:57.507241')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 545 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 545, '2023-08-22 18:35:57.626247', '2023-08-22 18:35:57.626247')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 314 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5fl69kdf0sr9p9o9sya4wu3odv0k', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:35:57')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 314, 373, '2023-08-22 18:35:57')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:35:57.633883' WHERE `books`.`id` = 314[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.4ms) [0m[32mUploaded file to key: 5fl69kdf0sr9p9o9sya4wu3odv0k (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a0148fe0-6e49-4bff-8b21-215ba7664c52) to Test(default) with arguments: #<GlobalID:0x00007fa106ec8890 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/373>>
Started GET "/books/search_books?current_user_id=545&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:35:57 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"545", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 545) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 4230)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:36:01.218429', '2023-08-22 18:36:01.218429')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 546 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 546, '2023-08-22 18:36:01.325736', '2023-08-22 18:36:01.325736')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 315 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ee51bmzyhrt80894ewdllh18kfgy', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:36:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 315, 374, '2023-08-22 18:36:01')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:36:01.332103' WHERE `books`.`id` = 315[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.0ms) [0m[32mUploaded file to key: ee51bmzyhrt80894ewdllh18kfgy (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: c012df94-122a-4822-91c1-867074b0f00f) to Test(default) with arguments: #<GlobalID:0x00007f87a8c00350 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/374>>
Started GET "/books/search_books?current_user_id=546&searchBooksKeyword=%E5%8F%82%E8%80%83%E6%9B%B81" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"546", "searchBooksKeyword"=>"参考書1"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 546) AS check_favorite FROM `books` WHERE (name LIKE '%参考書1%' OR author LIKE '%参考書1%' OR publisher LIKE '%参考書1%' OR subject LIKE '%参考書1%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 315[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 315[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 315[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 374[0m
Completed 200 OK in 28ms (Views: 0.4ms | ActiveRecord: 4.6ms | Allocations: 11852)
Started GET "/books/search_books?current_user_id=546&searchBooksKeyword=%E5%8F%82%E8%80%83" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"546", "searchBooksKeyword"=>"参考"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 546) AS check_favorite FROM `books` WHERE (name LIKE '%参考%' OR author LIKE '%参考%' OR publisher LIKE '%参考%' OR subject LIKE '%参考%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 315[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 315[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 315[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 374[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 2274)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 18:36:01.415777', '2023-08-22 18:36:01.415777')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 547 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 547, '2023-08-22 18:36:01.422047', '2023-08-22 18:36:01.422047')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 316 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.6ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('988eypaor3szgrc20ol24m1m5k2e', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:36:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 316, 375, '2023-08-22 18:36:01')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:36:01.429004' WHERE `books`.`id` = 316[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.3ms) [0m[32mUploaded file to key: 988eypaor3szgrc20ol24m1m5k2e (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: f02a34bb-b7d2-4780-a854-6dc71ef07759) to Test(default) with arguments: #<GlobalID:0x00007f87a8f18ab0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/375>>
Started GET "/books/search_books?current_user_id=547&searchBooksKeyword=%E6%9D%B1%E4%BA%AC%E5%A4%AA%E9%83%8E" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"547", "searchBooksKeyword"=>"東京太郎"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 547) AS check_favorite FROM `books` WHERE (name LIKE '%東京太郎%' OR author LIKE '%東京太郎%' OR publisher LIKE '%東京太郎%' OR subject LIKE '%東京太郎%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 316[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 316[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 316[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 375[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 2109)
Started GET "/books/search_books?current_user_id=547&searchBooksKeyword=%E5%A4%AA%E9%83%8E" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"547", "searchBooksKeyword"=>"太郎"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 547) AS check_favorite FROM `books` WHERE (name LIKE '%太郎%' OR author LIKE '%太郎%' OR publisher LIKE '%太郎%' OR subject LIKE '%太郎%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 316[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 316[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 316[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 375[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 2.2ms | Allocations: 1993)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 18:36:01.474671', '2023-08-22 18:36:01.474671')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 548 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 548, '2023-08-22 18:36:01.480553', '2023-08-22 18:36:01.480553')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 317 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('ply98r51l8k6xkokr6aeuixosb7c', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:36:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 317, 376, '2023-08-22 18:36:01')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:36:01.487704' WHERE `books`.`id` = 317[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: ply98r51l8k6xkokr6aeuixosb7c (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: b00063ae-adaf-4ff8-89de-c57b6b2edb79) to Test(default) with arguments: #<GlobalID:0x00007f87a7f989f0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/376>>
Started GET "/books/search_books?current_user_id=548&searchBooksKeyword=%E6%9D%B1%E4%BA%AC%E5%87%BA%E7%89%88" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"548", "searchBooksKeyword"=>"東京出版"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 548) AS check_favorite FROM `books` WHERE (name LIKE '%東京出版%' OR author LIKE '%東京出版%' OR publisher LIKE '%東京出版%' OR subject LIKE '%東京出版%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 317[0m
  [1m[36mFavoriteBook Load (0.6ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 317[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 317[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 376[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 2109)
Started GET "/books/search_books?current_user_id=548&searchBooksKeyword=%E5%87%BA%E7%89%88" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"548", "searchBooksKeyword"=>"出版"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 548) AS check_favorite FROM `books` WHERE (name LIKE '%出版%' OR author LIKE '%出版%' OR publisher LIKE '%出版%' OR subject LIKE '%出版%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 317[0m
  [1m[36mFavoriteBook Load (0.2ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 317[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 317[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 376[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 2.1ms | Allocations: 1993)
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 18:36:01.530653', '2023-08-22 18:36:01.530653')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 549 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 549, '2023-08-22 18:36:01.536752', '2023-08-22 18:36:01.536752')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 318 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('gcz60trsm0wccxvyuvcluyq9t5wq', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:36:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.9ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 318, 377, '2023-08-22 18:36:01')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:36:01.543524' WHERE `books`.`id` = 318[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.8ms) [0m[32mUploaded file to key: gcz60trsm0wccxvyuvcluyq9t5wq (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 36253e2e-12fe-4159-a0bf-8356662e63fa) to Test(default) with arguments: #<GlobalID:0x00007f87a7fe8a18 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/377>>
Started GET "/books/search_books?current_user_id=549&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:36:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"549", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 549) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 733)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:37:39.562312', '2023-08-22 18:37:39.562312')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 550 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 550, '2023-08-22 18:37:39.668597', '2023-08-22 18:37:39.668597')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 319 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('xvfu0nyt0rdllemtivdiwi0flhyi', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:37:39')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 319, 378, '2023-08-22 18:37:39')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:37:39.675112' WHERE `books`.`id` = 319[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: xvfu0nyt0rdllemtivdiwi0flhyi (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 77f4f9d3-32a5-4e4b-9d78-7fae62155db0) to Test(default) with arguments: #<GlobalID:0x00007f88bbc3f9b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/378>>
Started GET "/books/search_books?current_user_id=550&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:37:39 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"550", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 550) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 4230)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:38:43.210775', '2023-08-22 18:38:43.210775')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 551 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 551, '2023-08-22 18:38:43.325350', '2023-08-22 18:38:43.325350')[0m
  [1m[36mActiveStorage::Attachment Load (0.7ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 320 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('itu65mvrvp5750dqk9k9fbyus29z', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:38:43')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 320, 379, '2023-08-22 18:38:43')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:38:43.333755' WHERE `books`.`id` = 320[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.7ms) [0m[32mUploaded file to key: itu65mvrvp5750dqk9k9fbyus29z (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 09812e87-dd0f-4d82-90c7-6b5294736bab) to Test(default) with arguments: #<GlobalID:0x00007fc8dbb9f798 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/379>>
Started GET "/books/search_books?current_user_id=551&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:38:43 +0900
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:39:01.598733', '2023-08-22 18:39:01.598733')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 552 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 552, '2023-08-22 18:39:01.701405', '2023-08-22 18:39:01.701405')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 321 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('noazju7z5dulirvhs5ctj2zyucru', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:39:01')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 321, 380, '2023-08-22 18:39:01')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:39:01.707276' WHERE `books`.`id` = 321[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: noazju7z5dulirvhs5ctj2zyucru (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: e7b41f6f-21d9-4db3-9c3e-64a06d46ed2f) to Test(default) with arguments: #<GlobalID:0x00007fe11fa7d890 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/380>>
Started GET "/books/search_books?current_user_id=552&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:39:01 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"552", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 552) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 4238)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:39:27.334672', '2023-08-22 18:39:27.334672')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 553 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 553, '2023-08-22 18:39:27.455172', '2023-08-22 18:39:27.455172')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 322 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('d1nchq7uf548tt6rr9bzkr8wcrn2', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:39:27')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 322, 381, '2023-08-22 18:39:27')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:39:27.462842' WHERE `books`.`id` = 322[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: d1nchq7uf548tt6rr9bzkr8wcrn2 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 0172211f-155b-4b72-8954-b9515dd5d7f2) to Test(default) with arguments: #<GlobalID:0x00007f931a061df0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/381>>
Started GET "/books/search_books?current_user_id=553&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:39:27 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"553", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 553) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 4239)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:39:53.619999', '2023-08-22 18:39:53.619999')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 554 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 554, '2023-08-22 18:39:53.722536', '2023-08-22 18:39:53.722536')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 323 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jhkvgfj4nf0oz5g9nquc3yf0y84d', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:39:53')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 323, 382, '2023-08-22 18:39:53')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:39:53.728804' WHERE `books`.`id` = 323[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.5ms) [0m[32mUploaded file to key: jhkvgfj4nf0oz5g9nquc3yf0y84d (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: fe2f605b-37b6-497e-81c0-132c4c9376a5) to Test(default) with arguments: #<GlobalID:0x00007f8599b297f8 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/382>>
Started GET "/books/search_books?current_user_id=554&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:39:53 +0900
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:40:16.761964', '2023-08-22 18:40:16.761964')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 555 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 555, '2023-08-22 18:40:16.867457', '2023-08-22 18:40:16.867457')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 324 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('txhziyh3isvb21v1cwfjlu0mrvsh', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:40:16')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 324, 383, '2023-08-22 18:40:16')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:40:16.875398' WHERE `books`.`id` = 324[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: txhziyh3isvb21v1cwfjlu0mrvsh (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 5ceabbb0-9d26-425c-823d-e4f509ab4b81) to Test(default) with arguments: #<GlobalID:0x00007f92a74828d0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/383>>
Started GET "/books/search_books?current_user_id=555&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:40:16 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"555", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 555) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 404 Not Found in 7ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 4236)
  [1m[36mTRANSACTION (2.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:40:32.919987', '2023-08-22 18:40:32.919987')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 556 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 556, '2023-08-22 18:40:33.042080', '2023-08-22 18:40:33.042080')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 325 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('h5i7kxd0tk26a39yw5f1iv7o03eh', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:40:33')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 325, 384, '2023-08-22 18:40:33')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:40:33.048013' WHERE `books`.`id` = 325[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.2ms) [0m[32mUploaded file to key: h5i7kxd0tk26a39yw5f1iv7o03eh (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: bf5d9159-d94d-4e1c-aa2a-215dead7995e) to Test(default) with arguments: #<GlobalID:0x00007f8cc4d18d98 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/384>>
Started GET "/books/search_books?current_user_id=556&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:40:33 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"556", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 556) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 404 Not Found in 11ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 4235)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:42:45.165651', '2023-08-22 18:42:45.165651')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 557 LIMIT 1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 557, '2023-08-22 18:42:45.265877', '2023-08-22 18:42:45.265877')[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 326 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('i5dogiwl7i1fbytcnpfggt5u4jtt', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:42:45')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 326, 385, '2023-08-22 18:42:45')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:42:45.272020' WHERE `books`.`id` = 326[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.6ms) [0m[32mUploaded file to key: i5dogiwl7i1fbytcnpfggt5u4jtt (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 909b870b-a02d-4fe9-a206-d854fea0ec87) to Test(default) with arguments: #<GlobalID:0x00007ffd37c68248 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/385>>
Started GET "/books/check_existence?id=326" for 127.0.0.1 at 2023-08-23 03:42:45 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"326"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 326 LIMIT 1[0m
Completed 200 OK in 6ms (ActiveRecord: 0.4ms | Allocations: 3427)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:43:02.113956', '2023-08-22 18:43:02.113956')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 558 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 558, '2023-08-22 18:43:02.214469', '2023-08-22 18:43:02.214469')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 327 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('efx7x481iom7cre0hyq3pc5qe8vv', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:43:02')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 327, 386, '2023-08-22 18:43:02')[0m
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:43:02.220315' WHERE `books`.`id` = 327[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.6ms) [0m[32mUploaded file to key: efx7x481iom7cre0hyq3pc5qe8vv (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 39d2e5fe-5795-4fdd-9538-a4b69f15e587) to Test(default) with arguments: #<GlobalID:0x00007fcb14bf4b90 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/386>>
Started GET "/books/check_existence?id=327" for 127.0.0.1 at 2023-08-23 03:43:02 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"327"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 327 LIMIT 1[0m
Completed 200 OK in 6ms (ActiveRecord: 0.5ms | Allocations: 3427)
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 03:43:22 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 15ms (ActiveRecord: 1.6ms | Allocations: 9173)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT `ar_internal_metadata`.`value` FROM `ar_internal_metadata` WHERE `ar_internal_metadata`.`key` = 'schema_sha1'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT `schema_migrations`.`version` FROM `schema_migrations` ORDER BY `schema_migrations`.`version` ASC[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa1@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎1', 'kanagawa1@sample.com', 'kanakana12341', '2023-08-22 18:45:02.886937', '2023-08-22 18:45:02.886937')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 559 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 559, '2023-08-22 18:45:03.001585', '2023-08-22 18:45:03.001585')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 328 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('5wiiq83zkq0ylid113t3q66adbfp', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:45:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 328, 387, '2023-08-22 18:45:03')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:45:03.008709' WHERE `books`.`id` = 328[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (2.3ms) [0m[32mUploaded file to key: 5wiiq83zkq0ylid113t3q66adbfp (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 33310bf8-51e8-4f93-afa9-14afbe7e97e6) to Test(default) with arguments: #<GlobalID:0x00007fc7cc3fe030 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/387>>
Started GET "/books/search_books?current_user_id=559&searchBooksKeyword=%E5%8F%82%E8%80%83%E6%9B%B81" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"559", "searchBooksKeyword"=>"参考書1"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 559) AS check_favorite FROM `books` WHERE (name LIKE '%参考書1%' OR author LIKE '%参考書1%' OR publisher LIKE '%参考書1%' OR subject LIKE '%参考書1%')[0m
  [1m[36mReview Load (0.7ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 328[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 328[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 328[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 387[0m
Completed 200 OK in 33ms (Views: 0.2ms | ActiveRecord: 5.2ms | Allocations: 11854)
Started GET "/books/search_books?current_user_id=559&searchBooksKeyword=%E5%8F%82%E8%80%83" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"559", "searchBooksKeyword"=>"参考"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 559) AS check_favorite FROM `books` WHERE (name LIKE '%参考%' OR author LIKE '%参考%' OR publisher LIKE '%参考%' OR subject LIKE '%参考%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 328[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 328[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 328[0m
  [1m[36mActiveStorage::Blob Load (0.4ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 387[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 2274)
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa2@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎2', 'kanagawa2@sample.com', 'kanakana12342', '2023-08-22 18:45:03.093972', '2023-08-22 18:45:03.093972')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 560 LIMIT 1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 560, '2023-08-22 18:45:03.100077', '2023-08-22 18:45:03.100077')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 329 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('jinqry3jbj3gegczb2e294te93x4', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:45:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 329, 388, '2023-08-22 18:45:03')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:45:03.106031' WHERE `books`.`id` = 329[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.7ms) [0m[32mUploaded file to key: jinqry3jbj3gegczb2e294te93x4 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 20b39d6c-109f-4012-883a-a514c22f4382) to Test(default) with arguments: #<GlobalID:0x00007fc7ccd56448 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/388>>
Started GET "/books/search_books?current_user_id=560&searchBooksKeyword=%E6%9D%B1%E4%BA%AC%E5%A4%AA%E9%83%8E" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"560", "searchBooksKeyword"=>"東京太郎"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 560) AS check_favorite FROM `books` WHERE (name LIKE '%東京太郎%' OR author LIKE '%東京太郎%' OR publisher LIKE '%東京太郎%' OR subject LIKE '%東京太郎%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 329[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 329[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 329[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 388[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 2109)
Started GET "/books/search_books?current_user_id=560&searchBooksKeyword=%E5%A4%AA%E9%83%8E" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"560", "searchBooksKeyword"=>"太郎"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 560) AS check_favorite FROM `books` WHERE (name LIKE '%太郎%' OR author LIKE '%太郎%' OR publisher LIKE '%太郎%' OR subject LIKE '%太郎%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 329[0m
  [1m[36mFavoriteBook Load (0.4ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 329[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 329[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 388[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 1993)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa3@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎3', 'kanagawa3@sample.com', 'kanakana12343', '2023-08-22 18:45:03.143821', '2023-08-22 18:45:03.143821')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 561 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 561, '2023-08-22 18:45:03.150916', '2023-08-22 18:45:03.150916')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 330 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('pte901u4k35pxue02inzdn4sn726', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:45:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.3ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 330, 389, '2023-08-22 18:45:03')[0m
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:45:03.156756' WHERE `books`.`id` = 330[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (1.1ms) [0m[32mUploaded file to key: pte901u4k35pxue02inzdn4sn726 (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 015d123b-daf2-4ce8-9f0d-4acee0eec2ba) to Test(default) with arguments: #<GlobalID:0x00007fc7d19023b0 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/389>>
Started GET "/books/search_books?current_user_id=561&searchBooksKeyword=%E6%9D%B1%E4%BA%AC%E5%87%BA%E7%89%88" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"561", "searchBooksKeyword"=>"東京出版"}
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 561) AS check_favorite FROM `books` WHERE (name LIKE '%東京出版%' OR author LIKE '%東京出版%' OR publisher LIKE '%東京出版%' OR subject LIKE '%東京出版%')[0m
  [1m[36mReview Load (0.3ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 330[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 330[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 330[0m
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 389[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 2109)
Started GET "/books/search_books?current_user_id=561&searchBooksKeyword=%E5%87%BA%E7%89%88" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"561", "searchBooksKeyword"=>"出版"}
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 561) AS check_favorite FROM `books` WHERE (name LIKE '%出版%' OR author LIKE '%出版%' OR publisher LIKE '%出版%' OR subject LIKE '%出版%')[0m
  [1m[36mReview Load (0.4ms)[0m  [1m[34mSELECT `reviews`.* FROM `reviews` WHERE `reviews`.`book_id` = 330[0m
  [1m[36mFavoriteBook Load (0.3ms)[0m  [1m[34mSELECT `favorite_books`.* FROM `favorite_books` WHERE `favorite_books`.`book_id` = 330[0m
  [1m[36mActiveStorage::Attachment Load (0.3ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' AND `active_storage_attachments`.`record_id` = 330[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT `active_storage_blobs`.* FROM `active_storage_blobs` WHERE `active_storage_blobs`.`id` = 389[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1993)
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa4@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎4', 'kanagawa4@sample.com', 'kanakana12344', '2023-08-22 18:45:03.193501', '2023-08-22 18:45:03.193501')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 562 LIMIT 1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 562, '2023-08-22 18:45:03.199855', '2023-08-22 18:45:03.199855')[0m
  [1m[36mActiveStorage::Attachment Load (0.5ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 331 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('b2srq2s4qsowjzxvtr255ou55fec', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:45:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 331, 390, '2023-08-22 18:45:03')[0m
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:45:03.206376' WHERE `books`.`id` = 331[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: b2srq2s4qsowjzxvtr255ou55fec (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: 708a9b2f-ca2f-4e93-b8c2-f7b2f1d8f40d) to Test(default) with arguments: #<GlobalID:0x00007fc7d1952608 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/390>>
Started GET "/books/search_books?current_user_id=562&searchBooksKeyword=%E6%95%99%E7%A7%91%E6%9B%B8" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#search_books as HTML
  Parameters: {"current_user_id"=>"562", "searchBooksKeyword"=>"教科書"}
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT books.*, (SELECT COUNT(*) FROM reviews WHERE reviews.book_id = books.id) AS reviews_count, (SELECT ROUND(AVG(reviews.rating), 1) FROM reviews where reviews.book_id = books.id) AS average_rating, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id) AS favorite_books_count, (SELECT COUNT(*) FROM favorite_books WHERE favorite_books.book_id = books.id and favorite_books.user_id = 562) AS check_favorite FROM `books` WHERE (name LIKE '%教科書%' OR author LIKE '%教科書%' OR publisher LIKE '%教科書%' OR subject LIKE '%教科書%')[0m
Completed 404 Not Found in 2ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 737)
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `users` WHERE `users`.`email` = 'kanagawa5@sample.com' LIMIT 1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO `users` (`name`, `email`, `uid`, `created_at`, `updated_at`) VALUES ('神奈川太郎5', 'kanagawa5@sample.com', 'kanakana12345', '2023-08-22 18:45:03.224790', '2023-08-22 18:45:03.224790')[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT `users`.* FROM `users` WHERE `users`.`id` = 563 LIMIT 1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM `books` WHERE `books`.`name` = '参考書1' LIMIT 1[0m
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO `books` (`name`, `author`, `publisher`, `subject`, `user_id`, `created_at`, `updated_at`) VALUES ('参考書1', '東京太郎', '東京出版', 'その他', 563, '2023-08-22 18:45:03.229218', '2023-08-22 18:45:03.229218')[0m
  [1m[36mActiveStorage::Attachment Load (0.4ms)[0m  [1m[34mSELECT `active_storage_attachments`.* FROM `active_storage_attachments` WHERE `active_storage_attachments`.`record_id` = 332 AND `active_storage_attachments`.`record_type` = 'Book' AND `active_storage_attachments`.`name` = 'image' LIMIT 1[0m
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO `active_storage_blobs` (`key`, `filename`, `content_type`, `metadata`, `service_name`, `byte_size`, `checksum`, `created_at`) VALUES ('dyrwmpmvbjwvu2k6hrjbyzvv0i4b', 'no_image.png', 'image/png', '{\"identified\":true}', 'test', 6027, 'h3EfYIySv4JnCVqX49/s4A==', '2023-08-22 18:45:03')[0m
  [1m[36mActiveStorage::Attachment Create (0.5ms)[0m  [1m[32mINSERT INTO `active_storage_attachments` (`name`, `record_type`, `record_id`, `blob_id`, `created_at`) VALUES ('image', 'Book', 332, 391, '2023-08-22 18:45:03')[0m
  [1m[36mBook Update (0.7ms)[0m  [1m[33mUPDATE `books` SET `books`.`updated_at` = '2023-08-22 18:45:03.236268' WHERE `books`.`id` = 332[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[36m  Disk Storage (0.9ms) [0m[32mUploaded file to key: dyrwmpmvbjwvu2k6hrjbyzvv0i4b (checksum: h3EfYIySv4JnCVqX49/s4A==)[0m
[ActiveJob] Enqueued ActiveStorage::AnalyzeJob (Job ID: a40a3d50-2140-4fa5-8dc8-addb8a9e017b) to Test(default) with arguments: #<GlobalID:0x00007fc7c95ba840 @uri=#<URI::GID gid://backend/ActiveStorage::Blob/391>>
Started GET "/books/check_existence?id=332" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"332"}
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = 332 LIMIT 1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.4ms | Allocations: 353)
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started GET "/books/check_existence?id=-1" for 127.0.0.1 at 2023-08-23 03:45:03 +0900
Processing by BooksController#check_existence as HTML
  Parameters: {"id"=>"-1"}
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT `books`.* FROM `books` WHERE `books`.`id` = -1 LIMIT 1[0m
Completed 404 Not Found in 1ms (ActiveRecord: 0.5ms | Allocations: 210)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
